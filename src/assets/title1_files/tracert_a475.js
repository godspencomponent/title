!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.dmmma?define(["exports"],t):t((e=e||self).tracertUtil={})}(this,function(e){"use strict";function t(e,t,n){var r=t||window.document;r.addEventListener?r.addEventListener(e,n,!0):r.attachEvent?r.attachEvent("on".concat(e),n):r[e]=n}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function i(e){"interactive"===document.readyState||"complete"===document.readyState?e():t("DOMContentLoaded",document,e)}function c(e){return"requestIdleCallback"in window?c(e,{timeout:arguments.length>1&&void 0!==arguments[1]?arguments[1]:500}):setTimeout(e)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};for(var r in e){if(e.hasOwnProperty(r))n[0===r.indexOf(t)?r:t+r]=e[r]}return n}function l(e,t){var n=e||{};for(var r in t)t.hasOwnProperty(r)&&void 0!==t[r]&&(n[r]=t[r]);return n}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.search;if(!e)return"";var n="",r=window.AlipayJSBridge;try{n=RegExp("(?=\\?|\\&|\\b|^)".concat(e,"\\=(.+?)(?=\\&|$)")).exec(t),n=decodeURIComponent(n=n?"".concat(n[1]):"")}catch(e){console.warn(e)}return""===n&&(n=r&&r.startupParams&&r.startupParams[e]),n}function f(e){var t=e||window.navigator.userAgent;if(!RegExp("aliapp\\(".concat("ap"),"i").test(t))return 0;var n=/alipayclient\/(\d+)\.?(\d+)?\.?(\d+)?/i.exec(t),r=0;if(n){var o=n[1]||0,a=n[2]||0,i=n[3]||0;10>+a&&(a="0".concat(a)),10>+i&&(i="0".concat(i)),r=parseFloat("".concat(o,".").concat(a).concat(i))}return r}function p(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^",r=[];if(e instanceof Array)r=e;else if(e instanceof Object)for(t in e)e.hasOwnProperty(t)&&r.push("".concat(t,"=").concat(e[t]));return r.join(n)}function d(e){if("string"!=typeof e)return null;var t=e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^");if(-1===e.indexOf("="))return t;for(var n,r,o=t.length,a={},i=0;o>i;i++)(n=t[i])&&(a[(r=n.split("="))[0]]=r[1]||"");return a}var m=l,v=p;var g="data-aspm",h="data-aspm-click",y=/^a|area$/i;function x(e){var t,n;try{return t=[].slice.call(e)}catch(o){t=[],n=e.length;for(var r=0;n>r;r++)t.push(e[r]);return t}}function w(e,t){return e&&e.getAttribute&&e.getAttribute(t)||""}function b(e){return null!==e&&"object"===n(e)&&1===e.nodeType}function E(e){return!(!e||!b(e)||e===document.body||e===document.documentElement)}function O(e){var t=e;if(!E(t))return"null";do{if(y.test(t.tagName)||t.hasAttribute(h))return t}while((t=t.parentNode)&&t&&t.tagName&&"BODY"!==t.tagName&&t!==document.body&&!w(t,g));return null}function S(){for(var e=0,t={};arguments.length>e;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}var I=function e(t){function n(e,r,o){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(o=S({path:"/"},n.defaults,o)).expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*o.expires),o.expires=i}o.expires=o.expires?o.expires.toUTCString():"";try{a=JSON.stringify(r),/^[\{\[]/.test(a)&&(r=a)}catch(e){}r=t.write?t.write(r,e):encodeURIComponent(r+"").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(e+"")).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var c="";for(var u in o)o[u]&&(c+="; "+u,!0!==o[u]&&(c+="="+o[u]));return document.cookie=e+"="+r+c}e||(a={});for(var l=document.cookie?document.cookie.split("; "):[],s=/(%[0-9A-Z]{2})+/g,f=0;l.length>f;f++){var p=l[f].split("="),d=p.slice(1).join("=");this.json||'"'!==d.charAt(0)||(d=d.slice(1,-1));try{var m=p[0].replace(s,decodeURIComponent);if(d=t.read?t.read(d,m):t(d,m)||d.replace(s,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(e){}if(e===m){a=d;break}e||(a[m]=d)}catch(e){}}return a}}return n.set=n,n.get=function(e){return n.call(n,e)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(e,t){n(e,"",S(t,{expires:-1}))},n.withConverter=e,n}(function(){});function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||400>t.length||!n.cookie&&window.localStorage)if(window.localStorage)try{window.localStorage.setItem(e,t)}catch(r){I.set(e,t,n)}else I.set(e,t,n);else console&&console.warn&&console.warn("Tracert cookie set too long")}var P=new(function(){function e(){r(this,e)}return a(e,[{key:"set",value:function(){var e,t,n,r=[].slice.call(arguments);2>r.length?this._set(r):this._set((n=r[1],(t=r[0])in(e={})?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e),r[2]||{})}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="".concat("_TRACERT_COOKIE_","_").concat(e),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window.localStorage&&window.localStorage.getItem(e)||I.get(e,t);if(I.get(e,t)&&window.localStorage)try{window.localStorage.setItem(e,n),I.remove(e,t)}catch(e){console&&console.warn&&console.warn("localstorage error")}return n}(r,t);return n&&function(e,t){window.localStorage&&window.localStorage.removeItem(e),I.remove(e,t)}(r),o}},{key:"_set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&0!==Object.keys(e).length)for(var n in e){if(e.hasOwnProperty(n))C("".concat("_TRACERT_COOKIE_","_").concat(n),e[n],t)}}}]),e}());var j={parse:function(e){var t=e.split("//"),n=t[0],r=t[1]||"",o=r.split("/")[0],a=o.split(":"),i=a[0],c=a[1]||"",u=r.replace(o,"").split("#"),l=u[0],s=u[1]||"",f=s?"#".concat(s):null,p=l.split("?"),d=p[0],m=p[1]||"",v={protocol:n,slashes:!0,auth:null,host:o,port:c||null,hostname:i,hash:f,search:m?"?".concat(m):null,query:m||null,pathname:d,path:l,href:e,format:function(){return"".concat(v.protocol,"//").concat(v.host).concat(v.path).concat(v.hash||"")}};return v}},A=new(function(){function e(){r(this,e),this._iframe=null}return a(e,[{key:"initIframe",value:function(){if(this._iframe)return this._iframe;var e=document.createElement("iframe");return e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.left="-100px",e.style.bottom="-100px",e.style.width="-100px",e.setAttribute("src","https://tracert.alipay.com/cross.html"),e.onload=function(){e.style.display="none"},document.body.appendChild(e),e}}]),e}());e.Cookies=I,e.CrossIframe=A,e.addEvent=t,e.addMexOption=function(e,t){var n=e||{},r=t||{};if(!r.spmId||"mergeExpose"!==r.actionId)return n;if(3===r.spmId.split(".").length){var o=r.spmId;n[o]||(n[o]={},n[o]=m({},r))}return n},e.addToExObj=function(e,t){var n=e||{},r=t||{};if(!r.spmId||"mergeExpose"!==r.actionId)return null;if(3===r.spmId.split(".").length){var o=r.spmId;n[o]||(n[o]={});var a="";r.param4&&r.param4.rid?(a=r.param4.rid,delete r.param4.rid):a="",n[o][a]?n[o][a].push(r.param4):(n[o][a]=[],n[o][a].push(r.param4))}return n},e.cookiesPrefix="_TRACERT_COOKIE_",e.dealExtra=u,e.debounce=function(e,t){var n,r=this,o=arguments;return function(){var a=r,i=o;clearTimeout(n),n=setTimeout(function(){n=null,e.apply(a,i)},t)}},e.formatExObj=function(e,t){var r=[],o=["fullURL","mBizScenario","mPageState","mPageName","version"];if("object"===n(e))for(var a in e)if(e.hasOwnProperty(a)){var i={};t?i=m(i,t[a]):(i.spmId=a,i.actionId="mergeExpose");var c=[];if(e[a].options)i.param4=v(e[a].options.param4);else{for(var u in e[a])if(e[a].hasOwnProperty(u)){for(var l=[],s=e[a][u],f=0;s.length>f;f++){var p=[],d=s[f];for(var g in d)d.hasOwnProperty(g)&&-1===o.indexOf(g)&&p.push("".concat(g,"|").concat(d[g]));l.push(p.join(";"))}c.push("rid|".concat(u,":").concat(l.join("&")))}i.param4="exposed=".concat(c.join("__"))}r.push(i)}return r},e.getApFloatVersion=f,e.getAttr=w,e.getDPosDom=O,e.getDomParam=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-aspm-param")||"",n={};if(t){var r=t.split("^");if(-1===t.indexOf("="))n=r;else for(var o,a,i=r.length,c=0;i>c;c++)(o=r[c])&&(n[(a=o.split("="))[0]]=a[1]||"")}return n},e.getMetaPageName=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pagename",t=x(window.document.getElementsByTagName("meta")),n="",r=0;t.length>r;r++){var o=t[r],a=w(o,"name"),i=w(o,"content");if(i&&a&&a===e){n=i;break}}return n},e.getMetaSpm=function(e){for(var t,n,r,o,a,i=x(e||document.getElementsByTagName("meta")),c=i.length,u=0;c>u;u++){switch(n=w(t=i[u],"name"),r=w(t,"content"),n){case g:a=r;break;case"data-bizType":o=r}if(a&&o)break}var l={};return a&&(l.spmAPos=a),o&&(l.bizType=o),l},e.getSpmBPos=function(){return w(document.body,g)},e.getSpmCPos=function(e){var t=e;if(!E(t))return"";for(var n="";t&&t!==document.body&&!(n=w(t,g));)t=t.parentNode;return n},e.getSpmDPos=function(e){var t=e;if(!E(t))return"";if(y.test(t.tagName)||t.hasAttribute(h)||(t=O(t)),!t)return"";var n=w(t,h),r=t.tagName;if(("string"==typeof n||y.test(r))&&!n){var o=0,a=t;do{b(a)&&r===a.tagName&&o++,a=a.previousSibling}while(a);n=o}return"".concat(n)},e.getValue=s,e.isDom=b,e.isViewDom=E,e.load=i,e.nodeListToArray=x,e.objToStr=p,e.objectAssign=l,e.removeEvent=function(e,t,n){var r=t||window.document;r.removeEventListener?r.removeEventListener(e,n,!0):r.detachEvent?r.detachEvent("on".concat(e),n):r[e]=n},e.requestIdleCallback=c,e.storage=P,e.strToObj=d,e.url=j,e.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},Object.defineProperty(e,"__esModule",{value:!0})});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e=e||self).tracertCore=t(e.tracertUtil)}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function o(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(n,!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e){return function(e){if(Array.isArray(e))return e}(e)||c(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}var l=function(e){console&&console.warn&&console.warn("Tracert deprecated：".concat(e))},u=document;return function(){function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n={autoLogPv:!0,eventType:"click",autoExpo:!1,bizType:"H5behavior",state:"",name:"",logLevel:"2",mdata:{},seedIdPrefix:"",seedIdSuffix:"",spmAPos:"",spmBPos:"",bizScenario:e.getValue("bizScenario")||"",paramPrefix:"",debug:!1,server:"",lastClkSpm:"",url:location.href.split(/\?|#|;jsessionid=/)[0],referSPM:"",srcSpm:"",sessionIdKey:"tracert-session-key",seedIdCfg:{pageSeedId:"H5_MTRACKER_AP_PAGE",clkSeedId:"H5_MTRACKER_AP_CLK",calcSeedId:"H5_MTRACKER_AP_CALC",expoSeedId:"H5_MTRACKER_AP_EXPO",syslogSeedId:"H5_MTRACKER_AP_SYSLOG"},_plugins:[],platformType:"",ready:!1,apiCashList:[],timeMap:{},expoOnce:!1,_wap_intervalEx:400,_wap_interval:300,_wap_mgObjIndex:0,_wap_exObjIndex:0,_wap_mgTdObjIndex:0,_expoMergeItvObj:0,hasExpoMerge:!1,fmtedExObjArr:[],fmtedExObj:{},fmtedExOptions:{},cacheExObjArr:[],cacheMrExObjArr:[],expotTimeout:300,expoObj:{},expoType:function(t){var n=!1;e.addEvent("scroll",u,function r(){n||(n=!0,e.removeEvent("scroll",u,r),setTimeout(function(){n=!1,e.addEvent("scroll",u,r)},300),t())})},expoSection:[-.3,.3],_beforeEvObj:{logPv:[],click:[],expo:[],set:[],send:[]},_afterEvObj:{start:[],logPv:[],click:[],expo:[]},_pluginLoadCnt:0,sysInfo:{}};e.objectAssign(n,t),e.objectAssign(this,n);var a=window.TracertCmdCache;if(a&&a.length)for(var o=0;a.length>o;o++){var c=i([].slice.call(a[o])),l=c[0],d=c.slice(1);this.call.apply(this,[l].concat(s(d)))}this._start()}var a,c,d;return a=r,(c=[{key:"before",value:function(e,t){var n=this._beforeEvObj;if(!n[e])throw Error("目标方法不支持该事件");if("function"!=typeof t)throw Error("监听器不是函数");n[e].push(t)}},{key:"_runBeforeFns",value:function(e,t){var n=this._beforeEvObj[e]||[];if(!n||!n.length)return!0;for(var r=0;n.length>r;r++){if(!1===n[r].call(this,t))return console&&console.debug&&console.debug("Tracert before fns: ".concat(e," stop propagation")),!1}return!0}},{key:"after",value:function(e,t){var n=this._afterEvObj;if(!n[e])throw Error("目标方法不支持该事件");if("function"!=typeof t)throw Error("监听器不是函数");"start"===e&&this.ready?t():n[e].push(t)}},{key:"_runAfterFns",value:function(e,t){var n=this._afterEvObj[e]||[];if(n&&n.length)for(var r=0;n.length>r;r++)n[r].call(this,t)}},{key:"init",value:function(){}},{key:"load",value:function(t){e.load(t)}},{key:"onReady",value:function(e){this.ready?e&&e():document.addEventListener("TracertOnReady",function(){e&&e()})}},{key:"_start",value:function(){var t=this,n=function(){t.load(function(){if(!t.ready){var n=e.getMetaSpm();n.spmAPos=t.spmAPos||n.spmAPos,t.spmBPos||(n.spmBPos=e.getSpmBPos()),t.set(n),t.ready=!0;for(var r=0;t.apiCashList.length>r;r++){t.call.apply(t,t.apiCashList[r])}t._runAfterFns("start"),t.apiCashList=[]}})};this.pluginReady&&this.started?n():(document.addEventListener("TracertPluginReady",function(){t.started&&n()}),document.addEventListener("TracertStart",function(){t.pluginReady&&n()}))}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.run(e)}},{key:"run",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.set(o({},e,{started:!0}));var t=document.createEvent("HTMLEvents");t.initEvent("TracertStart",!0,!0),document.dispatchEvent(t),this.autoLogPv&&this.call("logPv")}},{key:"loadPlugins",value:function(e){if(e&&e.length){this._plugins=e;for(var t=0;e.length>t;t++){this.loadPlugin(e[t])}}}},{key:"loadPlugin",value:function(e){var t=this;e&&((window["tracert".concat(e)]&&"function"==typeof window["tracert".concat(e)]||"function"==typeof e)&&("function"==typeof e?e:window["tracert".concat(e)])(this,function(){if(t._pluginLoadCnt++,t._pluginLoadCnt===t._plugins.length){t.set({pluginReady:!0});var e=document.createEvent("HTMLEvents");e.initEvent("TracertPluginReady",!0,!0),document.dispatchEvent(e)}}))}},{key:"call",value:function(){var e,t=[].slice.call(arguments);if(!t[0]||"run"!==t[0]&&"start"!==t[0]||this.set({started:!0}),this.ready){if(!this[t[0]]||"function"!=typeof this[t[0]])return console.warn("未找到方法：".concat(t[0])),null;var n=t.slice(1);n=this.optionsHandle(n),e=this[t[0]].apply(this,n)}else this.apiCashList.push(t);return e}},{key:"optionsHandle",value:function(e){return e&&e.length?(e.forEach(function(e){var t=e;t&&(t.spmid&&(t.spmId=t.spmid),t.seedid&&(t.seedId=t.seedid),t.ucid&&(t.ucId=t.ucid))}),e):e}},{key:"get",value:function(e){return this[e]}},{key:"set",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n;this._runBeforeFns("set",r),r.eventName&&e.objectAssign(r,{eventType:r.eventName}),"object"===t(r.mdata)&&(r.mdata=o({},this.mdata,{},r.mdata)),e.objectAssign(this,r)}},{key:"getSysInfo",value:function(e){return this.sysInfo[e]}},{key:"setSysInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t;e.objectAssign(this.sysInfo,n)}},{key:"config",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l("请使用 set 方法"),this.set(e)}},{key:"remoteLog",value:function(){}},{key:"logPv",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._runBeforeFns("logPv",e);t&&(this._logPv(e),this._runAfterFns("logPv",e))}},{key:"_logPv",value:function(){}},{key:"report",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.params,r=e.spmId;if(r){var a=r.split("."),i=a[0],s=a[1];i&&s&&this.set({spmAPos:i,spmBPos:s})}"object"===t(n)&&this.set({mdata:o({},this.mdata,{},n)}),this.set({_calledLogPv:!!r}),this.call("logPv")}},{key:"pageState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.set({state:e}),this.call("logPv")}},{key:"pageName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";l("已废弃"),this.set({name:e})}},{key:"setPageState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.call("pageState",e)}},{key:"time",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="".concat(e),n=this.timeMap;t&&!n[t]&&(n[t]=new Date-0)}},{key:"timeEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="".concat(e),n=this.timeMap;if(!t||!n[t])return"";var r=n[t],a=new Date-0-r;return delete n[t],a}},{key:"_goRemotelog",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n.seedId||n.spmId){var r=n.spmId||n.spmid||"",a=r.split("."),o=a.length,i=this.spmAPos,s=this.spmBPos;if(i&&s)switch(o){case 1:case 2:if(""===r)break;if(0!==r.indexOf("c"))break;r=[i,s,r].join(".")}var c={ucId:n.ucId,seedId:n.seedId,spmId:r,actionId:n.actionId,logLevel:n.logLevel||this.logLevel,param4:n.mdata||{}};if(n.type&&(c.type=n.type),n.params&&"object"===t(n.params))if(n.params.length)e.objectAssign(c,{param1:n.params[0]||"",param2:n.params[1]||"",param3:n.params[2]||""});else{var l=n.mdata||{};e.objectAssign(l,n.params),e.objectAssign(c.param4,l)}if(n.timeKey){var u=this.call("timeEnd",n.timeKey);u&&(c.param4.consume=u)}this.call("remoteLog",c)}else console.warn("请填入埋点seedId或spmId")}},{key:"info",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._goRemotelog(e)}},{key:"error",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.objectAssign(t,{type:"error",actionId:"exception"}),this._goRemotelog(t)}},{key:"click",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={spmId:n,extra:r,options:a},s=this._runBeforeFns("click",i);if(s){var c=r.extraSpmIds;i.extra.extraSpmIds&&delete i.extra.extraSpmIds;var l=i.spmId.split(":"),u=l[1]?{seedDesc:l[1]}:{};e.objectAssign(u,e.dealExtra(i.extra,this.paramPrefix));var d={param1:this.url,param2:l[0],param4:u,seedId:this.seedIdCfg.clkSeedId,actionId:"clicked",spmId:l[0]};e.objectAssign(d,i.options),this.set({lastClkSpm:i.spmId}),this.call("remoteLog",o({},d),!0),c&&c.length&&c.forEach(function(e){t.call("remoteLog",o({},d,{extraPageId:e}),!0)}),this._runAfterFns("click",i)}}},{key:"expo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"up",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={spmId:t,offset:n,extra:r},o=this._runBeforeFns("expo",a);if(o){var i={param1:this.url,param2:a.spmId,param3:a.offset,param4:e.dealExtra(a.extra,this.paramPrefix),seedId:this.seedIdCfg.expoSeedId,actionId:"exposure",spmId:a.spmId};this.expoObj=this.expoObj||{},!1!==this.expoObj[a.spmId]?(this.expoOnce&&(this.expoObj[a.spmId]=!1),this.call("remoteLog",i),this._runAfterFns("expo",a)):console.warn("该埋点已经曝光过了")}}},{key:"calc",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l("calc 已废弃");var a={param1:this.url,param2:t,param3:n,param4:e.dealExtra(r,this.paramPrefix),seedId:this.seedIdCfg.calcSeedId,actionId:"timestamp"};this.call("remoteLog",a)}}])&&n(a.prototype,c),d&&n(a,d),r}()});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e=e||self).tracertPluginPerformance=t(e.tracertUtil)}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function o(e){for(var t=1;arguments.length>t;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(o,!0).forEach(function(t){n(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(o).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var a=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e){var t,n;t="undefined"!=typeof self?self:i,n=function(){if("object"==typeof window){var e,t=window,n={0:"navigate",1:"reload",2:"back_forward"},r=["unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart"];if(!t||!t.performance||"object"!=typeof t.performance)return e;if("function"==typeof t.performance.getEntries&&"function"==typeof t.performance.getEntriesByType&&"function"==typeof t.performance.getEntriesByName&&"function"==typeof t.performance.now&&t.performance.timeOrigin)return t.performance;return e={_entry:function(){for(var e=t.performance.timing,o=e.navigationStart||e.redirectStart||e.fetchStart,i={entryType:"navigation",initiatorType:"navigation",name:t.location.href,startTime:0,duration:e.loadEventEnd?e.loadEventEnd-o:0,redirectCount:t.performance.navigation.redirectCount,type:n[t.performance.navigation.type]},a=0;r.length>a;a++){var c=r[a],f=e[c];i[c]=f?f-o:0}return i}(),timeOrigin:t.performance.timing.navigationStart,getEntries:function(){return[this._entry]},getEntriesByType:function(e){return"navigation"!==e?[]:[this._entry]},getEntriesByName:function(e){return e!==t.location.href?[]:[this._entry]},now:function(){return Date.now()-t.performance.timing.navigationStart}}}},e.exports?e.exports=n():t.timing2=n()});var c=function(e){var t=e.records,n=e.start,r=e.timeout,o=e.load;if(0===t.length)return"number"==typeof r?r:0;"number"==typeof o&&t.forEach(function(e){e.weight=Math.pow(.5,Math.abs(parseFloat(e.t)-o)/1e3)});var i=t.map(function(e,n){if(0===n)return 0;var r=t[n-1];return e.domCnt===r.domCnt?0:(e.domCnt-r.domCnt)/(e.t-r.t)*("number"==typeof e.weight?e.weight:1)}),a=Math.max.apply(null,i),c=i.indexOf(a);return t[c].t-n},f="number"==typeof __PAINTY_STACK_LIMIT__?__PAINTY_STACK_LIMIT__:100;function u(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():Date.now()}var d=function(e,t){if("object"==typeof window&&"object"==typeof a){"function"==typeof e&&(t=e);var n=[],r=function e(){if("function"==typeof MutationObserver){var t=new MutationObserver(function(){n.push({t:u(),domCnt:document.getElementsByTagName("*").length}),n.length===f&&i()});return t.observe(document,{childList:!0,subtree:!0}),t.disconnect.bind(t)}var r=setTimeout(function(){n.push({t:u(),domCnt:document.getElementsByTagName("*").length}),n.length===f?i():e()},200);return function(){clearTimeout(r)}}();if("number"==typeof e)setTimeout(i,e);else{var o=!!navigator.userAgent.match(/iPhone|iPad|iPod/i);window.addEventListener(o?"pagehide":"beforeunload",i)}}function i(){if(r(),"object"==typeof a&&"function"==typeof a.getEntriesByType){var o=a.getEntriesByType("navigation");if(o&&o.length){var i=o[0];t(c({records:n,start:i.startTime,timeout:e,load:i.duration}))}}}},s=["connectEnd","connectStart","decodedBodySize","domComplete","domContentLoadedEventEnd","domContentLoadedEventStart","domInteractive","domainLookupEnd","domainLookupStart","duration","encodedBodySize","fetchStart","loadEventEnd","loadEventStart","redirectCount","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","transferSize","type","unloadEventEnd","unloadEventStart","workerStart","firstPaint","firstContentfulPaint","firstMeaningfulPaint"],l=function(e){if("object"!==t(e))return[];var n=e.getEntriesByType("paint"),r={};if(n.length){var o=(n.filter(function(e){return"first-paint"===e.name})[0]||{}).startTime,i=(n.filter(function(e){return"first-contentful-paint"===e.name})[0]||{}).startTime;r.firstPaint=parseFloat(o),r.firstContentfulPaint=parseFloat(i)}return r};var m=[10240,51200,102400,204800,512e3],p=m.length+1;function g(e){return m.reduce(function(t,n,r){var o=m[r-1]||0,i={name:"imageSizeGroup".concat(r,"Count"),field:"img_".concat(r),val:e.filter(function(e){return n>e.encodedBodySize&&e.encodedBodySize>o}).length};return t.concat(i)},[]).concat({name:"imageSizeGroup".concat(p,"Count"),field:"img_".concat(p),val:e.filter(function(e){return e.encodedBodySize>m[m.length-1]}).length})}var y=function(e){return"script"===e.initiatorType&&e.name.indexOf(".js")>-1},v=function(e){return"link"===e.initiatorType&&e.name.indexOf(".css")>-1},h=function(e){return"h2"===e.nextHopProtocol},S=function(e){return/^.*font.*\.svg(\?|$|#)/.test(e.name)},b=function(e){return"img"===e.initiatorType||/\.(jpg|jpeg|png|bmp|webp|svg|ico)(\?|$|#)/.test(e.name)&&!S(e)},E=function(e){return"iframe"===e.initiatorType},T=function(e){return"css"===e.initiatorType&&(/\.(ttf|eot|woff)(\?|$|#)/.test(e.name)||S(e))},w=function(e){return e.decodedBodySize>e.encodedBodySize},j=function(e){return e.encodedBodySize>e.transferSize},C=function(e){return e.workerStart},z=function(e){return e.reduce(function(e,t){return e+t.encodedBodySize},0)};var P=null,B=500;function O(t,n){var r={pid:"tracert",msg:t.message,code:n,page:location.href,c1:(t.stack||"").slice(0,500),c2:(t.stack||"").slice(500,1e3),c3:(t.stack||"").slice(1e3,1500)};(new Image).src="//gm.mmstat.com/fsp.1.1?".concat(e.objToStr(r,"&"))}function _(e,r){if("object"===t(r)&&!e.metricsSent)try{var i=r.getEntriesByType("navigation")[0],a=function(e,n){if("object"!==t(e)||"function"!=typeof e.getEntriesByType)return[];var r=[],o=e.getEntriesByType("navigation");if(!o||0===o.length)return[];var i=o[0],a=l(e),c={firstMeaningfulPaint:n};return s.forEach(function(e){var t=i[e]||a[e]||c[e];r.push(null==t||"number"==typeof t&&isNaN(t)?"-":"number"==typeof t?parseFloat(t.toFixed(2)):t)}),r}(r,P),c=function(e,n){if("object"!==t(e))return[];var r=e.getEntriesByType("resource").filter(function(e){return e.startTime&&n>e.startTime});if(0===r.length)return[];var o=r.filter(y),i=r.filter(v),a=r.filter(b),c=r.filter(T),f=r.filter(E);return{metrics:[{name:"resourceCount",field:"rcnt",val:r.length},{name:"resourceSize",field:"rsize",val:z(r)},{name:"jsCount",field:"jscnt",val:o.length},{name:"jsSize",field:"jssize",val:z(o)},{name:"cssCount",field:"csscnt",val:i.length},{name:"cssSize",field:"csssize",val:z(i)},{name:"imageCount",field:"imgcnt",val:a.length},{name:"imageSize",field:"imgsize",val:z(a)},{name:"fontCount",field:"fontcnt",val:c.length},{name:"fontSize",field:"fontsize",val:z(c)},{name:"iframeCount",field:"iframecnt",val:f.length},{name:"iframeSize",field:"iframesize",val:z(f)},{name:"Http2EnabledCount",field:"h2cnt",val:r.filter(h).length},{name:"compressedResourceCount",field:"crcnt",val:r.filter(w).length},{name:"cachedResourceCount",field:"carcnt",val:r.filter(j).length},{name:"serviceWorkerResourceCount",field:"swrcnt",val:r.filter(C).length}],imageGroupMetrics:g(a)}}(r,i.duration),f=function(e,n){return"object"!==t(e)?[]:e.getEntriesByType("resource").filter(function(e){return["xmlhttprequest","fetch"].indexOf(e.initiatorType)>-1&&n>=e.startTime}).map(function(e){return[e.name.split("?")[0],e.startTime,e.transferSize,Math.round(e.responseStart-e.startTime),e.duration]})}(r,i.duration);e.send(e.seedIdCfg.perfSeedId,o({nav:a.join("_")},(c.metrics||[]).reduce(function(e,t){return o({},e,n({},t.field,Math.round(t.val)))},{}),{img_group:(c.imageGroupMetrics||[]).map(function(e){return e.val}).join("_"),network:navigator.connection&&navigator.connection.effectiveType||"-",partial:0===i.duration?1:0,ajax:f.map(function(e){return e.join("-")}).join("_"),title:document.title,visible:document.hidden?0:1})),e.metricsSent=!0}catch(e){O(e,12)}}return function(e,n){return function(e){if("object"!==t(a))return e;try{d(function(e){P=e}),"function"==typeof a.setResourceTimingBufferSize&&a.setResourceTimingBufferSize(B);var n=!!navigator.userAgent.match(/iPhone|iPad|iPod/i);window.addEventListener(n?"pagehide":"beforeunload",_.bind(null,e,a))}catch(e){O(e,11)}}(e),n(),e}});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e=e||self).tracertPluginClickAndExpo=t(e.tracertUtil)}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){return window.getComputedStyle(e,t)}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;n>o;){var i=t[o];if(e.call(r,i,o,t))return i;o++}},configurable:!0,writable:!0});var l=16,s=500,d=120,f=l*l,h=[400,400],p=["deer-analysis-render-container","mocha"],v=[200,50],m=5,g=100,y=["svg","i","p","iframe","pre"],b=["label","input","button","img","iframe"],w=["svg","iframe","form","table"],x=["ul","header","section","article","aside"],k="`",T=">";function S(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function O(e,t){var n=S(e);if(0!==n.length){for(var r=0;n.length>r;r++)if(m>=Math.abs(n[r]-t))return void e[n[r]]++;e[t]=1}else e[t]=1}function N(e,t){if(!e||!e.children)return[];var n=[].slice.call(e.children)||[];return t?n.filter(t):n}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=N(e,function(e){return 8!==e.nodeType}),r=n.length;if("ul"===e.tagName.toLowerCase())return!0;if(1>=r&&t>r)return!1;if(r>g)return!1;for(var o,i="",a=!0,c={},u={},s={},d=0,f=0;r>f;f++){var p=n[f],v=(o=void 0,"div"===(o=p.tagName.toLowerCase())||"span"===o?"span":o);if(-1!==b.indexOf(v))return!1;if(p.offsetWidth>h[0]&&p.offsetHeight>h[1])return!1;(l>p.offsetWidth||l>p.offsetHeight)&&d++,O(c,Math.max(m,p.offsetWidth)),O(u,Math.max(m,p.offsetHeight));for(var y=0;p.classList.length>y;y++){var w=p.classList[y];s[w]=(s[w]||0)+1}if(a=i?i===v:a,i=v,!a)return!1}return a&&r/2>d&&-1!==function(e){if(Object&&Object.values)return Object.values(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}(s).indexOf(r)&&2>=S(c).length&&S(u).length<=r/2}function E(e){var t={};if(!e.attributes)return{};for(var n=0;e.attributes.length>n;n++){var r=e.attributes[n];t[r.name]=r.value}return t}function j(e){for(;e&&e.childNodes&&e.childNodes.length;){var t=[].slice.call(e.childNodes);if(t.find(function(e){return 3===e.nodeType}))return!0;e=t.filter(function(e){return!!e.tagName}).sort(function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft})[0]}return!!e&&!![].slice.call(e.childNodes||[]).find(function(e){return 3===e.nodeType})}for(var L=["div","span","a","p","button","ul","li","ol","img","h1","h2","h3","h4","h5","h6","form"],P={},I=0;16>I;I++)P[L[I]]=I;function H(e){return function(e){var t=e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:">");return Array.isArray(t)?t:[t]}(e,">").map(function(e){var t=e.split(":"),n=t[0],r=t[1],o=P.hasOwnProperty(n)?"".concat(P[n].toString(16)):n,i=r?r.replace(/nth-child\((\d+)\)/g,function(e,t){return"".concat(t)}).replace(/nth-of-type\((\d+)\)/g,function(e,t){return"t".concat(t)}):"";return"".concat(o).concat(i?"".concat(k).concat(i):"")}).join(T)}function A(e){var t=e.indexOf("\n");return-1!==t&&(e=e.substring(0,t)),e.trim().substring(0,15)}function D(e){if(!e||5===e.nodeType)return"";if(3===e.nodeType)return window.Text&&e instanceof Text?e.wholeText:e;if(!function(e){try{return e instanceof HTMLElement}catch(n){return"object"===t(e)&&1===e.nodeType&&"object"===t(e.style)&&"object"===t(e.ownerDocument)}}(e))return"";switch(e.tagName.toLowerCase()){case"img":return"img:".concat(e.src);case"canvas":return"canvas"}var n=function(e){return e.childNodes||[]}(e),r=N(e),o=E(e);return 0===n.length||function(e){for(var t=0;e.length>t;t++)if(3===e[t].nodeType)return!0;return!1}(n)||0===r.length?e.innerText||o.placeholder||o.alt||u(e,":before").content||u(e,":after").content:D(r[0])}function W(e){var t=D(e);if(t&&"string"==typeof t)return A(t.replace(/\s/g,""));if(!e||N(e).length>3)return"";var n=e.innerText;return n?A(n):3>N(e.parentNode).length?A(W(e.parentNode)):""}function _(e){var t,n=N(e);if(!n||!n.length)return W(e);if(1===n.length)return A(_(n[0]));for(;(t=N(e))&&t.length;)return A(W(e=[].slice.call(t).sort(function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft})[0]));return""}function M(e){var t=u(e);return"SCRIPT"===e.tagName||"none"===t.display||"relative"===t.position&&null===e.offsetParent||"absolute"===t.position&&(5>Math.abs(parseFloat(t.left)+e.offsetWidth)||5>Math.abs(parseFloat(t.top)+e.offsetHeight))||5>e.offsetWidth||5>e.offsetHeight}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(0===t)return!1;var n=N(e);if(0===n.length)return e.clientHeight>v;for(var r=0;n.length>r;r++){var o=n[r],i=u(o);if(("absolute"===i.position||i.float)&&o.clientHeight>v[1])return!0;if(R(o,t-1))return!0}return!1}function B(e){var t=e.getAttribute("id");return t&&t.substring(0,10)}function U(e){return e.classList&&e.classList.length?".".concat([].slice.call(e.classList,0,2).join(".")):""}function q(e){return e.id?B(e):U(e)}function F(e){return e.offsetWidth*e.offsetHeight}function J(e){var t=N(e);if(2>t.length||t.length>3)return!1;if(C(e,2))return!1;var n=e.offsetWidth,r=t[0],o=r.offsetWidth,i=r.offsetHeight,a=parseInt(u(r).lineHeight,10)||16;return o>=200&&o>=.9*n&&((!i||i>=a&&4*a>=i)&&!!j(r))}function V(e){var t=e;if(t.__possibleBlock)return!0;if("a"===e.tagName.toLowerCase())return!1;if(function(e){return e.id&&-1!==p.indexOf(e.id)}(t))return!1;if(C(t))return!1;var n=N(t);return!(!n||!n.length)&&(t.offsetWidth>=v[0]&&t.offsetHeight>=v[1])}function G(e){for(var t=N(e),n=0;t.length>n;n++)if(E(t[n]).hasOwnProperty("contenteditable"))return!0;return!1}function $(e){var t,n=e.tagName.toLowerCase(),r=e.parentNode;if(C(e.parentNode)&&r.children&&r.children.length){for(var o=0,i=0;r.children.length>i;i++){var a=r.children[i];if(a.tagName.toLowerCase()===n&&o++,a===e)break}return"".concat(n,":nth-of-type(").concat(o,")")}for(var c=0;r.children.length>c;c++)if(r.children[c]===e){t=c+1;break}return"".concat(n,":nth-child(").concat(t,")")}function z(e){return!!e&&(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return!1;var n=e.getBoundingClientRect(),r=window.innerHeight/2,o=50>Math.abs(n.top+n.height/2-r),i=window.innerWidth/2,a=50>Math.abs((n.right-n.left)/2-i);return 1===t?o||a:o&&a}(e)&&e.offsetParent&&function(e){if(!e)return!1;var t=window.getComputedStyle(e);return 50>Math.abs(e.offsetWidth-window.innerWidth)&&50>Math.abs(e.offsetHeight-window.innerHeight)&&("fixed"===t.position||e.offsetParent===document.body)}(e.offsetParent))}function K(e){var t=e.getBoundingClientRect();return 50>=Math.abs(t.width-window.innerWidth)&&(d>=t.height&&Math.abs(t.bottom-(e.offsetParent||document.body).offsetHeight)<=50)}window.getNodeText=W,window.getFirstNodeText=D,window.getBlockTitle=_,window.possibleBlock=V,window.possibleHeadedBlock=J;var Q=["data-node-selector","data-block-selector"];function X(e,t){var n=t||document.body;if(e===n||e===document.body)return"body";if(2>=arguments.length||void 0===arguments[2]||arguments[2])for(var r=0;Q.length>r;r++)if(e&&e[Q[r]])return e[Q[r]];var o=e,i=[];do{i.unshift($(o))}while(o.parentNode&&o.parentNode!==document.body&&o.parentNode!==n&&(o=o.parentNode));return i.join(">")}window._getSelector=X,window._isModal=z;var Y={};function Z(e){var t=1>=arguments.length||void 0===arguments[1]||arguments[1];return e.map(function(e){var n=e.node,r=e.selector||X(n,document.body,t);return n["data-block-selector"]=r,{block:n,selector:H(r)}})}function ee(e,t){var n=document.querySelector(e);if(!n||!function(e,t){if(e.contains&&"function"==typeof e.contains)return e.contains(t);var n=t;do{if(e===n)return!0}while(n=n&&n.parentNode);return!1}(n,t)){var r=Y[e];if(r){var o=X(r);return r["data-block-selector"]=o,Y[o]=r,r}return null}return n}function te(e){var t,n=(t=window.visualViewport)?[t.offsetLeft,t.offsetTop,t.width,t.height]:[0,0,window.innerWidth,window.innerHeight],r=n[1],o=n[0]+n[3],i=e.getBoundingClientRect(),a=i.top,c=i.bottom,u=i.height;return r>=a&&c>=o||a>=r&&o>=c||a>=r&&o-a>=Math.min(300,u/2)||o>=c&&c-r>=Math.min(300,u/2)}function ne(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{time:0,cnt:0},r=n.time,o=n.cnt,i={};if(!t)return i;var a=t.exposedTime+(void 0===r?0:r),c=t.exposedCnt+(void 0===o?0:o);return t.empty()&&document.body.contains(t.dom)?i[H(X(t.dom),document)]={time:a,cnt:c,title:t.title,type:t.type,id:B(t.dom),cls:U(t.dom)}:e.objectAssign(i,t.children.reduce(function(t,n){return e.objectAssign(t,ne(n,{time:a,cnt:c}))},i)),i}var re=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,r=arguments.length>1?arguments[1]:void 0;n(this,e),this.dom=document.body,this.children=[],this.selector="",this.lastExposingTime=0,this.exposedTime=0,this.exposedCnt=0,this.title="",this.type="",this.dom=t,this.type=r,this.title=_(t),this.expo()}return o(e,[{key:"visible",value:function(){return!!this.dom&&(!M(this.dom)&&te(this.dom))}},{key:"pause",value:function(){this.empty()?this.unexposed(!0):[].concat(this.children.filter(function(e){return e.pause()}))}},{key:"expo",value:function(){if(!this.empty())return[].concat(this.children.filter(function(e){return e.expo()}));var e=this.dom;return this.visible()?(this.exposed(),[e]):(this.unexposed(),[])}},{key:"getExposed",value:function(e){return ne(this,e)}},{key:"exposed",value:function(){return this.lastExposingTime?this.exposedTime+=Date.now()-this.lastExposingTime:this.exposedCnt++,this.lastExposingTime=Date.now(),this.exposedTime}},{key:"unexposed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.lastExposingTime){var t=Date.now()-this.lastExposingTime;(e||t>s)&&(this.exposedTime+=t)}return this.lastExposingTime=0,this.exposedTime}},{key:"empty",value:function(){return!this.children.length}},{key:"update",value:function(e){var t=this;e.forEach(function(e){return t.insert(e.node,e.type)}),Z(e,!1)}},{key:"contains",value:function(e){return this.dom!==e&&this.dom.contains(e)}},{key:"insert",value:function(t,n){var r=this;if(this.children=this.children.filter(function(e){return r.contains(e.dom)}),!this.children.find(function(e){return e.dom===t})){var o=this.children.find(function(e){return e.contains(t)});o?o.insert(t,n):this.children.push(new e(t,n))}}}]),e}();function oe(){return new re}var ie=e.addEvent,ae=e.debounce,ce=e.storage,ue=e.getAttr;function le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e)return[];for(var n,r=[],o=[],i=function(e){for(var t,n=[],r=[],o=0;e.length>o;o++){var i=e[o];i&&((t=i).id&&-1!==p.indexOf(t.id)||-1!==y.indexOf(t.tagName.toLowerCase())||M(i)?r.push(i):n.push(i))}return{ordered:n,disorderd:r}}(e),a=i.ordered,c=i.disorderd,u=0;c.length>u;u++){var l=c[u];R(l)&&(l.__possibleBlock=!0,a.push(l))}a.sort(function(e,t){return F(e)-F(t)});for(var s=0;a.length>s;s++){var f=a[s],h=N(f);if(ue(f,"data-aspm"))r=r.concat({node:f,type:"spm",selector:ue(f,"data-aspm")});else if(f&&f.tagName&&-1!==w.indexOf(f.tagName.toLowerCase()))r=r.concat([{node:f,type:"short"}]);else if(G(f))r=r.concat([{node:f,type:"ugc"}]);else if(C(f))r=r.concat([{node:t[0],type:"list"}]);else if(z(f))r=r.concat([{node:f,type:"modal"}]);else if(n=void 0,n=f.getBoundingClientRect(),Math.abs(n.width-window.innerWidth)>50||n.height>d||n.y>n.height)if(K(f))r=r.concat([{node:f,type:"footer"}]);else{if(J(f))if("continue"===function(){var e=le(h,[f].concat(t)),n=[],o=[];return e.forEach(function(e){"pattern"===e.type?n.push(e):o.push(e)}),r=r.concat(n&&n.length?n.concat(o):[{node:f,type:"pattern"}]),"continue"}())continue;if(f.offsetWidth>document.body.offsetWidth)r=r.concat(le(h,[f].concat(t)));else if(V(f)){if(1===h.length){var v=le(h,[f].concat(t),!0);r=r.concat(v&&v.length?v:[{node:f,type:"hoist"}]);continue}var m=le(h,[f].concat(t),!0);m&&m.length?r=r.concat(m):o.push({node:f,type:"stashed"})}else o.push({node:f,type:"stashed"})}else r=r.concat([{node:f,type:"header"}])}if(r.length>1){for(var g=0,b=t[0]||e[0],x=0;r.length>x;x++)if("list"===r[x].type&&g++,r[x].node===t[0]){if(b.__possibleBlock){r=r.concat([{node:b.parentNode,type:"hoist"}]);break}return[{node:b,type:"merge"}]}if(g>=r.length/2)return[{node:b,type:"hoist"}]}return o.length&&(r=a.length/2>r.length?[{node:t[0]||e[0],type:"end"}]:r.concat(o)),r}window._pickLayout=le;var se=function(){function e(t){var r=this;n(this,e),this.layout={},this.expoTree=null,this.paused=!1,this.pause=function(e){e.target!==window&&e.target!==document||r.paused||(r.expoTree.pause(),r.paused=!0)},this.resume=function(){r.paused&&(r.expoTree.expo(),r.paused=!1)},this.restore=function(){var e=r.tracert,t=ce.get("exposed",{},!0);if(t){var n=t.split("|"),o=n[0],i=n[1];try{var a=decodeURIComponent(o),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500,n=[];for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],i=o.time;n.push({time:i,text:[r,i,"",o.cnt,o.type,o.id,o.cls].join("")})}for(var a=n.sort(function(e,t){return t.time-e.time}),c=[],u=t,l=0;a.length>l;l++){var s=a[l].text,d=void 0===s?"":s;if(d.length>u)break;u-=d.length,c.push(d)}return c.join("")}(JSON.parse(i));a===r.tracert.refUrl&&e.after("start",function(){e.call("expo","deer_expo","",{expo:c})})}catch(e){}}},this.timeout=null,this.timeoutLog=function(){r.log(),r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(function(){return r.log()},s)},this.log=function(){r.paused||(r.cacheLayout(),r.expoTree.empty()||(r.expoTree.expo(),ce.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(ne(r.expoTree))))))},this.tracert=t,this.expoTree=oe(),this.events()}return o(e,[{key:"events",value:function(){var e=this;ie("blur",window,this.pause),ie("focus",window,this.resume),ie("visibilitychange",document,function(t){"hidden"===document.visibilityState?e.pause(t):"visible"===document.visibilityState&&e.resume()}),ie("scroll",window,ae(function(){return e.log()},200)),ie("beforeunload",window,function(){e.expoTree.expo();var t=ne(e.expoTree);ce.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(t)))}),this.tracert.before("logPv",function(){e.restore(),e.expoTree.expo();var t=ne(e.expoTree);ce.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(t))),Y={},e.expoTree=oe(),e.timeoutLog()})}},{key:"cacheLayout",value:function(){var e=le([document.body]);return this.expoTree.update(e),this.layout}},{key:"get",value:function(){return this.layout}}]),e}(),de=e.strToObj;window.isList=C;var fe=.5*document.body.scrollWidth,he=0,pe=1,ve=2,me=3,ge=4,ye=5;function be(e){var t=e;if(e instanceof SVGElement&&"svg"!==e.tagName.toLowerCase())try{return be(e.ownerSVGElement)}catch(e){return console.debug("Failed to get ownerSVGElement"),{node:parent,type:ye}}var n=[];do{if(e.id&&-1!==p.indexOf(e.id))return null;var r=E(e);if(e["data-block"]&&e["data-node-selector"])return{node:e,type:"CACHED",nodeSelector:e["data-node-selector"]};if(r["data-aspm"])break;if(r["data-aspm-click"])return{node:e,nodeSelector:"".concat(r["data-aspm-click"]),spm:!0,type:he};if("a"===e.tagName.toLowerCase())return{node:e,type:pe};if(-1===b.indexOf(e.tagName.toLowerCase())){var o=u(e).cursor||"default";n.push({node:e,type:me,cursor:o})}else n.push({node:e,type:ve})}while(e.parentNode&&e.parentNode!==document.body&&(e=e.parentNode));for(var i=0;n.length>i;i++){var a=n[i],c=a.type;if(c===ve)return{node:a.node,type:c}}var l,s,d,h=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t&&t.length&&n&&n.length?n.length>t.length-r?null:(Array.isArray(n[0])?n[0]:[n[0]]).find(function(e){return t[r].cursor===e})?1===n.length?0===r?null:t[r-1].node:e(t,n.slice(1),r+1):e(t,n,r+1):null}(n,["pointer",["default","auto"]]);return h?{node:h,type:me}:(s=(l=t).offsetWidth,d=l.offsetHeight,-1!==x.indexOf(l.tagName.toLowerCase())||f>s*d||Math.max(s,d)>fe||!j(l)&&!u(l).backgroundImage?null:{node:t,type:ge})}function we(e,t,n){var r=t.block,o=t.blockSelector,i=n.node,a=n.nodeSelector,c=n.nodeType,l=n.clickDom,s="";r&&(s=_(r),a=a||X(i,r));var d=W(e),f=l&&l.getAttribute?l.getAttribute("data-aspm-param"):"";return function(e){var t=e.dom,n=e.extraParams,r=e.block,o=e.blockSelector,i=e.blockTitle,a=e.blockId,c=e.node,u=e.nodeId,l=e.nodeSelector,s=e.nodeText,d=e.clickText,f=o||X(r);if(r&&(r["data-block-selector"]=f,Y[o]=r),c){c["data-block"]=f;var h=l||X(c,r);c["data-node-selector"]=h,Y[h]=c}return{dom:t,extraParams:n,node:l||X(c),nodeText:s,nodeId:u,block:(o||X(r)).replace(/\[data-aspm="([\w-]+)"\]/g,function(e,t){return t}),blockTitle:i,blockId:a,clickText:d}}({dom:e,extraParams:de(f),clickDom:l,node:i,nodeSelector:a,nodeMeta:{id:q(i),type:c,err:i.type===ge&&"pointer"!==u(i).cursor},nodeText:encodeURIComponent(d),block:r,blockTitle:encodeURIComponent(s),blockSelector:o,blockMeta:r?{id:q(r)}:null,clickText:encodeURIComponent(d)})}function xe(e){if(!e||e===document.body)return null;var t=be(e);if(!t)return null;var n=t.node,r=t.type,o=t.node;if("CACHED"===r){var i=n["data-block"],a=ee(i,n);if(a)return we(e,{block:a,blockSelector:i},{node:n,nodeSelector:t.nodeSelector,clickDom:o})}var c=t.nodeSelector;if(r===he&&-1!==c.indexOf(".")){var u=c.split("."),l=u[0],s=u[1];return we(e,{block:document.querySelector('[data-aspm="'.concat(l,'"]')),blockSelector:l},{node:n,nodeSelector:s,nodeType:r,clickDom:o})}for(var d=n,f=!1,h="",p=[];d&&d.parentNode&&d.parentNode!==document.body;){var v=d=d.parentNode,m=E(d);if(m["data-aspm"]){f=!0,h='[data-aspm="'.concat(m["data-aspm"],'"]');break}p.unshift(v)}if(f)return we(e,{block:d,blockSelector:h},{node:n,nodeSelector:c,nodeType:r,clickDom:o});for(;d=p.pop();)if(d["data-block-selector"]){var g=d["data-block-selector"],y=ee(g,d);if(!y)continue;return we(e,{block:y,blockSelector:g},{node:n,nodeSelector:c||X(n,y),clickDom:o})}var b=function(e){for(var t=e,n=[t];t.parentNode&&t.parentNode!==document.body;){var r=t.parentNode;n.push(r),t=r}return n}(e),w=function(e,t){for(var n=t.length;n>0;n--)for(var r=t[n],o=0;e.length>o;o++){var i=e[o].block;if(i===r)return i}return!1}(Z(le([document.body])),b);return w?we(e,{block:w,blockSelector:X(w)},{node:n,nodeSelector:c||X(n,w),clickDom:o}):null}var ke,Te,Se,Oe,Ne=window,Ce="nameStorage:",Ee=/^([^=]+)(?:=(.*))?$/,je="?",Le="=",Pe="&",Ie=encodeURIComponent,He=decodeURIComponent,Ae={},De={};function We(){var e,t=[],n=!0;for(var r in Ae)Ae.hasOwnProperty(r)&&(n=!1,e=Ae[r]||"",t.push(Ie(r)+Le+Ie(e)));Ne.name=n?ke:Ce+Ie(ke)+je+t.join(Pe)}!function(e){if(e&&0===e.indexOf(Ce)){var t=e.split(/[:?]/);t.shift(),ke=He(t.shift())||"";for(var n,r,o,i=t.join("").split(Pe),a=0,c=i.length;c>a;a++)(n=i[a].match(Ee))&&n[1]&&(r=He(n[1]),o=He(n[2])||"",Ae[r]=o)}else ke=e||""}(Ne.name),De.setItem=function(e,t){e&&void 0!==t&&(Ae[e]=t+"",We())},De.getItem=function(e){return Ae.hasOwnProperty(e)?Ae[e]:null},De.removeItem=function(e){Ae.hasOwnProperty(e)&&(Ae[e]=null,delete Ae[e],We())},De.clear=function(){Ae={},We()},De.valueOf=function(){return Ae},De.toString=function(){var e=Ne.name;return 0===e.indexOf(Ce)?e:Ce+e},Se="beforeunload",Oe=function(){We()},(Te=Ne)&&(Te.addEventListener?Te.addEventListener(Se,Oe,!1):Te.attachEvent&&Te.attachEvent("on"+Se,function(e){Oe.call(Te,e)})),Ne.nameStorage=De;var _e=De,Me=e.url,Re="https://render.alipay.com/p/s/deer-analysis-render/index.js?_t=".concat(Date.now()),Be="https://render.alipay.com/p/s/deer-analysis-render/index.css?_t=".concat(Date.now()),Ue=function(){e.load(function(){if(function(e){if(!e)return{};var t=e.split("&");if(!t.length)return{};for(var n={},r=0;t.length>r;r++){var o=(t[r]||"").split("=");n[o[0]]=o[1]||""}return n}(Me.parse(location.href).query).deer_tracert_token||_e.getItem("deer_tracert_token")){var e=document.createElement("script");e.type="text/javascript",e.src="".concat(Re),document.getElementsByTagName("HEAD").item(0).appendChild(e);var t=document.createElement("link");t.href=Be,t.rel="stylesheet",t.type="text/css",document.getElementsByTagName("HEAD").item(0).appendChild(t)}})},qe="data-extra-spm",Fe=[];function Je(t){if(t){var n=t.getAttribute(qe);if(!n)return;var r=function(e){return function(t){t&&e&&(t.extraSpmIdSet||(t.extraSpmIdSet={}),e.split(",").forEach(function(e){t.extraSpmIdSet[e]=!0}))}}(n);e.addEvent("click",t,r),Fe.push([t,r])}}function Ve(t){t.refreshExtraClickListeners=function(){Fe.forEach(function(t){var n=c(t,2);e.removeEvent("click",n[0],n[1])}),Fe=[];for(var t=document.querySelectorAll("[".concat(qe,"]")),n=0;t.length>n;n++)Je(t[n])},t.refreshExtraClickListeners()}var Ge=e.addEvent;return function(e,t){var n,r=e;if(!window.getComputedStyle||!document.body.classList)return t(),r;function o(t){n||(n=new se(e,{layout:t}),e.set({_expo:n}),Ue())}return e._layout?o(e._layout):e.before("set",function(e){e.hasOwnProperty("_layout")&&o(e._layout)}),Ge("click",document.body,function(e){var t=xe(e.target);t&&setTimeout(function(){var n=e.extraSpmIdSet,o=n?Object.keys(n):[],c=t.node,u=t.nodeText,l=t.nodeId,s=t.block,d=t.blockTitle,f=t.blockId,h=t.extraParams;c&&s&&r.after("start",function(){r.call("click","".concat(H(s),".").concat(H(c)),function(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(n,!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({nodeText:u,nodeId:l,blockTitle:d,blockId:f,extraSpmIds:o},h))})},0)}),Ve(r),t(),r}});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e=e||self).tracertPluginClientSession=t(e.tracertUtil)}(this,function(e){"use strict";var t=e.Cookies,n=e.uuid,i=".alipay.com",r=18e5,o="".concat(e.cookiesPrefix,"_SESSION"),a="tree";function u(){var e=t.get(o)||n();return t.set(o,e,{expires:new Date((new Date).getTime()+r),cookie:!0}),e}var c=e.objectAssign;return function(e,o){var f=e;return u(),f.before("logPv",function(e){var o=function(e){var o={domain:document.domain&&-1!==document.domain.indexOf(i)?i:null,cookie:!0,expires:new Date((new Date).getTime()+r)},u=function(e,n,i){return t.set(a,[e,n,i].join(""),o),{_trid:n,_trll:i}},c=n();if(!e)return{};var f=t.get(a,o,!0);if(!f)return u(e,c,1);var s=f.split(""),d=s[0],l=s[1],p=s[2];return d!==e?u(d,c,1):u(d,l,parseInt(p,10)+1)}(f.spmAPos),s=u();e.__sid=s,c(e,o)}),o(),f}});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t=t||self).tracertPluginFullfillRef=e(t.tracertUtil)}(this,function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var r=0;e.length>r;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var o=t.addEvent,n=t.storage,a=t.nodeListToArray,i=t.getAttr,c=t.url,l=".alipay.com",f=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tracert=e,this.isAlipayDomain=document.domain&&-1!==document.domain.indexOf(l),this.cookiesDomain=this.isAlipayDomain?l:null,this.tracert.before("logPv",function(t){t=t||{};var e=r.get(),o=r.getMetaSpmId();if(o&&r.tracert.set({_spmId:o}),e&&e.metaSpmId&&(t._refSpm=e.metaSpmId,r.tracert.set({_refSpm:t._refSpm})),r.tracert.refUrl&&"-"!==r.tracert.refUrl){var n={},a={};try{if(n=c.parse(r.tracert.url),a=c.parse(r.tracert.refUrl),n.host===a.host)return void r.tracert.set({referSPM:"".concat(r.tracert.spmAPos,".").concat(r.tracert.spmBPos)})}catch(t){}e&&(r.tracert.set({refUrl:e.fullUrl}),r.tracert.referSPM||r.tracert.set({referSPM:e.refSpm}))}}),o("click",window.document.body,function(t){r.cache(t.target)})}var f,s,u;return f=t,(s=[{key:"getMetaSpmId",value:function(){for(var t=a(window.document.getElementsByTagName("meta")),e="",r=0;t.length>r;r++){var o=t[r],n=i(o,"name"),c=i(o,"content");if(c&&n)switch(n){case"pagename":e=c}}return e?"".concat(this.tracert.spmAPos,".").concat(encodeURIComponent(e)):e}},{key:"cache",value:function(){var t=this.tracert.fullURL||"";t.length>150&&(t=this.tracert.url);var e=[t,"".concat(this.tracert.spmAPos,".").concat(this.tracert.spmBPos),this.getMetaSpmId()];n.set("fullfill_ref",e.join(""),{domain:this.cookiesDomain,cookie:!0})}},{key:"get",value:function(){var t=n.get("fullfill_ref",{domain:this.cookiesDomain},!0);if(!t)return null;var r=t.split(""),o=r[0],a=r[1],i=r[2],l=c.parse(this.tracert.refUrl),f=c.parse(o);return"object"!==e(l)||"object"!==e(f)?null:l.host===f.host?{fullUrl:o,refSpm:a,metaSpmId:i}:null}}])&&r(f.prototype,s),u&&r(f,u),t}();return function(t,e){var r=t,o=new f(r);return r.set({fullfillRef:o}),e(),r}});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t=t||self).tracertPluginTimeOnPage=e(t.tracertUtil)}(this,function(t){"use strict";function e(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var n=t.addEvent,i=t.storage,r=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pause=function(t){t.target===window&&(n.paused=!0,n._time_consumed+=Date.now()-n._start_timestamp)},this.resume=function(){n.paused&&(n._start_timestamp=Date.now())},this.cache=function(){var t=location.href,e=n.gettimeConsuming();i.set("residual","".concat(encodeURIComponent(t),"|").concat(e))},this._tracert_inst=e,this.paused=!1,this.start(),this.bindEventListeners()}var r,s,a;return r=t,(s=[{key:"start",value:function(){this._start_timestamp=Date.now(),this._time_consumed=0,this.lastClickEle=null,this.lastClickText=""}},{key:"bindEventListeners",value:function(){n("blur",window,this.pause),n("focus",window,this.resume),n("beforeunload",window,this.cache)}},{key:"gettimeConsuming",value:function(){return this.paused?this._time_consumed:this._time_consumed+(Date.now()-this._start_timestamp)}},{key:"getTime",value:function(){var t=i.get("residual",{},!0);if(!t)return null;var e=t.split("|"),n=e[0],r=e[1];try{if(decodeURIComponent(n)===this._tracert_inst.refUrl)return r}catch(t){return null}return null}}])&&e(r.prototype,s),a&&e(r,a),t}();return function(t,e){var n=t;n.before("logPv",function(t){var e,i=n.timeConsuming.getTime();i&&(t._consume=i),t._title=(e=document.title).length>20?"".concat(e.substring(0,10)).concat(e.substring(e.length-10),"|").concat(e.length-20):e,n.timeConsuming.cache(),n.timeConsuming.start()});var i=new r(n);return n.set({timeConsuming:i}),e(),n}});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e=e||self).tracertPluginLayout=t(e.tracertUtil)}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var i=e.addEvent,o=e.storage,a=7,c=30;function f(e){return e.length>c?e.substr(0,c):e}function u(e){var t;e=e||[];for(var n=0;e.length>n;n++){var r=e[n];r.isLeaf||(r.children&&!(r=u(r.children))||t&&t.area>=r.area||(t=r))}return t}function l(e){e=e||[];for(var t,n,r,i=[],o=0;e.length>o;o++)n=void 0,r=void 0,n=(t=e[o]).offsetWidth,r=t.offsetHeight,"none"!==t.style.display&&Math.min(n,r)>=20&&Math.max(n,r)>=200&&t.children&&t.children.length>0&&i.push(e[o]);return i}function h(e){for(var t=e.node;;){var n=l(t.children),r=n.length;if(r>1)return n.map(function(e){return{node:e,area:e.offsetWidth*e.offsetHeight}});if(1!==r)return null;t=n[0]}}function s(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=document.body,n=[{node:t,area:t.offsetWidth*t.offsetHeight}],r=1;;){var i=u(n);if(!i)break;var o=h(i);if(o?r-1+o.length>e?(i.children=o.splice(0,e-r+1),r=e):(i.children=o,r+=o.length-1):i.isLeaf=!0,r>=e)break}return n}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t||[];return e.forEach(function(e){var t,i="".concat(n,"").concat((t=e.node)===document.body?"body":t.className?".".concat(f(t.className)):f(t.nodeName.toLowerCase()));r.push(i),e&&e.children&&d(e.children,r,n+1)}),t?null:r.join("")}var v=function(){function e(n){var r=this;t(this,e),this.tracert=n,n.before("logPv",function(e){var t=r.get();t&&(e._layout=t)}),this.cache(),i("click",document.body,function(){r.cache()}),i("unload",window,function(){r.cache()})}return r(e,[{key:"getLayout",value:function(){return s(1/0)}},{key:"cache",value:function(){if(!this.cached){var e=s();o.set("layout","".concat(location.href,"|").concat(d(e))),this.cached=!0}}},{key:"get",value:function(){this.cached=void 0;var e=o.get("layout",{},!0);if(!e)return null;var t=e.split("|");return t[0]===this.tracert.refUrl?t[1]:null}}]),e}(),g=e.addEvent,y=e.storage,p=function(){function e(n){var r=this;t(this,e),this.tracert=n,this.tracert.before("logPv",function(e){var t=r.get();t&&(e._clickReferer=t)}),g("click",document.body,function(e){r.cache(e.target)})}return r(e,[{key:"cache",value:function(e){var t=this.getText(e),n=this.getSectionHead(e),r="";n&&(r=this.getSectionTitle(n)),y.set("clickReferer","".concat(location.href,"").concat(this.format(t),"").concat(this.format(r)))}},{key:"get",value:function(){var e=y.get("clickReferer",{},!0);if(!e)return null;var t=e.split(""),n=t[2];return t[0]===this.tracert.refUrl?"".concat(t[1],"").concat(n):null}},{key:"getSectionTitle",value:function(e){for(;e&&e.children&&e.children.length;)e=[].slice.call(e.children).sort(function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft})[0];return this.getText(e)}},{key:"getSectionHead",value:function(e){for(;e.parentNode;){var t=e,n=e=e.parentNode,r=n.offsetWidth;if(r>=200&&r<document.body.offsetWidth){var i=n.children;if(i&&i.length){var o=i.length;if(o>=2&&3>=o&&i[0]!==t){var a=i[0],c=a.offsetWidth,f=a.offsetHeight;if(!(200>c||.9*r>c||14>f||f>60))return a}}}}return null}},{key:"getText",value:function(e){if(this.isTooManyChildren(e,3))return"";var t=e.innerText;if(!t){var n=e.parentNode;this.isTooManyChildren(n,3)||(t=n.innerText)}return t}},{key:"format",value:function(e){if(!e)return"";var t=e.length;return t>20?"...".concat(e.substr(t-20)):e}},{key:"isTooManyChildren",value:function(e,t){var n=0,r=function(e){var i=e.children;if(i){var o=i.length;if(t>=(n+=o)&&o)for(var a=0;o>a;a++)if(r(i[a]),n>t)return}};return r(e),n>t}}]),e}();return function(e,t){var n=e,r=new v(n),i=new p(n);return n.set({_layout:r,clickReferer:i}),t(),n}});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e=e||self).tracertPluginBucName=t(e.tracertUtil)}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var i=0;t.length>i;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function n(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=e.load,c=e.CrossIframe;function a(e,t,i){e.postMessage(JSON.stringify({type:t,content:i}),"*")}var u=function(){function e(){var i=this;t(this,e),this.iframe=null,this.iframeLoaded=!1,this.userId=null,this.pending=!1,this.queue=[],this.cachedQuery=[],s(function(){window.addEventListener("message",function(e){return i.receive(e)},!1),i.pending=!0,i.iframe=c.initIframe()})}return r(e,[{key:"receive",value:function(e){var t;if(e.data){try{t=JSON.parse(e.data)}catch(e){return}if(t.type)switch(t.type){case"getBucUserId":for(this.userId=t.content,this.pending=!1;this.queue.length;){(0,this.queue[0])(t.content),this.queue.shift()}break;case"iframOnload":this.iframeOnLoad()}}}},{key:"iframeOnLoad",value:function(){this.iframeLoaded=!0,this.executeCachedQuery()}},{key:"executeCachedQuery",value:function(){if(this.cachedQuery.length)for(var e=0;this.cachedQuery.length>e;e++){var t=n(this.cachedQuery[e]),i=t[0],r=t.slice(1);this[i].apply(this,r)}}},{key:"getBucUserId",value:function(e){this.iframeLoaded?(this.queue.push(e),this.pending||(a(this.iframe.contentWindow,"getBucUserId"),this.pending=!0)):this.cachedQuery.push(["getBucUserId",e])}},{key:"setBucUserId",value:function(e,t,i){var r=this;this.iframeLoaded?(this.queue.push(function(){r.userId=t,i()}),a(this.iframe.contentWindow,"setBucUserId",t)):this.cachedQuery.push(["setBucUserId",e,t,i])}}]),e}();var o=e.objectAssign,d=e.Cookies,h=function(){function e(i,r){var n=this;t(this,e),this.tracert=i,o(this,r),this.tracert.after("start",function(){setTimeout(function(){return n.init()},0)})}return r(e,[{key:"init",value:function(){if("undefined"==typeof WeixinJSBridge&&(!window.navigator||-1>=window.navigator.userAgent.toLowerCase().indexOf("micromessenger")&&void 0===window.navigator.wxuserAgent)){if(this.isAlipayDomain=-1!==document.domain.indexOf(".alipay.com"),this.tracert.bucUserId||this.tracert.roleId)return this.setBucUser(),this.tracert.backupUserId=this.tracert.bucUserId||this.tracert.roleId,void this.tracert.call("logPv");var e=this.isAlipayDomain?".alipay.com":null;if(this.tracert.bucUserId=d.get("".concat("__TRACERT_COOKIE_","bucUserId"),{domain:e})||d.get("bucUserId",{domain:e}),this.tracert.bucUserId)return this.synchronousBucId(!1),void this.tracert.call("logPv");this.synchronousBucId(!0)}}},{key:"setLocalBucUserId",value:function(){d.set("".concat("__TRACERT_COOKIE_","bucUserId"),this.tracert.bucUserId||this.tracert.roleId,{domain:this.isAlipayDomain?".alipay.com":null})}},{key:"setBucUser",value:function(){this.setLocalBucUserId(),this.isAlipayDomain||this.cookiesHelper.setBucUserId("userId",this.tracert.bucUserId||this.tracert.roleId,function(){})}},{key:"synchronousBucId",value:function(e){var t=this;this.cookiesHelper.getBucUserId(function(i){i&&(t.tracert.bucUserId=i,t.setLocalBucUserId()),e&&t.tracert.call("logPv")})}},{key:"cookiesHelper",get:function(){return this._cookiesHelper||(this._cookiesHelper=new u),this._cookiesHelper}}]),e}();return function(e,t){var i=e,r=new h(i);return i.set({autoLogPv:!1,buc:r}),t(),i}});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t=t||self).tracertPluginAutoLogPv=e(t.tracertUtil)}(this,function(t){"use strict";function e(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=t.url;function n(){return document.body&&document.body.innerText&&document.body.innerText.length||0}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tracert=e,this.curUrl=e.get("fullURL");var i=this.curUrlObj=r.parse(this.curUrl);this.curDocLen=n();var a=i.hash,s=this.isAnchor(a);s||(i.hash=this.cleanHash(a)),this.tracert.call("set",{url:s?this.curUrl.split(/\?|#/)[0]:i.format()}),this.start()}var i,a,s;return i=t,(a=[{key:"start",value:function(){var t=this;this.interval=setTimeout(function(){t.check(),t.start()},500)}},{key:"stop",value:function(){clearTimeout(this.interval),this.interval=void 0}},{key:"check",value:function(){var t=window.location.href,e=this.diff(t);e&&(this.tracert.call("set",{refUrl:this.curUrl,referSPM:"".concat(this.tracert.spmAPos,".").concat(this.tracert.spmBPos),url:e.isHashSinglePage?e.format():t.split(/\?|#/)[0],fullURL:t}),this.tracert.call("logPv",e.isHashSinglePage?{}:{_nohash:1}));this.curUrl=t,this.curUrlObj=e||r.parse(t),this.curDocLen=n()}},{key:"diff",value:function(t){if(t===this.curUrl)return!1;var e=r.parse(t),n=e.hash,i=this.curUrlObj;return e.path===i.path&&function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return JSON.stringify(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})===JSON.stringify(t)}(e.query,i.query)?n!==i.hash&&(!this.isAnchor(n)&&(e.isHashSinglePage=!0,e.hash=this.cleanHash(e.hash),e)):e}},{key:"isAnchor",value:function(t){return!(!t||"#"===t)&&("/"!==(t=t.substr(1))[0]&&(document.getElementById(decodeURI(t))&&5>Math.abs(this.curDocLen-n())))}},{key:"cleanHash",value:function(t){if(!t)return t;var e=t.indexOf("?");return-1!==e&&(t=t.substr(0,e)),t}}])&&e(i.prototype,a),s&&e(i,s),t}();return function(t,e){var r=t,n=new i(r);return r.set({monitor:n}),r.before("set",function(t){if(t&&t.pathName&&r.spmAPos){n.stop();var e=t.pathName,i=r.pathName;r._spmId&&(r._refSpm=r._spmId),r.fullURL=location.href,r.url=location.href.split(/\?|#|;jsessionid=/)[0],r._spmId="".concat(r.spmAPos,".").concat(encodeURIComponent(e)),i&&(r.refUrl=r.url,r.referSPM="".concat(r.spmAPos,".").concat(r.spmBPos),r.call("logPv"))}}),e(),r}});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e=e||self).tracertWeb=t(e.tracertUtil)}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function i(e){for(var t=1;arguments.length>t;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(i,!0).forEach(function(t){n(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var r,s,a,c,f=window,d="nameStorage:",l=/^([^=]+)(?:=(.*))?$/,p="?",u="=",h="&",m=encodeURIComponent,g=decodeURIComponent,I={},v={};function _(){var e,t=[],n=!0;for(var o in I)I.hasOwnProperty(o)&&(n=!1,e=I[o]||"",t.push(m(o)+u+m(e)));f.name=n?r:d+m(r)+p+t.join(h)}!function(e){if(e&&0===e.indexOf(d)){var t=e.split(/[:?]/);t.shift(),r=g(t.shift())||"";for(var n,o,i,s=t.join("").split(h),a=0,c=s.length;c>a;a++)(n=s[a].match(l))&&n[1]&&(o=g(n[1]),i=g(n[2])||"",I[o]=i)}else r=e||""}(f.name),v.setItem=function(e,t){e&&void 0!==t&&(I[e]=t+"",_())},v.getItem=function(e){return I.hasOwnProperty(e)?I[e]:null},v.removeItem=function(e){I.hasOwnProperty(e)&&(I[e]=null,delete I[e],_())},v.clear=function(){I={},_()},v.valueOf=function(){return I},v.toString=function(){var e=f.name;return 0===e.indexOf(d)?e:d+e},a="beforeunload",c=function(){_()},(s=f)&&(s.addEventListener?s.addEventListener(a,c,!1):s.attachEvent&&s.attachEvent("on"+a,function(e){c.call(s,e)})),f.nameStorage=v;var y=v,b={_guid:function(){return e.uuid()},_initClientId:function(e){var t=window.localStorage,n=e.sessionIdKey;t&&(t[n]||(t[n]="".concat(this._guid(),"_").concat(Date.now())),e.set({clientId:t[n]}))},_initChInfo:function(t){if(!t.chInfo){var n=e.getValue("chInfo")||e.getValue("chinfo");n&&t.set({chInfo:n})}},_initPageId:function(e){if(!e.get("pageId")){var t="".concat(e.spmAPos,".").concat(e.spmBPos,"_").concat(this._guid(),"_").concat(Date.now());e.set({pageId:t})}},_initFromUrlOrStorage:function(t,n){for(var o=0;n.length>o;o++){var i=n[o],r=e.getValue(i)||y.getItem("".concat("TRACERT_REF_").concat(i));if(r){var s={};s[i]=r,t.set(s)}}},_initRefs:function(e){this._initFromUrlOrStorage(e,["referSPM"]),e.ignoreNameStorage||(window.onunload=function(){var t=e.spmAPos&&e.spmBPos?[e.spmAPos,e.spmBPos].join("."):"";t&&y.setItem("".concat("TRACERT_REF_","referSPM"),t)})}},P=e.objectAssign,w={eventType:"click",fullURL:location.href,server:"https://mdap.alipay.com/loggw/dwcookieLogGet.do",refUrl:document.referrer||"-",seedIdCfg:{pageSeedId:"10012",clkSeedId:"10032",expoSeedId:"10022",perfSeedId:"10074",exceptionSeedId:"102022"},init:function(){this._calledInited||(b._initClientId(this),b._initChInfo(this),b._initPageId(this),b._initRefs(this),this._calledInited=!0)},_logPv:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.spmAPos&&this.spmBPos?[this.spmAPos,this.spmBPos].join("."):"",o=document.getElementsByTagName("meta")["extra-page-spm"],r=[null].concat(o&&o.content?o.content.split(","):[]);r.forEach(function(o){e.call("remoteLog",{seedId:e.seedIdCfg.pageSeedId,spmId:n,extraPageId:o,param4:i({},t)})})},remoteLog:function(e){this.init();var t=this._packFinalData(e);this._send(t)},_packFinalData:function(n){var o=n.spmId,i=n.seedId,r=n.param4,s=n.extraPageId;P(r,this.mdata||{});var a=r.__sid||b._guid();if(delete r.__sid,r.spmId=o,i!==this.seedIdCfg.pageSeedId){var c=this.spmAPos,f=this.spmBPos;switch(o.split(".").length){case 1:if(""===o)break;r.spmId=[c,f,o].join(".");break;case 2:r.spmId=[c,f,o].join(".")}}var d=new Date,l=this.refSpm||this.referSPM||"";r.ref=this.refUrl,r.referSPM=l,r.chInfo&&(r.chInfo=this.chInfo),r.fullURL=this.fullURL,r.source_appid=this.spmAPos,this._spmId&&(r._spmId=this._spmId),this._refSpm&&(r._refSpm=this._refSpm),this.platformType&&(r.mPlatformType=this.platformType),this.bucUserId&&(r.__BUC_ID=this.bucUserId);var p=this.userType;if(!p)switch(p="3",this.spmAPos){case"a385":case"a369":p="2";break;case"a316":p="1"}r.__ut=p;var u=this.role_id||this.roleId||this.backupUserId||(r&&"3"===r.__ut?this.bucUserId:"")||"";if(r.clientID=this.clientId,"object"===t(r)){var h=r;for(var m in h)if(h.hasOwnProperty(m)&&"string"==typeof h[m]){var g=h[m].replace(/,/g,"%2C").replace(/\s+/g," ").replace(/=/g,"%3D");h[m]="fullURL"===m&&g.length>300?g.slice(0,300):g}}for(var I=function(e){return 10>e?"0".concat(e):"".concat(e)},v=["D-AE","".concat(d.getFullYear(),"-").concat(I(d.getMonth()+1),"-").concat(I(d.getDate())," ").concat(I(d.getHours()),":").concat(I(d.getMinutes()),":").concat(I(d.getSeconds()),":").concat(d.getMilliseconds()),this.clientID,"","2","",a,u,1e3,i,this.bizType,this.logLevel,s||this.pageId,"","","","","","","","","","","","","".concat(window.innerWidth||"","x").concat(window.innerHeight,"x").concat(window.devicePixelRatio),"","","",navigator.userAgent,"","","",e.objToStr(this.sysInfo),"","",e.objToStr(r)],_=0;v.length>_;_++)"string"==typeof v[_]&&(v[_]=v[_].replace(/,/g,"%2C"));return v},_send:function(e){var t=window.encodeURIComponent;(this.debug&&console.log(e),this.server)?(new Image).src="".concat(this.server,"?data=").concat(t(e.join()),"&time=").concat((new Date).getTime()):console.warn("请配置Tracert服务接收地址")},send:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"10032",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this._runBeforeFns("send",t),this.remoteLog({spmId:n||"".concat(this.spmAPos,".").concat(this.spmBPos),seedId:e,param4:t})}},S=e.objectAssign;return function(e,t){var n=e;return S(n,w),t(),n}});
 'use strict'; var win = window; if (!win.Tracert || win.Tracert._isInit || win.Tracert._isRenderInit) { var Tracert = new win.tracertCore(); Tracert.set({ userType: '3', spmAPos: 'a475', spmBPos: 'b5128' }); Tracert.setSysInfo({ v: '744fc' }); var plugins = [ win.tracertWeb, win.tracertPluginPerformance, win.tracertPluginClickAndExpo, win.tracertPluginClientSession, win.tracertPluginFullfillRef, win.tracertPluginTimeOnPage, win.tracertPluginLayout, win.tracertPluginBucName, win.tracertPluginAutoLogPv ]; Tracert.loadPlugins(plugins); win.Tracert = Tracert; } 