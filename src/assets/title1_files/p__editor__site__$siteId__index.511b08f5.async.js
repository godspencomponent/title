(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"+A24":function(e,t,a){"use strict";var n=a("fbTi"),i=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a("43Yg")),r=i(a("/tCh")),o=i(a("scpF")),s=i(a("O/V9")),u=i(a("8aBX")),c=i(a("cDcd")),d=i(a("iczh")),p=n(a("MetU")),f=a("jXAE"),h=i(a("kfnS")),m=f.Select.Option,g=p.getField,v=g("textfield"),y={text:__("\u94fe\u63a5\u5730\u5740"),local:__("\u672c\u7ad9\u9875\u9762")},E="",b="";function C(e,t){if(e&&t&&t.length>0){var a=t.some(function(t){return t.url.trim()===e.trim()});if(a)return!0}return!1}var P=function(e){function t(e){var a;(0,l.default)(this,t),a=(0,o.default)(this,(0,s.default)(t).call(this,e)),a.handleSwitchCheckType=function(e){var t=a.state.data;if("local"===e){var n=a.props.config,i=n.localUrlData;if(t=b,(0,h.default)(b)){var l=i.find(function(e){return e.isHomePage})||{};t=l.url||__("\u672c\u7ad9\u9875\u9762")}}else t=E;a.setState({checkType:e},function(){a.onChange(t)})};var n=C(e.data,e.config.localUrlData);return a.state={checkType:n?"local":"text",data:e.data},a}return(0,u.default)(t,e),(0,r.default)(t,[{key:"componentWillReceiveProps",value:function(e){e.data!==this.props.data&&this.setState({data:e.data})}},{key:"handleSelect",value:function(e){b=e,this.onChange(e)}},{key:"handleInputChange",value:function(e){var t=e.target.value.trim();E=t,this.onChange(t)}},{key:"onChange",value:function(e){e!==this.state.data&&this.props.onChange({value:e,fields:[this.props.field]})}},{key:"renderInputOrSelect",value:function(){var e=this,t=this.props.config,a=t.localUrlData,n=this.state,i=n.data,l=n.checkType;if("local"===l){var r=a.map(function(e,t){var a=c.default.createElement("div",{className:"editor-editor-url-select-item"},c.default.createElement("div",null,e.name,e.isHomePage?c.default.createElement("span",null,__("\u9996\u9875")):null),c.default.createElement("p",null,e.text));return c.default.createElement(m,{value:e.url,key:t},a)});return c.default.createElement(f.Select,{size:"large",value:i,dropdownClassName:"editor-select editor-editor-url-select",onChange:function(t){return e.handleSelect(t)}},r)}return c.default.createElement(f.Input,{value:i,onChange:function(t){return e.handleInputChange(t)},onBlur:function(t){return e.handleInputChange(t)},size:"large"})}},{key:"render",value:function(){var e=this.props,t=e.field,a=e.schema,n=e.data,i=e.config,l=this.props.config,r=l.localUrlData,o=l.localUrlText,s=this.state.checkType;if(!r||r.length<2)return c.default.createElement(v,Object.assign({},this.props));var u=Object.keys(y).map(function(e){var t="local"===e&&o||y[e];return c.default.createElement(m,{value:e,key:e},t)}),p=null,h="";"local"!==s&&(h=i.validate(n,a.meta,a.type),h&&(p=c.default.createElement("div",{className:"ant-form-explain"},h)));var g=(0,d.default)("ui-form-item","item-url-input",{"has-error":!!p});return c.default.createElement("div",{className:g},c.default.createElement("span",{className:"ui-label",title:t},a.description),c.default.createElement("div",{className:"ui-content"},c.default.createElement(f.Select,{className:"item-checktype",dropdownClassName:"editor-select",defaultValue:s,onChange:this.handleSwitchCheckType,size:"large"},u),c.default.createElement("div",{className:"item-type-url"},this.renderInputOrSelect())),p)}}]),t}(c.default.Component),k=P;t.default=k},"/FW/":function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,l=n(a("43Yg")),r=n(a("/tCh")),o=n(a("scpF")),s=n(a("O/V9")),u=n(a("8aBX")),c=a("leIJ"),d=a("jXAE"),p=a("yEuz"),f=n(a("iczh")),h=n(a("cDcd")),m=a("LfU0"),g=a("gzPx"),v=function(e,t,a,n){var i,l=arguments.length,r=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(l<3?i(r):l>3?i(t,a,r):i(t,a))||r);return l>3&&r&&Object.defineProperty(t,a,r),r},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};a("FQ53");var E=function(e){function t(e){var a;return(0,l.default)(this,t),a=(0,o.default)(this,(0,s.default)(t).call(this,e)),a.dispatch=window.g_app._store.dispatch,a}return(0,u.default)(t,e),(0,r.default)(t,[{key:"reset",value:function(){var e=this.props.present.page.activeSchema;this.dispatch({type:"page/resetRefreshMeta",payload:{refresh:!0,scrollComponentId:e.componentId}}),this.pluginModel.resetModal()}},{key:"handleUndo",value:function(){this.props.past.length>0&&(this.dispatch({type:p.ActionTypes.UNDO,payload:{ignoreKeys:this.getPluginSchemaDataPaths()}}),this.reset())}},{key:"handleRedo",value:function(){this.props.future.length>0&&(this.dispatch({type:p.ActionTypes.REDO,payload:{ignoreKeys:this.getPluginSchemaDataPaths()}}),this.reset())}},{key:"getPluginSchemaDataPaths",value:function(){var e=this.props.present,t=e.site.siteData,a=t.pluginList,n=t.papilioPackage.schemas,i=void 0===n?{}:n,l=e.page.pageData;return a.map(function(e){var t=e.location,a=t.pageId,n=t.schemaName,r=t.componentId,o=e.pluginServiceId,s=l.findIndex(function(e){return e.id===a}),u=l[s].schemaData.findIndex(function(e){return e.componentId===r&&e.schemaName===n}),d=(0,c.getPluginDataPath)(i[n],o);return"page.pageData[".concat(s,"].schemaData[").concat(u,"].data.").concat(d)})}},{key:"render",value:function(){var e=this,t=this.props,a=t.past,n=t.future,i=(0,f.default)("sent-undo",{"se-undo-tools-disable":0===a.length}),l=(0,f.default)("sent-redo",{"se-undo-tools-disable":0===n.length});return h.default.createElement("div",{className:"se-undo-tools"},h.default.createElement("span",{className:i,onClick:function(){return e.handleUndo()}},h.default.createElement(d.Icon,{type:"chexiao"})),h.default.createElement("span",{className:l,onClick:function(){return e.handleRedo()}},h.default.createElement(d.Icon,{type:"zhongzuo"})))}}]),t}(h.default.Component);v([(0,m.inject)(),y("design:type","function"===typeof(i="undefined"!==typeof g.PluginModel&&g.PluginModel)?i:Object)],E.prototype,"pluginModel",void 0),E=v([(0,m.connect)(),y("design:paramtypes",[Object])],E);var b=(0,m.connect)(function(e){return{past:e.past,future:e.future,present:e.present}})(E);t.default=b},"0HeX":function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=a("L5c0"),d=n(a("AFmn")),p=n(a("iczh")),f=a("Hws7");a("fDY/");var h=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={lockData:null},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.site.siteData;e.status!==f.SiteStatusEnum.IN_GREY&&this.checkLock()}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.lockData!==t.lockData}},{key:"checkLock",value:function(){var e=this,t=this.props,a=t.owner,n=t.site.siteData;(0,d.default)().getSiteLock(n.id).then(function(t){t.owner.username!==a.name?(e.setState({lockData:t}),e.props.dispatch({type:"site/updateLockStatus"})):(clearTimeout(e.timer),e.timer=setTimeout(function(){clearTimeout(e.timer),e.checkLock()},5e3),e.setState({lockData:null}))})}},{key:"render",value:function(){var e=this.state.lockData,t=(0,p.default)("site-editor-lock",{"site-editor-lock-active":!!e});return u.default.createElement("div",{className:t},e&&e.owner?u.default.createElement("div",{className:"site-editor-lock-box"},u.default.createElement("span",null,e.owner.nick," ",__("\u6b63\u5728\u7f16\u8f91\u7ad9\u70b9")),u.default.createElement("span",null,__("\u8bf7\u8054\u7cfb\u4ed6/\u5979\u5173\u95ed\u9875\u9762\u89e3\u9501"))):null)}}]),t}(u.default.Component),m=(0,c.connect)(function(e){return{owner:e.user.user,site:e.site}})(h);t.default=m},"1ckM":function(e,t,a){var n={"./array.js":"/2nW","./array_item.js":"3iD4","./color.js":"C4eb","./date.js":"cJxx","./enum.js":"LHV9","./excel_button.js":"Pj0G","./file.js":"JVJr","./item.js":"Uger","./number.js":"weoq","./object.js":"cJ+W","./rich-text.js":"Woba","./switch.js":"XZ5c","./text.js":"99t5","./textarea.js":"wjEL","./textfield.js":"VOtZ","./uploader.js":"F4x5"};function i(e){var t=l(e);return a(t)}function l(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=l,e.exports=i,i.id="1ckM"},"2H5h":function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=a("jXAE"),d=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={title:null},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"modifyConfirm",value:function(){this.props.onCancel(),this.state.title&&this.state.title!==this.props.page.title&&this.props.onConfirm(this.state.title)}},{key:"render",value:function(){var e=this,t=this.state.title,a=this.props,n=a.guide,i=a.page;return u.default.createElement(c.Modal,{width:568,footer:null,visible:!0,title:__("\u91cd\u547d\u540d\u9875\u9762"),wrapClassName:"editor-modal se-rename-page-modal",onCancel:this.props.onCancel},u.default.createElement(c.Tooltip,{placement:"right",title:__("\u8f93\u5165\u9875\u9762\u540d\u79f0\u5e76\u70b9\u51fb\u300c\u4fee\u6539\u300d\u5373\u53ef"),visible:!0===n.page.renamePage,overlayClassName:"editor-guide-tooltip"},u.default.createElement("div",{className:"se-rename-page-main"},u.default.createElement("p",null,__("\u9875\u9762\u540d\u79f0")),u.default.createElement(c.Input,{autoFocus:!0,placeholder:__("\u8f93\u5165\u9875\u9762\u6807\u9898"),defaultValue:t||i.title,maxLength:20,onChange:function(t){return e.setState({title:t.target.value.trim()})}}),u.default.createElement("div",{className:"editor-modal-btn"},u.default.createElement(c.Button,{className:"se-btn-cancel",size:"small",onClick:this.props.onCancel},__("\u53d6\u6d88")),u.default.createElement(c.Button,{className:"se-btn-confirm",type:"primary",size:"small",onClick:function(){return e.modifyConfirm()}},__("\u4fee\u6539"))))))}}]),t}(u.default.Component),p=d;t.default=p},"2VdL":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n="\n  @import \"https://a.alipayobjects.com/jquery/ui-1.11.4/??jquery-ui.min.css,jquery-ui.structure.min.css\";\n\n  html, body {\n    overflow-x: hidden !important;\n    overflow-y: hidden !important;\n  }\n\n  #yunfengdie-component-tools {\n    position: absolute;\n    visibility: hidden;\n    z-index: 99999;\n    top: 0;\n    left: 0;\n    pointer;\n    pointer-events: none;\n  }\n  #yunfengdie-component-tools-item-top, #yunfengdie-component-tools-item-bottom {\n    cursor: pointer;\n    position: absolute;\n    left: 50%;\n    margin-left: -20px;\n    width: 40px;\n    height: 40px;\n    border-radius: 40px;\n    background-color: #fff;\n    background-image: url(https://gw.alipayobjects.com/zos/rmsportal/hFqqxsTSSoDRDpVDnWqj.png);\n    background-repeat: no-repeat;\n    background-size: 16px 16px;\n    background-position: 50% 50%;\n    overflow: hidden;\n    box-shadow: 0 3px 16px 0 rgba(0,0,0,0.1);\n    pointer-events: auto;\n  }\n  #yunfengdie-component-tools-item-top:hover, #yunfengdie-component-tools-item-bottom:hover {\n    background-image: url(https://gw.alipayobjects.com/zos/rmsportal/txIGxrXXPHywEDzftena.png);\n  }\n  #yunfengdie-component-tools-item-top {\n    top: 0;\n    transform: translateY(-20px);\n  }\n  #yunfengdie-component-tools-item-bottom {\n    bottom: 0;\n    transform: translateY(20px);\n  }\n\n  [data-type=\"object\"] [data-box],\n  [data-box] {\n    z-index: 100001 !important;\n    outline: none;\n    pointer-events: auto;\n  }\n  [data-box] > * {\n    pointer-events: none;\n  }\n  [data-box] > .ui-resizable-handle {\n    pointer-events: auto;\n  }\n\n  [data-box]:before {\n    content: '\\20';\n    display: block;\n    position: absolute;\n    box-sizing: border-box;\n    width: 100%;\n    height: 100%;\n    top: 0px;\n    left: 0px;\n    border: 1px solid #8C8C8C;\n    background-color: rgba(0, 0, 0, .05);\n  }\n  [data-box]::after {\n    content: attr(data-alias);\n    border-radius: 4px 0 0 0;\n    padding: 0px 4px;\n    background-color: rgba(0, 0, 0, 0.6);\n    color: #ddd;\n    position: absolute;\n    font-size: 12px;\n    right: 0;\n    bottom: 0;\n  }\n\n  .ui-resizable-handle {\n    background: transparent;\n    overflow: hidden;\n  }\n  .ui-resizable-n, .ui-resizable-s {\n    height: 4px;\n  }\n  .ui-resizable-e, .ui-resizable-w {\n    width: 4px;\n  }\n\n  .ui-resizable-se,\n  .ui-resizable-ne,\n  .ui-resizable-nw,\n  .ui-resizable-sw {\n    background-color: #fff;\n    border: 1px solid #8C8C8C;\n    width: 4px;\n    height: 4px;\n    visibility: hidden;\n  }\n  .ui-resizable-se {\n    right: -2px;\n    bottom: -2px;\n  }\n  .ui-resizable-sw {\n    bottom: -2px;\n    left: -2px;\n  }\n  .ui-resizable-ne {\n    top: -2px;\n    right: -2px;\n  }\n  .ui-resizable-nw {\n    top: -2px;\n    left: -2px;\n  }\n\n  .current .ui-resizable-se,\n  .current .ui-resizable-ne,\n  .current .ui-resizable-nw,\n  .current .ui-resizable-sw {\n    visibility: visible;\n  }\n\n  #fengdie-components-drop-placeholder {\n    position: relative;\n    display: flex;\n    height: 135px;\n    width: 100%;\n    background: #F9F9F9;\n    justify-content: center;\n    align-items: center;\n    font-size: 16px;\n    color: rgba(0,0,0,.85);\n  }\n  #fengdie-components-drop-placeholder:after {\n      content: '';\n      position: absolute;\n      top: 8px;\n      right: 8px;\n      bottom: 8px;\n      left: 8px;\n      border: 1px dashed rgba(0,0,0,.85);\n      border-radius: 4px;\n    }\n  }\n\n  body {\n    background: red;\n  }\n  #fengdie-components-empty-tips {\n    display: flex;\n    padding: 30px 0;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    font-size: 16px;\n    color: rgba(0,0,0,0.45);\n    line-height: 24px;\n    background: #fff;\n  }\n  #fengdie-components-empty-tips div {\n    padding-top: 25px;\n  }\n  #fengdie-components-empty-tips a {\n    color: #408EF5;\n    text-decoration: none;\n  }\n  #fengdie-components-empty-tips a:hover {\n    color: #6bb0ff;\n  }\n";t.default=n},4:function(e,t){},"6OUm":function(e,t,a){"use strict";var n=a("fbTi"),i=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a("Ico4")),r=i(a("43Yg")),o=i(a("/tCh")),s=i(a("scpF")),u=i(a("O/V9")),c=i(a("8aBX")),d=i(a("cDcd")),p=i(a("uhLB")),f=a("LfU0"),h=i(a("iczh")),m=a("Hws7"),g=a("jXAE"),v=i(a("AFmn")),y=a("leIJ"),E=i(a("EraY"));a("gzsh");var b,C=a("TcI+"),P=n(a("pQFk")),k=a("gzPx"),_=function(e,t,a,n){var i,l=arguments.length,r=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(l<3?i(r):l>3?i(t,a,r):i(t,a))||r);return l>3&&r&&Object.defineProperty(t,a,r),r},S=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t,a,n){return new(a||(a=Promise))(function(i,l){function r(e){try{s(n.next(e))}catch(e){l(e)}}function o(e){try{s(n["throw"](e))}catch(e){l(e)}}function s(e){e.done?i(e.value):new a(function(t){t(e.value)}).then(r,o)}s((n=n.apply(e,t||[])).next())})},D=g.Button.Group,I=g.Menu.Item,x=12e4,N=function(e){function t(e){var a;return(0,r.default)(this,t),a=(0,s.default)(this,(0,u.default)(t).call(this,e)),a.dispatch=window.g_app._store.dispatch,a.state={approveComment:"",savingSite:!1,releaseLoading:!1,releasingSite:!1,analyzeErrorMsg:null,counter:0,currentProgress:0},a.handleAutoInitPlugin=function(){var e=a.props.site,t=e.siteData,n=t.pluginList,i=t.papilioPackage.schemas,l=void 0===i?{}:i;return n.reduce(function(e,t){return e.then(function(){var e=t.pluginService.needInit&&!t.originId;if(!e)return Promise.resolve();var n=l[t.location.schemaName],i=(0,y.getPluginData)(n,t.pluginService.pluginServiceId),r=function(e,t){return a.pluginModel.autoInit({pluginId:e,schemaData:t})},o=function(e){return a.dispatch({type:"site/postSaveSiteData",payload:{siteData:e}})};return r(t.pluginId,i).then(o)})},Promise.resolve())},a.handleRelease=function(){a.modifyReleaseTypeAndInitial(m.ReleaseTypeEnum.NORMAL)},a.handleReleaseGrey=function(){a.modifyReleaseTypeAndInitial(m.ReleaseTypeEnum.GREY)},a.shouldApprove=!0,e.site.siteData.isOpenApiRequest||(a.shouldApprove=(0,C.isShouldApprove)(e.site.siteData,e.userData.user.name)),a}return(0,c.default)(t,e),(0,o.default)(t,[{key:"componentWillReceiveProps",value:function(e){!0===e.site.locked&&this.timer&&clearInterval(this.timer)}},{key:"componentDidMount",value:function(){this.setupAutoSaveTimer()}},{key:"componentWillUnmount",value:function(){this.clearAutoSaveTimer()}},{key:"setupAutoSaveTimer",value:function(){var e=this;this.timer=setTimeout(function(){e.handleSaveSite(!0).catch(function(e){P.normal.error("\u81ea\u52a8\u4fdd\u5b58\u5931\u8d25",e)})},x)}},{key:"clearAutoSaveTimer",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null}},{key:"getAnalyzeResult",value:function(e){var t=this,a=this.state.currentProgress;(0,v.default)().getSiteContentAnalyzeResult(e).then(function(n){n.passed?(t.dispatch({type:"site/updateProgressData",payload:{type:"releasing",progress:60}}),t.publishSite()):n.errorMsg?t.setState({analyzeErrorMsg:n.errorMsg}):setTimeout(function(){t.dispatch({type:"site/updateProgressData",payload:{type:"releasing",progress:a+2}}),t.setState({currentProgress:a+2}),t.getAnalyzeResult(e)},3e3)}).catch(console.error)}},{key:"publishSite",value:function(){var e=this;this.dispatch({type:"site/publishSite",payload:{approveComment:this.state.approveComment}}).then(function(t){e.setState({approveComment:""}),e.dispatch({type:"site/updateProgressData",payload:{type:"releasing",progress:100}}),setTimeout(function(){e.setState({releasingSite:!1}),t.status===m.SiteStatusEnum.APPROVE_WAITING?e.dispatch({type:"site/updateProgressData",payload:{type:"waiting"}}):e.dispatch({type:"site/updateProgressData",payload:{type:"released"}})},2e3)}).catch(function(t){e.setState({releasingSite:!1}),e.dispatch({type:"site/updateProgressData",payload:{type:"failed"}})})}},{key:"handleSaveSite",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return w(this,void 0,void 0,l.default.mark(function t(){var a=this;return l.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.state.savingSite){t.next=2;break}return t.abrupt("return",Promise.reject("\u7ad9\u70b9\u4fdd\u5b58\u4e2d"));case 2:return this.clearAutoSaveTimer(),t.abrupt("return",new Promise(function(t,n){a.setState({savingSite:!0},function(){return a.dispatch({type:"site/saveSiteData",payload:{action:{autoSave:e}}}).then(function(){a.setState({savingSite:!1},function(){a.setupAutoSaveTimer(),t()})}).catch(function(e){a.setState({savingSite:!1},function(){a.setupAutoSaveTimer(),n(e)})})})}));case 4:case"end":return t.stop()}},t,this)}))}},{key:"handleContentAnalyzeSite",value:function(){var e=this,t=this.props.site;this.dispatch({type:"guide/completeGuide"}),this.setState({currentProgress:0,releasingSite:!0}),this.dispatch({type:"site/updateProgressData",payload:{type:"releasing",progress:0}}),this.dispatch({type:"site/saveSiteData",payload:{action:{contentAnalyze:!0}}}).then(function(a){e.getAnalyzeResult(t.siteData.id)}).catch(function(t){e.setState({releasingSite:!1}),e.dispatch({type:"site/updateProgressData",payload:{type:"failed"}})})}},{key:"modifyReleaseTypeAndInitial",value:function(e,t){var a=this;this.state.releaseLoading||(this.dispatch({type:"site/modifyReleaseType",payload:{releaseType:e}}),this.setState({releaseLoading:!0},function(){a.dispatch({type:"site/changePanelVisible",payload:{panel:"schemaEditor",visible:!1}}),a.handleAutoInitPlugin().then(function(){a.setState({approveComment:t,releaseLoading:!1},function(){a.handleContentAnalyzeSite()})}).catch(function(e){P.normal.error("\u521d\u59cb\u5316\u63d2\u4ef6\u5931\u8d25",e),g.message.error("\u521d\u59cb\u5316\u63d2\u4ef6\u5931\u8d25")})}))}},{key:"handlePreviewSite",value:function(){var e=this,t=this.props.page;this.dispatch({type:"guide/completeGuide"}),t.hasModify?(this.dispatch({type:"site/changePreviewPanelVisibleStatus",payload:{status:"loading"}}),this.handleSaveSite(!0).then(function(){e.dispatch({type:"site/changePreviewPanelVisibleStatus",payload:{status:"visible"}})}).catch(function(e){P.normal.error("\u70b9\u51fb\u9884\u89c8\u81ea\u52a8\u4fdd\u5b58\u5931\u8d25",e)})):this.dispatch({type:"site/changePreviewPanelVisibleStatus",payload:{status:"visible"}})}},{key:"renderReleaseBtn",value:function(){var e=this,t=this.state,a=t.releasingSite,n=t.releaseLoading,i=this.props,l=i.site,r=i.guide,o=(0,h.default)("seh-action-release",{"seh-action-release-guide":!0===r.publish.release||!0===r.publish.approve}),s=l.siteData.notAllowRelease,u=l.siteData.onlineStatus===m.SiteOnlineStatusEnum.UNONLINE,c=(0,y.isPluginSite)(l.siteData),f=(0,p.default)(l,"siteData.space.type")===m.SpaceTypeEnum.INTERNAL&&(0,p.default)(l,"siteData.space.meta.greyEnabled",!1),v=d.default.createElement(g.Button,{disabled:!0,type:"primary",size:"default",className:"seh-action-release-disable"},d.default.createElement(g.Icon,{type:"fabu"}),__("\u53d1\u5e03"));if(a)return d.default.createElement(g.Button,{type:"primary",size:"default",className:"seh-action-release"},100===l.progressData.progress?d.default.createElement(g.Icon,{type:"chenggong"}):d.default.createElement(g.Icon,{antd:!0,type:"loading"}));if(s||(0,C.isGrey)(l.releaseType))return d.default.createElement(g.Tooltip,{arrowPointAtCenter:!0,placement:"bottomRight",title:(0,C.isGrey)(l.releaseType)?__("\u7070\u5ea6\u4e2d\u7684\u7ad9\u70b9\u65e0\u6cd5\u8fdb\u884c\u53d1\u5e03"):__("\u5f00\u53d1\u4e2d\u7684\u6d4b\u8bd5\u7ad9\u70b9\u65e0\u6cd5\u8fdb\u884c\u53d1\u5e03")},v);if(!l.siteData.trialCanPublish)return d.default.createElement(g.Popover,{placement:"bottomRight",title:!1,content:d.default.createElement(g.Row,{type:"flex",justify:"space-between",align:"middle",className:"limit-warning"},d.default.createElement(g.Col,null,d.default.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/gyaKUOeYQlBPlbEzwQKl.png",style:{width:"97px",height:"83px"}})),d.default.createElement(g.Col,{className:"limit-warning-content"},d.default.createElement("p",null,__("\u514d\u8d39\u7248\u6700\u591a\u53ea\u5141\u8bb8\u53d1\u5e03 5 \u4e2a\u7ad9\u70b9\u3002")),d.default.createElement(g.Button,{type:"primary",size:"small",href:"/i/enterprise/index",target:"_blank"},__("\u7acb\u5373\u7533\u8bf7\u4f01\u4e1a\u7248"))))},v);var b=d.default.createElement(g.Menu,{className:"se-header-menu-wrap"},d.default.createElement(I,{key:"1",className:"se-header-menu-btn",onClick:this.handleReleaseGrey,disabled:c||u,title:c?__("\u4f7f\u7528\u63d2\u4ef6\u7684\u7ad9\u70b9\u6682\u4e0d\u652f\u6301\u7070\u5ea6\u53d1\u5e03"):u?__("\u9996\u6b21\u53d1\u5e03\u4e0d\u5efa\u8bae\u4f7f\u7528\u7070\u5ea6\u3002"):""},this.shouldApprove?__("\u7533\u8bf7\u7070\u5ea6\u53d1\u5e03"):__("\u7070\u5ea6\u53d1\u5e03"))),P=d.default.createElement(D,{className:"seh-action-wrap"},d.default.createElement(g.Button,{type:"primary",size:"default",disabled:s,className:o,icon:"fabu",loading:n,onClick:this.handleRelease},this.shouldApprove?__("\u7533\u8bf7\u53d1\u5e03"):__("\u53d1\u5e03")),f&&d.default.createElement(g.Dropdown,{overlay:b,getPopupContainer:function(e){return e.parentNode}},d.default.createElement(g.Button,{type:"primary",className:"seh-action-grey-down"},d.default.createElement(g.Icon,{antd:!0,type:"down"}))));if(l.siteData.isOpenApiRequest){var k=function(t){return e.modifyReleaseTypeAndInitial(m.ReleaseTypeEnum.NORMAL,t)};P=d.default.createElement(E.default,{buttonClassName:o,btnText:__("\u7533\u8bf7\u53d1\u5e03"),loading:n,onSubmit:k})}return d.default.createElement(g.Tooltip,{placement:"bottom",title:this.shouldApprove?__("\u70b9\u51fb\u300c\u7533\u8bf7\u53d1\u5e03\u300d"):__("\u70b9\u51fb\u300c\u53d1\u5e03\u300d"),visible:!0===r.publish.release||!0===r.publish.approve,overlayClassName:"editor-guide-tooltip"},P)}},{key:"renderSaveBtn",value:function(){var e=this,t=this.state,a=t.releasingSite,n=t.savingSite,i=function(){e.handleSaveSite().then(function(){g.message.success(__("\u4fdd\u5b58\u6210\u529f"))}).catch(function(e){P.normal.error("\u4fdd\u5b58\u5931\u8d25",e)})},l=Object.assign({className:"seh-action-save"},a?{}:{onClick:i}),r=n?d.default.createElement(g.Icon,{antd:!0,type:"loading"}):d.default.createElement(g.Icon,{type:"baocun"});return d.default.createElement("span",Object.assign({},l),r,__("\u4fdd\u5b58"))}},{key:"render",value:function(){var e=this,t=this.props,a=t.site,n=t.guide,i=a.siteData.savedTime,l=(0,h.default)("seh-action-preview",{"seh-action-preview-guide":!0===n.publish.preview});return d.default.createElement("div",{className:"seh-action"},i&&d.default.createElement("span",{className:"seh-action-save-time"},__("\u4fdd\u5b58\u4e8e"),i),d.default.createElement(g.Tooltip,{placement:"bottom",title:__("\u70b9\u51fb\u300c\u9884\u89c8\u300d"),visible:!0===n.publish.preview,overlayClassName:"editor-guide-tooltip"},d.default.createElement("span",{className:l,onClick:function(){return e.handlePreviewSite()}},d.default.createElement(g.Icon,{type:"yulan"}),__("\u9884\u89c8"))),this.renderSaveBtn(),this.renderReleaseBtn())}}]),t}(d.default.Component);_([(0,f.inject)(),S("design:type","function"===typeof(b="undefined"!==typeof k.PluginModel&&k.PluginModel)?b:Object)],N.prototype,"pluginModel",void 0);var M=(0,f.connect)(function(e){return{guide:e.guide,userData:e.user,site:e.site,page:e.page}})(N);t.default=M},"6W0e":function(e,t,a){},"7jmc":function(e,t,a){},"7z73":function(e,t,a){},"85Yu":function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("cDcd")),l=a("jXAE"),r=(n(a("EH+i")),function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(a[n[i]]=e[n[i]])}return a}),o=function(e){var t=e.children,a=e.length,n=e.tail,o=e.tailClassName,s=e.showTooltip,u=r(e,["children","length","tail","tailClassName","showTooltip"]);if(u.className=u.className?"text-block ".concat(u.className):"text-block",t.length<=a||a<0)return i.default.createElement("p",Object.assign({},u),t);var c=a-n.length,d=c>0?t.slice(0,c):"",p={cursor:"auto",paddingLeft:"2px"},f={style:p,className:o};if(!s)return i.default.createElement("p",Object.assign({title:t},u),d,i.default.createElement("span",Object.assign({},f),n));var h=!0===s?"click":s;p.cursor="click"===h?"pointer":"help";var m={trigger:h,content:t,overlayClassName:"text-block-popover"};return i.default.createElement("p",Object.assign({},u),d,i.default.createElement(l.Popover,Object.assign({},m),i.default.createElement("span",Object.assign({},f),n)))};o.defaultProps={length:60,tail:"...",tailClassName:"more",showTooltip:!1};var s=o;t.default=s},"87NF":function(e,t,a){},"8Z6p":function(e,t,a){},"8eVA":function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,l,r=n(a("uhLB")),o=n(a("oYNh")),s=!1;function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=(0,r.default)(window.context,"config.sandboxDomain",location.protocol+"//"+location.host);e.eventType=t,l.postMessage(e,a)}var c={cancelSelect:function(){u({},o.default.CANCEL_SELECT)},reload:function(e){s?(i=null,u({data:e},o.default.RELOAD)):i=e},initWin:function(e){l=e},initData:function(){s=!0,i&&this.reload(i)},hideDropComponentPlaceHolder:function(){u({},o.default.HIDE_DROP_COMPONENT_HOLDER)},showDropComponentPlaceHolder:function(e){u({data:e},o.default.SHOW_DROP_COMPONENT_HOLDER)}};t.default=c},EOHe:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=a("L5c0"),c=n(a("cDcd")),d=n(a("iczh")),p=a("leIJ"),f=a("jXAE"),h=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={showDeleteComponentModal:!1},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleMoveUp",value:function(e){this.props.dispatch({type:"page/sortComponent",payload:{index:e-1}}),this.props.dispatch({type:"guide/completeGuide"})}},{key:"handleMoveDown",value:function(e){this.props.dispatch({type:"page/sortComponent",payload:{index:e+1}}),this.props.dispatch({type:"guide/completeGuide"})}},{key:"handleCopyComponent",value:function(){this.props.dispatch({type:"page/copyComponent",payload:{pkg:this.props.site.siteData.papilioPackage}})}},{key:"handleConformDeleteComponent",value:function(){this.setState({showDeleteComponentModal:!0})}},{key:"handleDeleteCurrentComponent",value:function(){var e=this.props.page;this.setState({showDeleteComponentModal:!1}),this.props.dispatch({type:"page/updateHoverComponent",payload:{height:0}}),e.activeSchema.componentId===e.hoverComponent.componentId&&this.props.dispatch({type:"site/changePanelVisible",payload:{schemaEditor:!1}}),this.props.dispatch({type:"page/deleteComponent"})}},{key:"renderMoveStatus",value:function(){var e=this,t=this.props.page,a=t.hoverComponent.componentId,n=t.pageData[t.activePageIndex].componentList,i=n.findIndex(function(e){return e.uid===a}),l=c.default.createElement(f.Icon,{type:"xiangshang",onClick:function(){return e.handleMoveUp(i)}}),r=c.default.createElement(f.Icon,{type:"xiangxia",onClick:function(){return e.handleMoveDown(i)}});return-1!==i?{moveUp:i>0?l:null,moveDown:i===n.length-1?null:r}:{moveUp:null,moveDown:null}}},{key:"renderDeleteComponentModal",value:function(){var e=this,t=this.state.showDeleteComponentModal;return t?c.default.createElement(f.Modal,{width:568,footer:null,visible:!0,okText:__("\u5220\u9664"),title:__("\u5220\u9664\u7ec4\u4ef6"),wrapClassName:"editor-modal se-del-component-modal",onCancel:function(){return e.setState({showDeleteComponentModal:!1})}},c.default.createElement("div",{className:"se-del-component-main"},c.default.createElement("img",{width:"125",height:"116",src:"https://gw.alipayobjects.com/zos/rmsportal/caurGJTHhuwTlKcCgoIy.png"}),__("\u662f\u5426\u786e\u8ba4\u5220\u9664\u8be5\u7ec4\u4ef6\uff1f"),c.default.createElement("div",{className:"editor-modal-btn"},c.default.createElement(f.Button,{className:"se-btn-cancel",size:"small",onClick:function(){return e.setState({showDeleteComponentModal:!1})}},__("\u53d6\u6d88")),c.default.createElement(f.Button,{className:"se-btn-confirm",type:"danger",size:"small",onClick:function(){return e.handleDeleteCurrentComponent()}},__("\u5220\u9664"))))):null}},{key:"render",value:function(){var e=this,t=this.props,a=t.site,n=t.page,i=t.guide,l=t.view,r=n.hoverComponent,o=r.top,s=r.height,u=n.pageData[n.activePageIndex];if(!u.componentList||!u.componentList.length||!o&&!s)return null;var h=u.componentList.findIndex(function(e){return e.uid===n.hoverComponent.componentId}),m=(0,d.default)("se-view-tools",{"se-view-tools-guide":!0===i.component.sortComponent&&0===h}),g=this.renderMoveStatus(),v=(0,d.default)({"sev-tools-move":!0,"sev-tools-move-single":!g.moveUp||!g.moveDown}),y={top:"".concat(o+8,"px")};if(o+220>n.iframeHeight&&(y={top:"auto",bottom:"".concat(n.iframeHeight-o-s+8,"px")}),"loading"===l.viewPageStatus)return null;var E=a.siteData.papilioPackage,b=u.componentList[h],C=b&&c.default.createElement(c.default.Fragment,null,!(0,p.isPluginComponent)(b,E)&&c.default.createElement("div",{className:"sev-tools-copy"},c.default.createElement(f.Icon,{type:"fuzhi",onClick:function(){return e.handleCopyComponent()}})),c.default.createElement("div",{className:"sev-tools-delete"},c.default.createElement(f.Icon,{type:"shanchu",onClick:function(){return e.handleConformDeleteComponent()}})),this.renderDeleteComponentModal());return c.default.createElement("div",{className:m,style:y},c.default.createElement(f.Tooltip,{placement:"right",title:__("\u70b9\u51fb\u5bf9\u7ec4\u4ef6\u6392\u5e8f"),visible:!0===i.component.sortComponent&&0===h,overlayClassName:"editor-guide-tooltip"},c.default.createElement("div",{className:v},g.moveUp,g.moveDown)),C)}}]),t}(c.default.Component),m=(0,u.connect)(function(e){return{guide:e.guide,site:e.site,view:e.view,page:e.page}})(h);t.default=m},Edua:function(e,t,a){"use strict";var n=a("fbTi"),i=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a("cO38")),r=i(a("Ico4")),o=i(a("43Yg")),s=i(a("/tCh")),u=i(a("scpF")),c=i(a("O/V9")),d=i(a("8aBX")),p=i(a("cDcd")),f=a("L5c0"),h=i(a("IJ3o")),m=i(a("iczh")),g=a("jXAE"),v=n(a("BALR")),y=i(a("MetU")),E=a("4P36"),b=i(a("+A24")),C=i(a("xvx6")),P=i(a("Q4fm"));a("oB4D");var k=a("Hws7"),_=a("bMPC"),S=a("gIoJ"),w=function(e,t,a,n){return new(a||(a=Promise))(function(i,l){function r(e){try{s(n.next(e))}catch(e){l(e)}}function o(e){try{s(n["throw"](e))}catch(e){l(e)}}function s(e){e.done?i(e.value):new a(function(t){t(e.value)}).then(r,o)}s((n=n.apply(e,t||[])).next())})},D="\u8d44\u6e90\u5e93\u529f\u80fd\u5df2\u4e0b\u7ebf\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u8fdb\u884c\u5904\u7406",I={image:a("nPAi").default,string:a("Qjrp").default,text:a("Maoa").default,url:a("a5Kl").default},x=function(e){function t(e){var a;return(0,o.default)(this,t),a=(0,u.default)(this,(0,c.default)(t).call(this,e)),a.state={plugins:[]},a.handleClosePanel=function(){a.props.dispatch({type:"site/changePanelVisible",payload:{}})},a.loadSpacePlugins(),a}return(0,d.default)(t,e),(0,s.default)(t,[{key:"loadSpacePlugins",value:function(){return w(this,void 0,void 0,r.default.mark(function e(){var t;return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_.pluginServiceService.getSpacePluginServices();case 2:t=e.sent,this.setState({plugins:t});case 4:case"end":return e.stop()}},e,this)}))}},{key:"genUID",value:function(){return(Date.now()+Math.random().toString().substr(2,3)).replace(/^(\d{4})(\d{4})(\d{4})(\d{4})/g,"$1-$2-$3-$4")}},{key:"resetLastArrayItem",value:function(e,t){var a=this,n=(0,h.default)(t.pop());return Object.keys(e).forEach(function(t){"box"===e[t].type&&(n[t].uid=a.genUID(),n[t].left+=10,n[t].top+=10)}),t.push(n),t}},{key:"getTypePlugin",value:function(){var e={};return this.state.plugins.forEach(function(t){var a=(0,S.get)(function(){return t.processor})||{},n=Object.keys(a);n.length>0&&n.forEach(function(a){e[a]||(e[a]=[]),e[a].push(t)})}),e}},{key:"render",value:function(){var e=this,t=this.props,a=t.guide,n=t.site,i=t.page,r=t.activeSchema,o=(0,m.default)("se-editor",{"se-editor-guide":!0===a.component.modifyData});if(!r.schemaName||!r.schemaMockData||!n.panelVisible.schemaEditor)return null;var s=r.schemaMockData.json,u=(0,E.getActiveSchemaData)(r,i)||r.schemaMockData.data,c="".concat(i.activePageIndex,"@@").concat(r.componentId),d=i.pageData.map(function(e){var t=n.siteData,a=t.rootPath,i=t.name;return{text:e.title,isHomePage:e.isHomePage,url:"".concat(a).concat(i,"/").concat(e.name),name:e.name}}),f=!0;n.siteData.space.type===k.SpaceTypeEnum.INTERNAL&&(f=!1);var h={url:b.default,richtext:C.default,plugin:P.default,resource:function(){return p.default.createElement("h4",null,D)}};Object.entries(this.getTypePlugin()).forEach(function(e){var t=(0,l.default)(e,2),a=t[0],n=t[1],i=I[a];i&&(h[a]=i(a,n))});var _={key:c,schema:s,value:u,config:{size:"default",excelImport:!0,uploadApi:"".concat(window.context.config.apiUrl,"/api/upload"),uploadHeaders:{"x-csrf-token":v.get("ctoken")},uploadImgSize:3072e3,imageUploadOnly:f,localUrlData:d,fieldMap:h},onChange:function(t,a){var n={refresh:!0,donnotRecord:!!(a&&a.options&&a.options.donnotRecord)};e.props.dispatch({type:"page/updatePageSchema",payload:{data:t},meta:n}),e.props.dispatch({type:"guide/completeGuide"})},getNavBar:function(t){if(1===t.props.children.length)return p.default.createElement("div",{className:"fd-schema-navbar"},t,p.default.createElement(g.Icon,{onClick:e.handleClosePanel,type:"guanbi"}));var a=t.props.children[t.props.children.length-1],n=t.props.children[0];return p.default.createElement("div",{className:"fd-schema-navbar-multi"},p.default.createElement("div",{className:"fd-schema-navbar-multi-main"},p.default.cloneElement(n,{children:p.default.createElement("span",{className:"fd-iconfont fd-icon-fanhui"},__("\u8fd4\u56de"),"\xa0",n.props.children)}),p.default.createElement(g.Icon,{onClick:e.handleClosePanel,type:"guanbi"})),p.default.createElement("h4",null,a))}};return p.default.createElement(g.Tooltip,{placement:"right",title:__("\u4fee\u6539\u7ec4\u4ef6\u5185\u5bb9"),visible:!0===a.component.modifyData,overlayClassName:"editor-guide-tooltip"},p.default.createElement("div",{className:o},p.default.createElement(y.default,Object.assign({},_))))}}]),t}(p.default.PureComponent),N=(0,f.connect)(function(e){var t=e.site,a=e.page,n=t.siteData,i=a.activeSchema,l=a.pageData[a.activePageIndex],r=(0,E.getSchemaMockData)(i.schemaName,l.packageId,n.papilioPackage,t.commonPageDetail,t.commonComponentDetail);return{guide:e.guide,site:t,page:a,activeSchema:Object.assign({},i,{schemaMockData:r})}})(x);t.default=N},EkgX:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=a("L5c0"),c=n(a("cDcd")),d=n(a("iczh")),p=a("jXAE"),f=a("metX"),h=n(a("NM76")),m=n(a("2H5h")),g=n(a("dK0G"));a("7z73");var v=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={renamePageIndex:null,deletePageIndex:null,settingPopoverVisible:e.page.pageData.map(function(){return!1})},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleClosePanel",value:function(){this.props.dispatch({type:"site/changePanelVisible",payload:{panel:"pageList"}})}},{key:"handleAddPage",value:function(){this.props.dispatch({type:"site/loadCommonPageList"})}},{key:"handleChangeActivePage",value:function(e){var t=this.props.page,a=t.pageData,n=t.activePageIndex;if(e!==n){var i="";if(a[e]){var l=a[e];i=l.id,l.packageId&&this.props.dispatch({type:"site/loadCommonPageDetail",payload:l})}this.props.dispatch({type:"page/changeActivePage",payload:{pageId:i}})}}},{key:"handleModifyPageTitle",value:function(e,t){this.props.dispatch({type:"page/updatePageTitle",payload:{pageIndex:e,title:t}}),this.setState({renamePageIndex:null}),this.props.dispatch({type:"guide/completeGuide"})}},{key:"handleModifyPath",value:function(e){this.props.dispatch({type:"site/updateModifyPagePathIndex",payload:{pageIndex:e}})}},{key:"handleCopyPage",value:function(e){this.props.dispatch({type:"guide/completeGuide"}),this.props.dispatch({type:"page/copyPage",payload:{pageIndex:e}})}},{key:"handleSetHomePage",value:function(e){this.props.dispatch({type:"page/setHomePage",payload:{pageIndex:e}})}},{key:"handleDeletePage",value:function(e){this.setState({deletePageIndex:null}),this.props.dispatch({type:"page/deletePage",payload:{pageIndex:e}}),this.props.dispatch({type:"guide/completeGuide"})}},{key:"renderRenamePageModal",value:function(){var e=this,t=this.props.guide,a=this.props.page.pageData,n=this.state.renamePageIndex;if(null===n)return null;var i=a[n];return i?c.default.createElement(m.default,{page:i,guide:t,onCancel:function(){return e.setState({renamePageIndex:null})},onConfirm:function(t){return e.handleModifyPageTitle(n,t)}}):null}},{key:"renderDeleteConfigModal",value:function(){var e=this,t=this.props.guide,a=this.props.page.pageData,n=this.state.deletePageIndex;if(null===n)return null;var i=a[n];return i?c.default.createElement(g.default,{guide:t,onCancel:function(){return e.setState({deletePageIndex:null})},onConfirm:function(t){return e.handleDeletePage(n)}}):null}},{key:"render",value:function(){var e=this,t=this.props,a=t.page,n=t.guide,i=t.site,l=this.state,r=l.renamePageIndex,o=l.deletePageIndex,s=n.page,u=!0===s.addPage,f=(0,d.default)("se-page-container",{"se-page-container-guide":u}),m=["copyPage","renamePage","modifyPath","deletePage"].find(function(e){return!0===s[e]})&&null===r&&null===o&&null===i.currentModifyPathPageIndex;return c.default.createElement("div",{className:f},c.default.createElement("h3",null,__("\u9875\u9762\u5217\u8868"),c.default.createElement(p.Icon,{onClick:function(){return e.handleClosePanel()},type:"guanbi"})),c.default.createElement("div",{className:"sep-list"},a.pageData.map(function(t,l){var r=(0,d.default)({"sep-item":!0,"sep-item-active":l===a.activePageIndex,"sep-item-guide-page-attr":l===a.activePageIndex&&!!m});return c.default.createElement(h.default,{onCopyPage:function(){return e.handleCopyPage(l)},onModifyPath:function(){return e.handleModifyPath(l)},onClick:function(){return e.handleChangeActivePage(l)},onSetHomePage:function(){return e.handleSetHomePage(l)},onRename:function(){return e.setState({renamePageIndex:l})},onDeletePage:function(){return e.setState({deletePageIndex:l})},guide:n,showUserGuideTips:l===a.activePageIndex&&!!m,page:t,key:l,index:l,className:r,dispatch:e.props.dispatch,pkg:i.siteData.papilioPackage,pluginList:i.siteData.pluginList})})),c.default.createElement(p.Tooltip,{placement:"right",title:__("\u70b9\u51fb\u300c\u6dfb\u52a0\u9875\u9762\u300d"),visible:u,overlayClassName:"editor-guide-tooltip"},c.default.createElement("div",{className:"sep-add"},c.default.createElement("span",{onClick:function(){return e.handleAddPage()}},c.default.createElement(p.Icon,{type:"xinjian"}),__("\u6dfb\u52a0\u9875\u9762")))),this.renderRenamePageModal(),this.renderDeleteConfigModal())}}]),t}(c.default.Component),y=(0,f.SortableContainer)(function(e){return c.default.createElement(v,Object.assign({},e))}),E=function(e){function t(e){return(0,i.default)(this,t),(0,r.default)(this,(0,o.default)(t).call(this,e))}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleSortPage",value:function(e){var t=e.oldIndex,a=e.newIndex;this.props.dispatch({type:"page/sortPageList",payload:{oldIndex:t,newIndex:a}})}},{key:"render",value:function(){var e=this,t=this.props.site;return t.panelVisible.pageList?c.default.createElement(y,Object.assign({},this.props,{axis:"y",lockAxis:"y",useDragHandle:!0,helperClass:"site-page-item-dragging",onSortEnd:function(t){return e.handleSortPage(t)}})):null}}]),t}(c.default.Component),b=(0,u.connect)(function(e){return{guide:e.guide,site:e.site,page:e.page}})(E);t.default=b},EraY:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=a("jXAE"),d=c.Input.TextArea,p=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={comment:"",popoverVisible:!1},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleChangeComment",value:function(e){this.setState({comment:e.target.value.trim()})}},{key:"handleSubmitCommit",value:function(){this.props.onSubmit&&this.props.onSubmit(this.state.comment)}},{key:"renderComment",value:function(){var e=this;return u.default.createElement("div",null,u.default.createElement("p",null,__("\u5907\u6ce8")),u.default.createElement(d,{onChange:function(t){return e.handleChangeComment(t)},autosize:!1,rows:4}),u.default.createElement("div",{className:"se-approve-comment-popover-btn"},u.default.createElement(c.Button,{size:"small",onClick:function(){return e.setState({popoverVisible:!1})}},__("\u53d6\u6d88")),u.default.createElement(c.Button,{size:"small",type:"primary",onClick:function(){return e.handleSubmitCommit()}},__("\u786e\u5b9a"))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.btnText,n=t.buttonClassName,i=t.loading;return u.default.createElement(c.Popover,{placement:"bottomRight",arrowPointAtCenter:!0,overlayClassName:"se-approve-comment-popover",title:!1,trigger:"click",visible:this.state.popoverVisible,onVisibleChange:function(t){return e.setState({popoverVisible:t})},content:this.renderComment()},u.default.createElement(c.Button,{type:"primary",size:"default",icon:"fabu",className:n,loading:i,onClick:function(){return e.setState({popoverVisible:!0})}},a))}}]),t}(u.default.Component),f=p;t.default=f},FQ53:function(e,t,a){},FhyR:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=a("L5c0"),c=n(a("cDcd")),d=n(a("iczh")),p=a("leIJ"),f=a("jXAE"),h=f.Tabs.TabPane;a("ZNJB");var m=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.timer=null,a.state={showGuideTooltip:!1},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.timer=setTimeout(function(){e.setState({showGuideTooltip:!0})},300)}},{key:"componentWillMount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"handleClosePanel",value:function(){this.props.dispatch({type:"site/changePanelVisible",payload:{panel:"newPage",visible:!1}})}},{key:"handleAddPage",value:function(e){this.props.dispatch({type:"page/addPage",payload:{pageName:e}})}},{key:"handleAddCommonPage",value:function(e){this.props.dispatch({type:"page/addCommonPage",payload:e})}},{key:"renderPageList",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",n="https://gw.alipayobjects.com/zos/rmsportal/EpcOoNbDXZQQSQQEiTkp.png";return c.default.createElement("div",{className:"se-resource-item"},c.default.createElement("div",{className:"se-resource-scroll"},e.map(function(e,i){return c.default.createElement("div",{key:i,className:"ser-page-item",onClick:function(){return"common"===a?t.handleAddCommonPage(e):t.handleAddPage(e.name)}},c.default.createElement("span",{className:"ser-page-item-cover"},c.default.createElement("img",{src:e.snapshot?"".concat(e.snapshot,"?x-oss-process=image/resize,w_560/crop,h_560"):n,width:"280"})),e.name?c.default.createElement("span",{className:"ser-page-item-title"},e.name):null)})))}},{key:"render",value:function(){var e=this,t=this.props,a=t.site,n=t.guide;if(!a.panelVisible.newPage)return null;var i=!0===n.page.addPage&&this.state.showGuideTooltip,l=a.siteData,r=l.papilioPackage,o=l.pluginList,s=r.pages.filter(function(e){return(0,p.isPageAvailable)(e,r,o)}),u=s.length>0,m=(0,d.default)("se-resource","ser-page",{"ser-page-guide":i});return c.default.createElement(f.Tooltip,{placement:"right",title:__("\u9009\u62e9\u5e76\u70b9\u51fb\u4e00\u4e2a\u4f60\u5fc3\u4eea\u7684\u9875\u9762"),visible:i,overlayClassName:"editor-guide-tooltip"},c.default.createElement("div",{className:m},c.default.createElement("h3",null,__("\u6dfb\u52a0\u9875\u9762"),c.default.createElement(f.Icon,{onClick:function(){return e.handleClosePanel()},type:"guanbi"})),c.default.createElement("div",{className:"se-resource-list"},c.default.createElement(f.Tabs,{className:"se-resource-tab",animated:!1,tabPosition:"left",defaultActiveKey:u?"pkg":"common"},u&&c.default.createElement(h,{tab:c.default.createElement("span",null,__("\u6a21\u677f\u9875\u9762","PageSelectorInEditor")),key:"pkg"},this.renderPageList(s)),c.default.createElement(h,{tab:c.default.createElement("span",null,__("\u901a\u7528\u9875\u9762","PageSelectorInEditor")),key:"common"},this.renderPageList(a.commonPageList,"common"))))))}}]),t}(c.default.Component),g=(0,u.connect)(function(e){return{guide:e.guide,site:e.site}})(m);t.default=g},"L+T/":function(e,t,a){},Maoa:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=n(a("85Yu")),d=a("jXAE"),p=a("oSo5"),f=d.Form.Item,h=(0,p.createComponent)(function(e){function t(){var e;return(0,i.default)(this,t),e=(0,r.default)(this,(0,o.default)(t).apply(this,arguments)),e.onChange=function(t){var a=e.props.field,n=t.target.value;e.props.onChange({value:n,fields:[a]})},e}return(0,s.default)(t,e),(0,l.default)(t,[{key:"validate",value:function(e){return"string"===typeof e?void 0:{success:!1,errMsg:__("\u9700\u8981string\u7c7b\u578b")}}},{key:"render",value:function(){var e=this.props,t=e.field,a=e.data,n=e.schema,i=e.config,l=n.meta,r=l?l.maxLength:null,o=i.validate,s=o(a,n.meta,n.type),p=l&&l.description?u.default.createElement(c.default,{showTooltip:!0},n.meta.description):null;return u.default.createElement("div",{className:"ui-form-item field-string",key:t},u.default.createElement("div",{className:"ui-label",style:{display:"block"}},u.default.createElement("span",{className:"ui-label-title",title:n.description},n.description),p,u.default.createElement("span",{style:{float:"right"}},this.renderPluginSelect({label:u.default.createElement(u.default.Fragment,null,u.default.createElement(d.Icon,{type:"bianji"}),u.default.createElement("span",{style:{marginLeft:8}},__("\u76f4\u63a5\u8f93\u5165"))),onClick:function(){}}))),u.default.createElement("div",{className:"ui-content"},u.default.createElement(f,{hasFeedback:!0,help:s,validateStatus:""===s?"":"error"},u.default.createElement(d.Input.TextArea,{autosize:{minRows:3,maxRows:6},onChange:this.onChange,value:a,maxLength:r,disabled:!!this.currentPlugin}))))}}]),t}(p.BasePluginComponent));t.default=h},NM76:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("uhLB")),c=n(a("cDcd")),d=n(a("iczh")),p=a("jXAE"),f=a("metX"),h=a("leIJ"),m=(0,f.SortableHandle)(function(){return c.default.createElement("div",{className:"sep-item-drag"})}),g=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={popoverVisible:!1,renameConfirmPageIndex:null,newPageTitle:null,deleteConfirmPageIndex:null,pageAttrGuideVisible:!1},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleShowPopover",value:function(){this.setState({popoverVisible:!0})}},{key:"handleAction",value:function(e){var t="on"+e.substring(0,1).toUpperCase()+e.substring(1);this.props[t](),this.setState({popoverVisible:!1})}},{key:"handlePopoverVisibleChange",value:function(e){var t=this;this.setState({popoverVisible:e}),!0===e?setTimeout(function(){t.setState({pageAttrGuideVisible:e})},190):this.setState({pageAttrGuideVisible:!1})}},{key:"renderPageMenu",value:function(e){var t=this,a=this.props.page,n=this.state,i=n.popoverVisible,l=n.pageAttrGuideVisible,r=this.props.guide;return c.default.createElement("ul",null,c.default.createElement(p.Tooltip,{placement:"right",title:__("\u70b9\u51fb\u300c\u91cd\u547d\u540d\u300d"),visible:!0===r.page.renamePage&&i&&l,overlayClassName:"editor-guide-tooltip"},c.default.createElement("li",null,c.default.createElement("span",{onClick:function(){return t.handleAction("rename")}},c.default.createElement(p.Icon,{type:"zhongmingming"}),__("\u91cd\u547d\u540d")))),c.default.createElement(p.Tooltip,{placement:"right",title:__("\u70b9\u51fb\u300c\u4fee\u6539\u8def\u5f84\u300d"),visible:!0===r.page.modifyPath&&i&&l,overlayClassName:"editor-guide-tooltip"},c.default.createElement("li",null,c.default.createElement("span",{onClick:function(){return t.handleAction("modifyPath")}},c.default.createElement(p.Icon,{type:"lujing"}),__("\u4fee\u6539\u8def\u5f84")))),c.default.createElement(p.Tooltip,{placement:"right",title:__("\u70b9\u51fb\u300c\u590d\u5236\u300d"),visible:!0===r.page.copyPage&&i&&l,overlayClassName:"editor-guide-tooltip"},c.default.createElement("li",null,c.default.createElement("span",{onClick:function(){return t.handleAction("copyPage")}},c.default.createElement(p.Icon,{type:"fuzhi"}),__("\u590d\u5236")))),a.isHomePage?c.default.createElement("li",{className:"disable"},c.default.createElement("span",null,c.default.createElement(p.Icon,{type:"zhuye"}),__("\u8bbe\u4e3a\u9996\u9875"))):c.default.createElement("li",null,c.default.createElement("span",{onClick:function(){return t.handleAction("setHomePage")}},c.default.createElement(p.Icon,{type:"zhuye"}),__("\u8bbe\u4e3a\u9996\u9875"))),a.isHomePage?c.default.createElement("li",{className:"disable"},c.default.createElement("span",null,c.default.createElement(p.Icon,{type:"shanchu"}),__("\u5220\u9664"))):c.default.createElement("li",null,c.default.createElement("span",{onClick:function(){return t.handleAction("deletePage")}},c.default.createElement(p.Icon,{type:"shanchu"}),__("\u5220\u9664"))))}},{key:"renderConfigIcon",value:function(e){var t=this,a=this.props.showUserGuideTips,n=(0,d.default)({"sep-item-setting":!0,"sep-item-setting-active":!1}),i=(0,d.default)("se-page-item-popover",{"se-page-item-popover-guide":a&&this.state.popoverVisible});return c.default.createElement(p.Popover,{trigger:"click",arrowPointAtCenter:!0,getPopupContainer:function(){return document.getElementById("site-editor-layout")},placement:"rightTop",content:this.renderPageMenu(e),visible:this.state.popoverVisible,overlayClassName:i,onVisibleChange:function(e){return t.handlePopoverVisibleChange(e)}},c.default.createElement(p.Icon,{onClick:function(){return t.handleShowPopover()},className:n,type:"shezhi"}))}},{key:"render",value:function(){var e=this.props,t=e.page,a=e.index,n=e.className,i=e.showUserGuideTips,l=e.pkg,r=e.pluginList,o=(0,h.getPagePlugin)(t,l,r);return c.default.createElement("div",{className:n},c.default.createElement(m,null),c.default.createElement("div",{className:"sep-item-title",onClick:this.props.onClick},c.default.createElement("h4",null,c.default.createElement("span",null,t.title),t.isHomePage?c.default.createElement("em",null,__("\u9996\u9875")):null,o&&c.default.createElement(p.Icon,{type:(0,u.default)(o,"icon","wenjuan-xin")})),c.default.createElement("span",{className:"sep-item-path",title:t.name},t.name)),c.default.createElement(p.Tooltip,{placement:"right",title:__("\u70b9\u51fb\u300c\u8bbe\u7f6e\u300d\u56fe\u6807"),visible:i&&!this.state.popoverVisible,overlayClassName:"editor-guide-tooltip"},this.renderConfigIcon(a)))}}]),t}(c.default.Component),v=(0,f.SortableElement)(g);t.default=v},P4C5:function(e,t,a){var n={"./en":"ndKy","./en.js":"ndKy","./zh_cn":"i8M6","./zh_cn.js":"i8M6"};function i(e){var t=l(e);return a(t)}function l(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=l,e.exports=i,i.id="P4C5"},Q4fm:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,l=n(a("43Yg")),r=n(a("/tCh")),o=n(a("scpF")),s=n(a("O/V9")),u=n(a("8aBX")),c=a("jXAE"),d=a("LfU0"),p=n(a("cDcd")),f=a("gzPx"),h=function(e,t,a,n){var i,l=arguments.length,r=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(l<3?i(r):l>3?i(t,a,r):i(t,a))||r);return l>3&&r&&Object.defineProperty(t,a,r),r},m=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=500,v=function(e){e.id;var t=e.actions;if(!t)return p.default.createElement("h4",null,__("\u63d2\u4ef6\u6e32\u67d3\u5931\u8d25"));var a=t.edit,n=t.settings,i=a?p.default.createElement(c.Button,{className:"plugin-btn-edit",type:"primary-reverse",size:"small",onClick:a.invoke},p.default.createElement(c.Icon,{type:"bianji"}),a.title):null,l=n?p.default.createElement(c.Button,{className:"plugin-btn-settings",type:"primary-reverse",size:"small",icon:"shezhi",onClick:n.invoke},n.title):null;return p.default.createElement("div",{className:"plugin-actions"},i,l)},y=function(e){function t(){var e;return(0,l.default)(this,t),e=(0,o.default)(this,(0,s.default)(t).apply(this,arguments)),e.state={loading:!0},e.dispatch=window.g_app._store.dispatch,e.invoke=function(t){return function(){var a=e.props.data,n=e.pluginModel.data,i=n.pluginId,l=n.originId,r="",o=function(t){e.changeSchemaData(t),e.changePluginData(t),e.changePluginList(t)},s=function(){return e.dispatch({type:"site/saveSiteData"})},u=function(t){return e.pluginModel.setSaving(t)},c=function(){return e.pluginModel.close()};return l||(r=t,t="create"),e.pluginModel.invoke({id:i,key:t,redirectKey:r,data:a,handleChangeData:o,handleSaveData:s,setLoading:u,closeModal:c})}},e}return(0,u.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.pluginModel.query(this.props.location).then(function(){e.setState({loading:!1})}).catch(console.error)}},{key:"changeSchemaData",value:function(e){this.props.onChange({options:{donnotRecord:!0},fields:[this.props.field],value:e})}},{key:"changePluginData",value:function(e){var t=this,a=e.originId,n=e.data;return this.pluginModel.changeData(function(){t.pluginModel.data.originId=a,t.pluginModel.data.data=n})}},{key:"changePluginList",value:function(e){var t=e.id,a=e.originId;return this.dispatch({type:"site/updatePluginItem",payload:{id:t,originId:a}})}},{key:"render",value:function(){if(!this.pluginModel.data)return null;var e=this.pluginModel.data,t=e.pluginId,a=e.pluginService,n=a.page,i={edit:{invoke:this.invoke("update"),title:n.update.title},settings:"settings"in n?{invoke:this.invoke("settings"),title:n.settings.title}:null};return p.default.createElement(c.Spin,{spinning:this.state.loading,delay:g},p.default.createElement(v,{id:t,actions:i}))}}]),t}(p.default.Component);h([(0,d.inject)(),m("design:type","function"===typeof(i="undefined"!==typeof f.PluginModel&&f.PluginModel)?i:Object)],y.prototype,"pluginModel",void 0),y=h([(0,d.connect)()],y);var E=(0,d.connect)(function(e){var t=e.present.page,a=t.activeSchema,n=t.activePageIndex,i=t.pageData,l=i[n],r=l.siteId,o=l.id,s=a.componentId,u=a.schemaName;return{location:{siteId:r,pageId:o,componentId:s,schemaName:u}}})(y);t.default=E},QSR2:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("cO38")),l=n(a("43Yg")),r=n(a("/tCh")),o=n(a("scpF")),s=n(a("O/V9")),u=n(a("8aBX")),c=n(a("cDcd")),d=a("LfU0"),p=n(a("iczh")),f=a("jXAE"),h=a("gzPx"),m=n(a("6OUm"));a("gzsh");var g,v=function(e,t,a,n){var i,l=arguments.length,r=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(l<3?i(r):l>3?i(t,a,r):i(t,a))||r);return l>3&&r&&Object.defineProperty(t,a,r),r},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e){function t(e){return(0,l.default)(this,t),(0,o.default)(this,(0,s.default)(t).call(this,e))}return(0,u.default)(t,e),(0,r.default)(t,[{key:"handleShowPagePanel",value:function(){window.g_app._store.dispatch({type:"site/changePanelVisible",payload:{panel:"pageList"}})}},{key:"renderPluginList",value:function(){var e=this,t=this.props.site.siteData.pluginList;if(!t||0===t.length)return null;var a={};t.forEach(function(e){var t=e.pluginService.pluginServiceId;a[t]||(a[t]=e.pluginService)});var n=function(t){var n=t.key,i=a[n];if(!i.page.manager)return f.message.warn("[".concat(i.title,"] ")+__("\u63d2\u4ef6\u6682\u65e0\u63d2\u4ef6\u7ba1\u7406"));var l=function(t){return e.pluginModel.setSaving(t)},r=function(){return e.pluginModel.close()};return e.pluginModel.invoke({key:"manager",setLoading:l,closeModal:r,target:{title:i.title,url:i.page.manager.url}})},l=c.default.createElement(f.Menu,{onClick:n},Object.entries(a).map(function(e){var t=(0,i.default)(e,2),a=(t[0],t[1]);return c.default.createElement(f.Menu.Item,{key:a.pluginServiceId,className:"plugin-list-item"},c.default.createElement(f.Icon,{type:a.icon}),a.title)}));return c.default.createElement("div",{className:"seh-nav-plugin"},c.default.createElement(f.Dropdown,{className:"plugin-list",overlay:l},c.default.createElement("div",null,c.default.createElement(f.Icon,{type:"chajian"}),c.default.createElement("span",{className:"plugin-list-title"},__("\u63d2\u4ef6\u7ba1\u7406")),c.default.createElement(f.Icon,{type:"xiala"}))))}},{key:"render",value:function(){var e=this,t=this.props,a=t.site,n=t.page,i=t.guide,l=(0,p.default)("seh-title",{"seh-title-active":!0===a.panelVisible.pageList});if(!a.siteData||!n.pageData)return null;var r=!!Object.keys(i.page).find(function(e){return!0===i.page[e]})&&!0!==a.panelVisible.pageList&&!0!==a.panelVisible.newPage,o=!!Object.keys(i.publish).find(function(e){return!0===i.publish[e]}),s=n.pageData[n.activePageIndex],u=(0,p.default)("se-header",{"se-header-without-logo":a.siteData.isOpenApiRequest,"se-header-guide-page":r,"se-header-guide-publish":o});return c.default.createElement("div",{className:u},c.default.createElement("div",{className:"seh-nav"},a.siteData.isOpenApiRequest?null:c.default.createElement("div",{className:"seh-logo"},c.default.createElement("a",{href:"/dashboard"},__("\u4e91\u51e4\u8776"))),c.default.createElement(f.Tooltip,{placement:"right",title:__("\u70b9\u51fb\u5c55\u5f00\u9875\u9762\u5217\u8868"),visible:r,overlayClassName:"editor-guide-tooltip"},c.default.createElement("div",{className:l,onClick:function(){return e.handleShowPagePanel()}},c.default.createElement(f.Icon,{type:"caidan"}),__("\u9875\u9762\uff1a"),c.default.createElement("span",null,s&&s.title||""))),this.renderPluginList()),c.default.createElement(m.default,null))}}]),t}(c.default.Component);v([(0,d.inject)(),y("design:type","function"===typeof(g="undefined"!==typeof h.PluginModel&&h.PluginModel)?g:Object)],E.prototype,"pluginModel",void 0),E=v([(0,d.connect)(),y("design:paramtypes",[Object])],E);var b=(0,d.connect)(function(e){return{guide:e.guide,site:e.site,page:e.page}})(E);t.default=b},Qjrp:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=n(a("99t5")),d=a("jXAE"),p=n(a("iczh")),f=a("oSo5"),h=d.Form.Item,m=(0,f.createComponent)(function(e){function t(){var e;return(0,i.default)(this,t),e=(0,r.default)(this,(0,o.default)(t).apply(this,arguments)),e.state={errorMsg:""},e.onChange=function(t){var a=t.target.value,n=e.props.field;e.props.onChange({value:a,fields:[n]})},e.onBlur=function(t){var a=t.target.value,n=e.props.data.trim();if(n!==a){var i=e.props.field;e.props.onChange({value:n,fields:[i]})}},e}return(0,s.default)(t,e),(0,l.default)(t,[{key:"validate",value:function(e){return"string"===typeof e?void 0:{success:!1,errMsg:__("\u9700\u8981string\u7c7b\u578b")}}},{key:"render",value:function(){var e=this.props,t=e.field,a=e.schema,n=e.config,i=e.data,l=n.validate,r=l(i,a.meta,a.type),o=(0,p.default)({"ui-form-item":!0,"field-string":!0,"ui-form-item-error":""!==r}),s=a.meta&&a.meta.description?u.default.createElement(c.default,{showTooltip:!0},a.meta.description):null;return u.default.createElement("div",{className:o,key:t},u.default.createElement("div",{className:"ui-label",style:{justifyContent:"space-between"}},u.default.createElement("span",{className:"ui-label-title",title:a.description},a.description),s,u.default.createElement("span",{style:{float:"right"}},this.renderPluginSelect({label:u.default.createElement(u.default.Fragment,null,u.default.createElement(d.Icon,{type:"bianji"}),u.default.createElement("span",{style:{marginLeft:8}},__("\u76f4\u63a5\u8f93\u5165"))),onClick:function(){}}))),u.default.createElement("div",{className:"ui-content"},u.default.createElement(h,{hasFeedback:!0,help:r,validateStatus:""===r?"":"error"},u.default.createElement(d.Input,{size:n.size,placeholder:this.props.placeholder,value:i,onChange:this.onChange,onBlur:this.onBlur,disabled:!!this.currentPlugin}))))}}]),t}(f.BasePluginComponent));t.default=m},Qkkz:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("uhLB")),c=a("L5c0"),d=n(a("cDcd")),p=n(a("R77D")),f=a("jXAE"),h=a("wuqM"),m=a("TcI+");a("L+T/");var g=function(e){function t(e){return(0,i.default)(this,t),(0,r.default)(this,(0,o.default)(t).call(this,e))}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleCloseModal",value:function(){this.props.dispatch({type:"site/updateProgressData",payload:{type:"open",progress:0}})}},{key:"handlePublishDone",value:function(){window.location.href="/dashboard"}},{key:"handleApproveWaiting",value:function(){var e=this.props.site.siteData;e.isOpenApiRequest&&e.openApiRedirectUrl?window.location.reload():window.location.href="/dashboard"}},{key:"renderProgress",value:function(){var e,t=this.props,a=t.site,n=a.siteData,i=a.progressData,l=a.releaseType,r=t.userData;return e=(0,m.isShouldApprove)(n,r.user.name)?(0,m.isGrey)(l)?__("\u7ad9\u70b9\u7070\u5ea6\u53d1\u5e03\u7533\u8bf7\u4e2d..."):__("\u7ad9\u70b9\u53d1\u5e03\u7533\u8bf7\u4e2d..."):(0,m.isGrey)(l)?__("\u7ad9\u70b9\u7070\u5ea6\u53d1\u5e03\u4e2d..."):__("\u7ad9\u70b9\u53d1\u5e03\u4e2d..."),d.default.createElement("div",{className:"se-release-progress"},d.default.createElement("p",null,e),d.default.createElement("div",{className:"se-release-progress-line"},d.default.createElement("div",null,d.default.createElement("span",{style:{width:"".concat(i.progress,"%")}})),d.default.createElement("em",null,i.progress,__("%"))))}},{key:"getSiteUrl",value:function(){var e=this.props,t=e.site,a=e.page,n=a.pageData.find(function(e){return e.isHomePage}),i="".concat(t.siteData.domain).concat(t.siteData.rootPath).concat(t.siteData.name);return n?i:"".concat(i,"/").concat(a.pageData[0].name)}},{key:"renderSuccess",value:function(){var e=this,t=this.props.site,a=this.getSiteUrl();return d.default.createElement("div",{className:"se-release-success"},d.default.createElement("h3",null,(0,m.isGrey)(t.releaseType)?__("\u7070\u5ea6\u53d1\u5e03\u6210\u529f"):__("\u53d1\u5e03\u6210\u529f")),d.default.createElement("div",{className:"se-release-success-info"},d.default.createElement(p.default,{size:100,value:a}),d.default.createElement("ul",null,d.default.createElement("li",{className:"se-release-url"},d.default.createElement("h4",null,__("\u7ad9\u70b9\u5730\u5740\uff1a")),d.default.createElement("div",null,d.default.createElement("a",{href:a,target:"_blank"},a),d.default.createElement(h.Copy,{text:a}))),d.default.createElement("li",{className:"se-release-url"},d.default.createElement("h4",null,__("\u7ad9\u70b9\u540d\u79f0\uff1a")),d.default.createElement("div",null,t.siteData.title)))),d.default.createElement("div",{className:"se-release-success-btn"},d.default.createElement(f.Button,{type:"primary",size:"large",onClick:function(){return e.handlePublishDone()}},__("\u5b8c\u6210")),!(0,m.isGrey)(t.releaseType)&&d.default.createElement("a",{href:"#",onClick:function(){return e.handleCloseModal()}},__("\u7ee7\u7eed\u7f16\u8f91"))))}},{key:"renderWaitingApprove",value:function(){var e=this,t=this.props.site,a=(0,u.default)(t,"siteData.latestReleaseInfo.releaseMeta.approverList",[]),n=t.siteData.isOpenApiRequest?null:__("\u5ba1\u6279\u4eba\uff1a")+a.map(function(e){return e.nick}).join("\u3001");return d.default.createElement("div",{className:"se-release-approve"},d.default.createElement("h3",null,__("\u5df2\u63d0\u4ea4\u7533\u8bf7")),d.default.createElement("p",null,(0,m.isGrey)(t.releaseType)?__("\u5df2\u63d0\u4ea4\u7ad9\u70b9\u7070\u5ea6\u53d1\u5e03\u7533\u8bf7\uff0c\u8bf7\u8010\u5fc3\u7b49\u5019"):__("\u5df2\u7ecf\u63d0\u4ea4\u7ad9\u70b9\u53d1\u5e03\u7533\u8bf7\uff0c\u8bf7\u8010\u5fc3\u7b49\u5019"),d.default.createElement("br",null),n),d.default.createElement(f.Button,{size:"large",type:"primary",onClick:function(){return e.handleApproveWaiting()}},__("\u5b8c\u6210")))}},{key:"render",value:function(){var e=this,t=this.props.site,a=t.siteData,n=t.progressData;return"open"===n.type||"failed"===n.type?null:d.default.createElement("div",{className:"se-release"},a.isOpenApiRequest||"released"!==n.type&&"waiting"!==n.type?null:d.default.createElement("span",{className:"se-release-close",onClick:function(){return e.handleCloseModal()}},d.default.createElement(f.Icon,{type:"guanbi"})),"releasing"===n.type?this.renderProgress():null,"released"===n.type?this.renderSuccess():null,"waiting"===n.type?this.renderWaitingApprove():null)}}]),t}(d.default.Component),v=(0,c.connect)(function(e){return{site:e.site,page:e.page,userData:e.user}})(g);t.default=v},RDqM:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=a("L5c0"),c=n(a("cDcd")),d=a("Hws7"),p=a("jXAE"),f=n(a("AFmn"));a("8Z6p");var h=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={loading:!1},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleCancelVipApprove",value:function(){var e=this,t=this.props.site.siteData;this.setState({loading:!0}),(0,f.default)({silence:!0}).cancelOpenApiSiteApprove(t.id).then(function(t){e.setState({loading:!1}),window.location.reload()}).catch(function(){e.setState({loading:!1}),p.message.error(__("\u53d6\u6d88\u5ba1\u6838\u5931\u8d25"))})}},{key:"render",value:function(){var e=this,t=this.props.site.siteData;return t.isOpenApiRequest&&t.status===d.SiteStatusEnum.APPROVE_WAITING?c.default.createElement("div",{className:"se-approve-mask"},c.default.createElement("div",{className:"seam-main"},c.default.createElement("p",null,__("\u7ad9\u70b9\u5df2\u63d0\u4ea4\u7533\u8bf7\u53d1\u5e03\uff0c\u6b63\u5728\u7b49\u5f85\u5ba1\u6279")),c.default.createElement(p.Button,{loading:this.state.loading,type:"primary",onClick:function(){return e.handleCancelVipApprove()}},__("\u53d6\u6d88\u7533\u8bf7")))):null}}]),t}(c.default.Component),m=(0,u.connect)(function(e){return{site:e.site}})(h);t.default=m},RpDq:function(e,t,a){"use strict";var n=a("fbTi"),i=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a("Ico4")),r=i(a("43Yg")),o=i(a("/tCh")),s=i(a("scpF")),u=i(a("O/V9")),c=i(a("8aBX")),d=a("L5c0"),p=i(a("cDcd")),f=i(a("ErGL")),h=a("jXAE"),m=a("svHh"),g=i(a("2VdL")),v=i(a("vizD")),y=a("DQUJ"),E=n(a("pQFk")),b=function(e,t,a,n){return new(a||(a=Promise))(function(i,l){function r(e){try{s(n.next(e))}catch(e){l(e)}}function o(e){try{s(n["throw"](e))}catch(e){l(e)}}function s(e){e.done?i(e.value):new a(function(t){t(e.value)}).then(r,o)}s((n=n.apply(e,t||[])).next())})},C=function(e){function t(e){var a;return(0,r.default)(this,t),a=(0,s.default)(this,(0,u.default)(t).call(this,e)),a.currentAntRender=Promise.resolve(),a.iframeRef=p.default.createRef(),a.state={focus:!1,editTitle:!1},a}return(0,c.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.iframe=new v.default(this.iframeRef.current,this.props.dispatch),this.props.dispatch({type:"view/saveIframe",payload:{iframe:this.iframe}}),this.watchAntRender()}},{key:"shouldComponentUpdate",value:function(e,t){return e!==this.props||t!==this.state}},{key:"componentWillUnmount",value:function(){var e=window.g_app._store;e&&"function"===typeof e.unsubscribe&&e.unsubscribe()}},{key:"requestRender",value:function(){return b(this,void 0,void 0,l.default.mark(function e(){var t=this;return l.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,a){t.currentAntRender=t.currentAntRender.then(function(){return t.props.dispatch({type:"view/renderPage"}).then(function(t){t?e(t):a("Render No Content!")}).catch(function(e){a(e)})})}));case 1:case"end":return e.stop()}},e)}))}},{key:"reload",value:function(e,t){var a=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.props.dispatch({type:"view/changeViewPageStatus",payload:{status:"loading"}}),this.requestRender().then(function(i){var l=i.html.replace("</head>","<style>".concat(g.default,"</style></head>"));a.iframe.render(l,e,t,n),a.props.dispatch({type:"view/changeViewPageStatus",payload:{status:null}})}).catch(function(e){E.normal.log(e),(0,y.logScriptError)(e,{position:"render-reload"}),a.iframe.render("Render error, please try again later."),a.props.dispatch({type:"view/changeViewPageStatus",payload:{status:null}})})}},{key:"watchAntRender",value:function(){var e=this,t=(0,f.default)(function(t,a){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e.reload(t,a,n)},400);this.reload();var a=window.g_app._store;a&&a.subscribe(function(){if(e.iframe){var n=a.getState(),i=n.page.meta;if(!0===i.refresh){var l=i.scrollComponentId,r=i.scrollSchemaName,o=i.needActiveSchema;e.props.dispatch({type:"page/resetRefreshMeta",payload:{refresh:!1,scrollComponentId:null,scrollSchemaName:null,needActiveSchema:!1}}),t(l,r,o)}}})}},{key:"renderComponentGuide",value:function(){var e=this.props,t=e.guide,a=e.page,n=e.site,i=a.pageData[a.activePageIndex],l=i.componentList&&i.componentList[0]||null,r=Object.keys(t.component).find(function(e){return!0===t.component[e]});if(!r||n.panelVisible.newModule||!l||!l.meta)return null;var o=l.meta.top+l.meta.height,s=__("\u9f20\u6807\u79fb\u52a8\u5230\u7ec4\u4ef6");return t.component.addComponent&&(o+=20,s=__("\u9f20\u6807\u79fb\u52a8\u5230\u7ec4\u4ef6\u70b9\u51fb\u300c+\u300d")),t.component.modifyData&&(s=__("\u5355\u51fb\u9009\u62e9\u7ec4\u4ef6")),p.default.createElement("div",{className:"se-preview-guide",style:{top:o+"px"}},p.default.createElement(h.Tooltip,{placement:"bottom",title:s,visible:r&&!n.panelVisible.newModule,overlayClassName:"editor-guide-tooltip"},p.default.createElement("div",null)))}},{key:"render",value:function(){var e=this.props,t=e.site,a=e.page,n=e.view,i=e.space,l=t.siteData.sandboxDomain,r=a.iframeHeight,o={height:r+"px",width:"100%",display:"block"},s="loading"===n.viewPageStatus&&!t.showGlobalLoading,u=i.alias?"?spaceAlias=".concat(i.alias):"";return p.default.createElement("div",{className:"se-preview-iframe"},p.default.createElement(m.ScrollSyncPane,null,p.default.createElement("div",{id:"seViewScroll",className:"se-preview-scroll"},p.default.createElement(h.Spin,{spinning:s},p.default.createElement("iframe",{ref:this.iframeRef,src:"".concat(l,"/sandbox").concat(u),frameBorder:"0",style:o}),this.renderComponentGuide()))))}}]),t}(p.default.Component),P=(0,d.connect)(function(e){return{guide:e.guide,site:e.site,page:e.page,view:e.view,space:e.space}})(C);t.default=P},ZNJB:function(e,t,a){},Zq0e:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=a("L5c0"),c=n(a("cDcd")),d=a("jXAE"),p=a("bE7M");a("6W0e");var f=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={socialShareModalVisible:!1,pagePath:null,pagePathErrorMsg:null},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleShowPagePathModifyModal",value:function(){var e=this.props.page;this.props.dispatch({type:"site/updateModifyPagePathIndex",payload:{pageIndex:e.activePageIndex}})}},{key:"handleModifyPagePath",value:function(){var e=this.props.site;this.props.dispatch({type:"page/updatePagePath",payload:{pageIndex:e.currentModifyPathPageIndex,path:this.state.pagePath}}),this.setState({pagePath:null}),this.props.dispatch({type:"site/cancelModifyPagePath"}),this.props.dispatch({type:"guide/completeGuide"})}},{key:"handlePagePathInputChange",value:function(e){var t=this.props,a=t.site,n=t.page,i=e.target.value.trim();if(""!==i&&/^([a-z]|\d|-|_)+$/g.test(i)){var l=n.pageData.findIndex(function(e){return e.name==="".concat(i,".html")});l>-1&&l!==a.currentModifyPathPageIndex?this.setState({pagePathErrorMsg:__("\u9875\u9762\u8def\u5f84\u91cd\u590d")}):"index"!==i?this.setState({pagePath:i,pagePathErrorMsg:null}):this.setState({pagePathErrorMsg:__("\u8be5\u8def\u5f84\u4e0d\u53ef\u7528")})}else this.setState({pagePathErrorMsg:__("\u8bf7\u8f93\u5165\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u3001\u4e2d\u6a2a\u7ebf\u7684\u7ec4\u5408")})}},{key:"handleCancelModifyPagePath",value:function(){this.setState({pagePath:null,pagePathErrorMsg:null}),this.props.dispatch({type:"site/cancelModifyPagePath"})}},{key:"handleModifySocialShare",value:function(e){var t=this.props.page,a=t.pageData[t.activePageIndex];this.setState({socialShareModalVisible:!1}),this.props.dispatch({type:"page/updatePageShare",payload:{currentPageName:a.name,share:e}}),d.message.success(__("\u9875\u9762\u5206\u4eab\u4fe1\u606f\u4fee\u6539\u6210\u529f"))}},{key:"renderPathModal",value:function(){var e=this,t=this.props,a=t.site,n=t.page,i=t.guide,l=a.siteData,r=!0;if(!n.pageData[a.currentModifyPathPageIndex])return null;var o=n.pageData[a.currentModifyPathPageIndex];return 1===l.onlineStatus&&new Date(o.gmtCreate).getTime()<=new Date(l.publishTime).getTime()&&(r=!1),c.default.createElement(d.Modal,{width:568,footer:null,title:__("\u4fee\u6539\u9875\u9762\u8def\u5f84"),maskClosable:!1,visible:!0,wrapClassName:"editor-modal se-page-path-modal",onCancel:function(){return e.handleCancelModifyPagePath()}},c.default.createElement(d.Tooltip,{placement:"right",title:__("\u4fee\u6539\u9875\u9762\u8def\u5f84\u5e76\u70b9\u51fb\u300c\u4fee\u6539\u300d\u5373\u53ef"),visible:!0===i.page.modifyPath,overlayClassName:"editor-guide-tooltip"},c.default.createElement("div",{className:"se-page-path-modal-container"},c.default.createElement("p",null,__("\u9875\u9762\u8def\u5f84")),c.default.createElement("div",{className:"se-page-path-modal-path"},c.default.createElement("p",null,l.domain,l.rootPath,l.name),c.default.createElement(d.Input,{placeholder:__("\u8f93\u5165\u9875\u9762\u8def\u5f84"),size:"large",autoFocus:!0,disabled:!r,defaultValue:this.state.pagePath||o.name.replace(/\.html/gi,""),onChange:function(t){return e.handlePagePathInputChange(t)}}),c.default.createElement("span",null,__(".html")),r?null:c.default.createElement("div",{className:"se-page-path-modal-error"},__("\u5df2\u53d1\u5e03\u7684\u9875\u9762\u65e0\u6cd5\u4fee\u6539\u8def\u5f84")),this.state.pagePathErrorMsg?c.default.createElement("div",{className:"se-page-path-modal-error"},this.state.pagePathErrorMsg):null),c.default.createElement("div",{className:"se-page-path-modal-btn"},c.default.createElement(d.Button,{size:"small",onClick:function(){return e.handleCancelModifyPagePath()}},__("\u53d6\u6d88")),c.default.createElement(d.Button,{disabled:!r||!!this.state.pagePathErrorMsg,type:"primary",size:"small",onClick:function(){return e.handleModifyPagePath()}},__("\u4fee\u6539"))))))}},{key:"renderSocialShareModal",value:function(){var e=this,t=this.props,a=t.site,n=t.page,i=n.pageData[n.activePageIndex],l=this.state.socialShareModalVisible;return c.default.createElement(p.SocialShareModal,{visible:l,shareData:a.siteData.share,pageList:n.pageData,currentPage:i,onCancel:function(){return e.setState({socialShareModalVisible:!1})},onSubmit:function(t){return e.handleModifySocialShare(t)}})}},{key:"getPageUrl",value:function(){var e=this.props,t=e.site,a=e.page,n=t.siteData,i=a.pageData[a.activePageIndex],l="".concat(t.siteData.domain).concat(t.siteData.rootPath).concat(n.name);return i.isHomePage?l:"".concat(l,"/").concat(i.name)}},{key:"render",value:function(){var e=this;return c.default.createElement("div",{className:"se-page-path-container"},c.default.createElement("div",{className:"se-page-path"},c.default.createElement("div",{className:"se-pp-url"},c.default.createElement("span",null,this.getPageUrl()),c.default.createElement(d.Icon,{type:"bianji",onClick:function(){return e.handleShowPagePathModifyModal()}}),this.renderPathModal()),c.default.createElement("div",{className:"se-pp-share"},c.default.createElement(d.Icon,{type:"fenxiang",onClick:function(){return e.setState({socialShareModalVisible:!0})}}))),this.renderSocialShareModal())}}]),t}(c.default.Component),h=(0,u.connect)(function(e){return{guide:e.guide,site:e.site,page:e.page}})(f);t.default=h},a5Kl:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=n(a("iczh")),d=a("jXAE"),p=n(a("kfnS")),f=a("oSo5"),h=n(a("Qjrp")),m=d.Select.Option,g={text:__("\u94fe\u63a5\u5730\u5740"),local:__("\u672c\u7ad9\u9875\u9762")},v="",y="";function E(e,t){if(e&&t&&t.length>0){var a=t.some(function(t){return t.url.trim()===e.trim()});if(a)return!0}return!1}var b=(0,f.createComponent)(function(e){function t(e){var a;(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.handleSwitchCheckType=function(e){var t=a.state.data;if("local"===e){var n=a.props.config,i=n.localUrlData;if(t=y,(0,p.default)(y)){var l=i.find(function(e){return e.isHomePage})||{};t=l.url||__("\u672c\u7ad9\u9875\u9762")}}else t=v;a.setState({checkType:e},function(){a.onChange(t)})};var n=E(e.data,e.config.localUrlData);return a.state={checkType:n?"local":"text",data:e.data},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"validate",value:function(e){throw new Error("Method not implemented.")}},{key:"componentWillReceiveProps",value:function(e){e.data!==this.props.data&&this.setState({data:e.data})}},{key:"handleSelect",value:function(e){y=e,this.onChange(e)}},{key:"handleInputChange",value:function(e){var t=e.target.value.trim();v=t,this.onChange(t)}},{key:"onChange",value:function(e){e!==this.state.data&&this.props.onChange({value:e,fields:[this.props.field]})}},{key:"renderInputOrSelect",value:function(){var e=this,t=this.props.config,a=t.localUrlData,n=this.state,i=n.data,l=n.checkType;if("local"===l){var r=a.map(function(e,t){var a=u.default.createElement("div",{className:"editor-editor-url-select-item"},u.default.createElement("div",null,e.name,e.isHomePage?u.default.createElement("span",null,__("\u9996\u9875")):null),u.default.createElement("p",null,e.text));return u.default.createElement(m,{value:e.url,key:t},a)});return u.default.createElement(d.Select,{size:"large",value:i,dropdownClassName:"editor-select editor-editor-url-select",onChange:function(t){return e.handleSelect(t)}},r)}return u.default.createElement(d.Input,{value:i,onChange:function(t){return e.handleInputChange(t)},onBlur:function(t){return e.handleInputChange(t)},size:"large"})}},{key:"render",value:function(){var e=this.props,t=e.field,a=e.schema,n=e.data,i=e.config,l=this.props.config,r=l.localUrlData,o=l.localUrlText,s=this.state.checkType;if(!r||r.length<2){var p=this.props.metaData,f=(0,h.default)(p.type,p.plugins);return u.default.createElement(f,Object.assign({},this.props))}var v=Object.keys(g).map(function(e){var t="local"===e&&o||g[e];return u.default.createElement(m,{value:e,key:e},t)}),y=null,E="";"local"!==s&&(E=i.validate(n,a.meta,a.type),E&&(y=u.default.createElement("div",{className:"ant-form-explain"},E)));var b=(0,c.default)("ui-form-item","item-url-input",{"has-error":!!y});return u.default.createElement("div",{className:b},u.default.createElement("span",{className:"ui-label",title:t},a.description),u.default.createElement("div",{className:"ui-content"},u.default.createElement(d.Select,{className:"item-checktype",dropdownClassName:"editor-select",defaultValue:s,onChange:this.handleSwitchCheckType,size:"large"},v),u.default.createElement("div",{className:"item-type-url"},this.renderInputOrSelect())),y)}}]),t}(f.BasePluginComponent));t.default=b},bE7M:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.SocialShareModal=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=a("jXAE"),d=a("v3NV");a("6W0e");var p=function(e){function t(){var e;return(0,i.default)(this,t),e=(0,r.default)(this,(0,o.default)(t).apply(this,arguments)),e.saveFormRef=function(t){return e.form=t},e.handleSubmitShareData=function(){e.form.props.form.validateFields(function(t,a){t||e.props.onSubmit(a)})},e}return(0,s.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.props,t=e.pageList,a=e.shareData,n=e.visible,i=e.onCancel,l=e.currentPage;return u.default.createElement(c.Modal,{onCancel:i,visible:n,style:{width:"90%",height:"90%"},width:"90%",wrapClassName:"editor-modal sd-social-share-modal",title:__("\u9875\u9762\u5206\u4eab\u8bbe\u7f6e"),footer:[u.default.createElement("span",{key:"tip",style:{marginRight:16,color:"rgba(0, 0, 0, .45)"}},u.default.createElement("span",{style:{color:"red",verticalAlign:"middle"}},"* "),__("\u9875\u9762\u5206\u4eab\u8bbe\u7f6e\u7684\u5185\u5bb9\u4ec5\u5e94\u7528\u4e8e\u5355\u9875")),u.default.createElement(c.Button,{key:"back",onClick:i},__("\u53d6\u6d88")),u.default.createElement(c.Button,{key:"submit",type:"primary",onClick:this.handleSubmitShareData},__("\u4fdd\u5b58\u8bbe\u7f6e"))]},u.default.createElement(d.ShareForm,{share:a,pages:t,currentPage:l,wrappedComponentRef:this.saveFormRef}))}}]),t}(u.default.Component);t.SocialShareModal=p},cW5k:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=a("L5c0"),c=n(a("cDcd")),d=n(a("iczh")),p=a("svHh"),f=n(a("Zq0e")),h=n(a("RpDq")),m=n(a("jmFK")),g=n(a("EOHe"));a("6W0e");var v=function(e){function t(e){return(0,i.default)(this,t),(0,r.default)(this,(0,o.default)(t).call(this,e))}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleDragOver",value:function(e){this.props.dispatch({type:"view/showDropComponentPlaceHolder",payload:e})}},{key:"handleDrop",value:function(e){this.props.dispatch({type:"view/dropComponent",payload:{type:e.payload.type,subType:e.payload.subType,sourceIndex:e.payload.index,addIndex:e.addedIndex}})}},{key:"handleCancelAddComponent",value:function(){var e=this.props.site;!0===e.panelVisible.newModule&&this.props.dispatch({type:"site/changePanelVisible",payload:{panel:"newModule",visible:!1}})}},{key:"renderActiveComponentTips",value:function(){var e=this.props.page.activeSchema;return e.schemaName?c.default.createElement("div",{className:"se-view-active-tip",style:{top:e.meta.top+"px",height:e.meta.height+"px"}}):null}},{key:"renderHoverComponentTips",value:function(){var e=this.props.page.hoverComponent,t=e.top,a=e.height;return t||a?c.default.createElement("div",{className:"se-view-hover-tip",style:{top:"".concat(t,"px"),height:"".concat(a,"px")}}):null}},{key:"render",value:function(){var e=this,t=this.props,a=t.guide.component,n=t.page.iframeHeight,i=t.site.panelVisible,l=t.view.maskVisible,r=i.newModule,o=Object.keys(a).find(function(e){return!0===a[e]}),s=(0,d.default)("se-preview-box",{"se-preview-box-guide":!!o});return c.default.createElement("div",{className:"se-preview"},c.default.createElement(f.default,null),c.default.createElement(p.ScrollSync,null,c.default.createElement("div",{className:s},c.default.createElement(h.default,null),c.default.createElement(p.ScrollSyncPane,null,c.default.createElement("div",{className:"se-preview-container",onClick:function(){return e.handleCancelAddComponent()}},c.default.createElement("div",{className:"se-preview-tips",style:{height:n+"px"}},this.renderHoverComponentTips(),this.renderActiveComponentTips(),l&&r?c.default.createElement(m.default,{view:this.props.view,page:this.props.page,height:n,onDragOver:function(t){return e.handleDragOver(t)},onDrop:function(t){return e.handleDrop(t)}}):null,c.default.createElement(g.default,null)))))))}}]),t}(c.default.Component),y=(0,u.connect)(function(e){return{guide:e.guide,site:e.site,page:e.page,view:e.view}})(v);t.default=y},dK0G:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=a("jXAE"),d=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={title:null},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){return u.default.createElement(c.Modal,{width:568,footer:null,visible:!0,okText:__("\u5220\u9664"),title:__("\u5220\u9664\u9875\u9762"),wrapClassName:"editor-modal se-del-page-modal",onCancel:this.props.onCancel},u.default.createElement("div",{className:"se-del-page-main"},u.default.createElement("img",{width:"125",height:"116",src:"https://gw.alipayobjects.com/zos/rmsportal/caurGJTHhuwTlKcCgoIy.png"}),__("\u662f\u5426\u786e\u8ba4\u5220\u9664\u8be5\u9875\u9762\uff1f"),u.default.createElement("div",{className:"editor-modal-btn"},u.default.createElement(c.Button,{className:"se-btn-cancel",size:"small",onClick:this.props.onCancel},__("\u53d6\u6d88")),u.default.createElement(c.Button,{className:"se-btn-confirm",type:"danger",size:"small",onClick:this.props.onConfirm},__("\u5220\u9664")))))}}]),t}(u.default.Component),p=d;t.default=p},dZKQ:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=a("L5c0"),d=a("jXAE"),p=n(a("iczh")),f=n(a("AjiT")),h=n(a("QpxU")),m=n(a("/FW/")),g=n(a("0HeX")),v=n(a("QSR2")),y=n(a("mZey")),E=n(a("FhyR")),b=n(a("Edua")),C=n(a("EkgX")),P=n(a("vyZa")),k=n(a("cW5k")),_=n(a("uy0V")),S=n(a("RDqM")),w=n(a("Qkkz")),D=n(a("zXyN")),I=a("Hws7"),x=a("TcI+");a("87NF");var N=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={currentDragComponent:{type:null,index:null}},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match;t&&t.params.siteId&&/^\d+$/.test(t.params.siteId)&&this.props.dispatch({type:"site/loadSiteData",payload:{siteId:t.params.siteId}}),window.onbeforeunload=function(){if(e.props.page.hasModify)return __("\u6570\u636e\u672a\u4fdd\u5b58")}}},{key:"insertDropComponent",value:function(){var e=this.props.site,t=this.state.currentDragComponent,a=t.type,n=t.index;if("common"===a){var i=e.commonComponentList[n];this.props.dispatch({type:"page/addCommonComponent",payload:i})}else{var l=e.siteData.papilioPackage.components[n];this.props.dispatch({type:"page/addComponent",payload:{name:l.name}})}}},{key:"handleDragUpdate",value:function(e){var t=e.source,a=e.destination;a&&("sortPage"!==t.droppableId||this.props.dispatch({type:"page/updateDragStatus",payload:{index:a.index}}))}},{key:"getPanelWidth",value:function(){var e=this.props,t=e.site.panelVisible,a=e.page.activeSchema,n=0,i=Object.keys(t).filter(function(e){return!!t[e]})[0];switch(i){case"pageList":n=336;break;case"newPage":n=490;break;case"newModule":n=490;break;case"schemaEditor":n=a.schemaName?490:0;break;default:n=0}return{width:"".concat(n,"px")}}},{key:"render",value:function(){var e=this.props,t=e.site,a=e.guide,n=e.view;if(!t.siteData)return null;var i=Object.keys(a.page).find(function(e){return!0===a.page[e]}),l=(0,p.default)("site-panel",{"site-panel-guide":!!i||a.component.addComponent||a.component.modifyData}),r=(0,p.default)("site-editor-layout",{"site-editor-layout-mask":"loading"===n.viewPageStatus});return u.default.createElement(f.default,{title:"".concat(__("\u7f16\u8f91"),": ").concat(t.siteData.title),pagename:__("\u7f16\u8f91\u6a21\u677f")},u.default.createElement(d.Spin,{size:"large",spinning:t.showGlobalLoading,wrapperClassName:"site-editor-loading"},u.default.createElement("div",{className:r,id:"site-editor-layout"},u.default.createElement(v.default,null),u.default.createElement(m.default,null),u.default.createElement("div",{className:"site-body"},u.default.createElement("div",{className:l,style:this.getPanelWidth()},u.default.createElement(C.default,null),u.default.createElement(E.default,null),u.default.createElement(D.default,null),u.default.createElement(b.default,null)),u.default.createElement("div",{className:"site-panel-animate",style:this.getPanelWidth()}),u.default.createElement(k.default,null)),u.default.createElement(w.default,null),u.default.createElement(P.default,null),u.default.createElement(_.default,null),u.default.createElement(y.default,null))),u.default.createElement(g.default,null),u.default.createElement(S.default,null),t.siteData.status===I.SiteStatusEnum.IN_GREY&&u.default.createElement(h.default,{defaultVisible:!0,forceOpen:!0,bizId:t.siteData.id,isDomainSupportGreyInner:(0,x.isDomainSupportGreyInner)(t.siteData.domain),extra:u.default.createElement(d.Alert,{message:__("\u7ad9\u70b9\u7070\u5ea6\u53d1\u5e03\u4e2d\u3002\u8bf7\u53d6\u6d88\u7070\u5ea6\u53d1\u5e03\u6216\u5168\u91cf\u53d1\u5e03\u540e\uff0c\u518d\u8fdb\u884c\u7ad9\u70b9\u7f16\u8f91\u3002"),type:"warning",showIcon:!0}),onCancelGrey:function(){return location.href="/i/site/".concat(t.siteData.id,"/overview")}}))}}]),t}(u.default.Component),M=(0,c.connect)(function(e){return{guide:e.guide,view:e.view,site:e.site,page:e.page}})(N);t.default=M},"fDY/":function(e,t,a){},gIoJ:function(e,t,a){"use strict";function n(e,t){try{return e()}catch(e){return t}}Object.defineProperty(t,"__esModule",{value:!0}),t.get=n},gzsh:function(e,t,a){},jmFK:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("uhLB")),c=n(a("cDcd")),d=n(a("iczh")),p=a("+hOP"),f=function(e){function t(e){var a;(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.dropMaskRef=c.default.createRef();var n=null;return"undefined"!==typeof MutationObserver&&(a.observer=new MutationObserver(function(e){clearTimeout(n),n=setTimeout(function(){return a.calcDropHolderPosition(e.length)},200)})),a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"componentWillUpdate",value:function(){this.dropMaskRef.current?this.observer.observe(this.dropMaskRef.current,{attributes:!0,subtree:!0}):this.observer.disconnect()}},{key:"componentWillUnmount",value:function(){this.dropMaskRef&&delete this.dropMaskRef,this.observer&&this.observer.disconnect()}},{key:"calcDropHolderPosition",value:function(e){var t=this.props,a=t.page,n=t.onDragOver,i=a.pageData[a.activePageIndex].componentList||[];if(!(this.dragDone||e>i.length)&&this.dropMaskRef){var l=(0,u.default)(this.dropMaskRef,"current.childNodes[0].childNodes",[]),r=[].find.call(l,function(e){return!!e.style.transform});if(r){var o=parseInt(r.getAttribute("index"),10);n({index:o,type:"before"})}else n({index:i.length-1,type:"after"})}}},{key:"handleDragEnter",value:function(){this.dragDone=!1}},{key:"handleDrop",value:function(e){this.dragDone=!0,this.props.onDrop(e)}},{key:"render",value:function(){var e=this,t=this.props,a=t.page,n=t.view,i=t.height,l=a.pageData[a.activePageIndex].componentList||[],r=(0,u.default)(l,"[0].meta.top"),o=(0,d.default)("se-view-mask",{"se-view-mask-dragging":"auto"===n.maskPointerEvents});return c.default.createElement("div",{className:o,ref:this.dropMaskRef,style:{marginTop:r+"px"}},c.default.createElement(p.Container,{groupName:"component-list",style:{height:"".concat(i+120,"px")},onDragEnter:function(){return e.handleDragEnter()},onDrop:function(t){return e.handleDrop(t)}},l.map(function(e,t){var a={height:(0,u.default)(e,"meta.height",0),top:(0,u.default)(e,"meta.top")-r||0};return c.default.createElement(p.Draggable,{key:t,index:t,style:{top:"".concat(a.top,"px"),height:"".concat(a.height,"px")}},c.default.createElement("span",{key:t}))})))}}]),t}(c.default.Component),h=f;t.default=h},mZey:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("cO38")),l=n(a("43Yg")),r=n(a("/tCh")),o=n(a("scpF")),s=n(a("O/V9")),u=n(a("8aBX")),c=a("L5c0"),d=n(a("cDcd")),p=a("jXAE"),f=n(a("iczh")),h=a("TcI+");a("7jmc");var m=function(e){function t(e){return(0,l.default)(this,t),(0,o.default)(this,(0,s.default)(t).call(this,e))}return(0,u.default)(t,e),(0,r.default)(t,[{key:"componentWillMount",value:function(){this.props.dispatch({type:"guide/initGuide"})}},{key:"handleToggleHelper",value:function(e){var t=this.props.guide.guideVisible;this.props.dispatch({type:"guide/updateGuideVisible"}),t?this.props.dispatch({type:"guide/updateGuideData",payload:{}}):this.props.dispatch({type:"guide/updateGuideItemVisible",payload:{visible:!0}}),e.preventDefault(),e.stopPropagation()}},{key:"handleShowGuide",value:function(e){var t=e.split("."),a=(0,i.default)(t,2),n=a[0],l=a[1];this.props.dispatch({type:"guide/updateGuideData",payload:{type:n,name:l,value:!0}}),this.props.dispatch({type:"guide/updateGuideItemVisible",payload:{visible:!1}})}},{key:"handlePreventDefault",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"renderGuideIcon",value:function(e){var t=this.props.guide.serverGuideData;return Array.isArray(t)&&-1===t.indexOf(e)?d.default.createElement(p.Icon,{type:"bofang"}):d.default.createElement(p.Icon,{type:"chenggong"})}},{key:"renderGuide",value:function(){var e=this,t=this.props,a=t.site,n=t.page,i=t.userData,l=a.siteData.papilioPackage,r=n.pageData[n.activePageIndex],o=(0,h.isShouldApprove)(a.siteData,i.user.name),s=!0,u=!1;return!a.siteData.notAllowRelease&&a.siteData.trialCanPublish||(s=!1),r.packageId&&(l=a.commonPageDetail[r.packageId].papilioPackage),r.componentList.length>1&&(u=!0),d.default.createElement("div",{className:"seu-guide-item",onClick:function(t){return e.handlePreventDefault(t)}},d.default.createElement("p",null,__("\u901a\u8fc7\u5bf9\u4ee5\u4e0b\u529f\u80fd\u7684\u4ecb\u7ecd\u5b66\u4e60\uff0c\u53ef\u4ee5\u5e2e\u52a9\u4f60\u5feb\u901f\u5b8c\u6210\u7ad9\u70b9\u642d\u5efa")),d.default.createElement("div",{className:"seu-guide-body"},d.default.createElement("div",{className:"seu-guide-group"},d.default.createElement("h4",null,__("\u9875\u9762\u7ba1\u7406")),d.default.createElement("ul",null,d.default.createElement("li",{onClick:function(){return e.handleShowGuide("page.addPage")}},this.renderGuideIcon("page.addPage"),__("\u6dfb\u52a0\u9875\u9762")),d.default.createElement("li",{onClick:function(){return e.handleShowGuide("page.copyPage")}},this.renderGuideIcon("page.copyPage"),__("\u590d\u5236\u9875\u9762")),d.default.createElement("li",{onClick:function(){return e.handleShowGuide("page.renamePage")}},this.renderGuideIcon("page.renamePage"),__("\u91cd\u547d\u540d\u9875\u9762")),d.default.createElement("li",{onClick:function(){return e.handleShowGuide("page.modifyPath")}},this.renderGuideIcon("page.modifyPath"),__("\u4fee\u6539\u9875\u9762\u8def\u5f84")))),l.componentsPlaceholder?d.default.createElement("div",{className:"seu-guide-group"},d.default.createElement("h4",null,__("\u7ec4\u4ef6\u7ba1\u7406")),d.default.createElement("ul",null,d.default.createElement("li",{onClick:function(){return e.handleShowGuide("component.addComponent")}},this.renderGuideIcon("component.addComponent"),__("\u6dfb\u52a0\u7ec4\u4ef6")),u?d.default.createElement("li",{onClick:function(){return e.handleShowGuide("component.sortComponent")}},this.renderGuideIcon("component.sortComponent"),__("\u8c03\u6574\u7ec4\u4ef6\u987a\u5e8f")):null,d.default.createElement("li",{onClick:function(){return e.handleShowGuide("component.modifyData")}},this.renderGuideIcon("component.modifyData"),__("\u4fee\u6539\u7ec4\u4ef6\u5185\u5bb9")))):null,d.default.createElement("div",{className:"seu-guide-group"},d.default.createElement("h4",null,__("\u9884\u89c8\u548c\u53d1\u5e03")),d.default.createElement("ul",null,d.default.createElement("li",{onClick:function(){return e.handleShowGuide("publish.preview")}},this.renderGuideIcon("publish.preview"),__("\u9884\u89c8\u7ad9\u70b9")),o?d.default.createElement("li",{onClick:function(){return e.handleShowGuide("publish.approve")}},this.renderGuideIcon("publish.approve"),__("\u7533\u8bf7\u53d1\u5e03\u7ad9\u70b9")):null,s?d.default.createElement("li",{onClick:function(){return e.handleShowGuide("publish.release")}},this.renderGuideIcon("publish.release"),__("\u53d1\u5e03\u7ad9\u70b9")):null))))}},{key:"render",value:function(){var e=this,t=this.props.site.siteData,a=this.props.guide,n=a.firstUseEditor,i=a.guideVisible,l=a.guideItemVisible,r=(0,f.default)("se-user-guide",{"se-user-guide-active":i,"se-user-guide-first-active":n});if(t.isOpenApiRequest)return null;if(!i)return d.default.createElement("div",{className:r},d.default.createElement("div",{className:"seu-guide-btn",onClick:function(t){return e.handleToggleHelper(t)}},d.default.createElement(p.Icon,{antd:!0,type:"question"})));var o=d.default.createElement("div",{className:"seu-guide-btn",onClick:function(t){return e.handleToggleHelper(t)}},d.default.createElement(p.Icon,{type:"guanbi"}));return l?d.default.createElement("div",{className:r,onClick:function(t){return e.handleToggleHelper(t)}},this.renderGuide(),o):d.default.createElement("div",{className:r,onClick:function(t){return e.handleToggleHelper(t)}},d.default.createElement(p.Tooltip,{trigger:"hover",placement:"topRight",title:__("\u82e5\u5df2\u5b8c\u6210\u5b66\u4e60\uff0c\u53ef\u70b9\u51fb\u9000\u51fa"),overlayClassName:"editor-guide-tooltip"},o))}}]),t}(d.default.Component),g=(0,c.connect)(function(e){return{guide:e.guide,site:e.site,page:e.page,userData:e.user}})(m);t.default=g},nPAi:function(e,t,a){"use strict";var n=a("fbTi"),i=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a("43Yg")),r=i(a("/tCh")),o=i(a("scpF")),s=i(a("O/V9")),u=i(a("8aBX")),c=n(a("cDcd")),d=n(a("faye")),p=i(a("iczh")),f=i(a("YTHA")),h=i(a("CSry")),m=a("jXAE"),g=a("oSo5"),v=(0,g.createComponent)(function(e){function t(){var e;return(0,l.default)(this,t),e=(0,o.default)(this,(0,s.default)(t).apply(this,arguments)),e.state={selectText:"",errorMsg:"",success:!1},e.handleSelectFile=function(){e.setState({errorMsg:""});try{var t=d.findDOMNode(e.uploadRef);t.firstChild.firstChild.click()}catch(e){}},e.beforeUpload=function(t){var a=e.props,n=a.meta,i=a.config,l=a.schema,r=h.default.validateImageMaxSize(t,l);if(!r.result)return e.setState({errorMsg:r.message}),!1;if(Math.floor(t.size)>i.uploadImgSize)return e.setState({errorMsg:"\u56fe\u7247\u5927\u5c0f\u8d85\u8fc7 ".concat(Math.floor(i.uploadImgSize/1024),"KB")}),!1;if(n&&n.setDefaultColorTo&&t.type.match("image.*")){var o=new FileReader;o.onloadend=function(e){if(e.target.readyState===FileReader.DONE){var t=new Image;t.src=e.target.result}},o.readAsDataURL(t)}return!0},e.handleProcess=function(t){var a=t.file.status;switch(a){case"error":e.setState({errorMsg:t.file.response});break;case"done":e.setState({errorMsg:"",success:!0}),setTimeout(function(){e.setState({success:!1})},2e3);var n=e.props.field;e.props.onChange({value:t.file.response.url,fields:[n]});break;default:break}},e.handleChangeImage=function(t){e.setState({errorMsg:""});var a=e.props.field;e.props.onChange({value:t.target.value,fields:[a]})},e}return(0,u.default)(t,e),(0,r.default)(t,[{key:"validate",value:function(e){return"string"===typeof e?void 0:{success:!1,errMsg:__("\u9700\u8981string\u7c7b\u578b")}}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.field,i=t.schema,l=t.config,r=null,o=i.meta,s=l.validate(a,o,i.type)||this.state.errorMsg,u=(0,p.default)({"ui-form-item":!0,"item-image":!0,"item-image-upload":l.imageUploadOnly});if(o){o.width&&o.maxWidth&&delete o.maxWidth,o.height&&o.maxHeight&&delete o.maxHeight;var d=h.default.validateImageDimension(o),g=h.default.validateImageMaxSize({size:Number.POSITIVE_INFINITY},{meta:o});if(!d.result||!g.result){var v=!d.result&&!g.result;r=c.createElement("p",null,__("\u56fe\u7247\u8981\u6c42"),d.message,v?",":"",g.message)}}var y=this.state.success?c.createElement("span",{className:"item-image-success"},c.createElement(m.Icon,{type:"check-circle"}),__("\u4e0a\u4f20\u6210\u529f")):c.createElement(c.Fragment,null,c.createElement(m.Upload,{action:l.uploadApi,headers:l.uploadHeaders||{},beforeUpload:this.beforeUpload,onChange:this.handleProcess,data:o,withCredentials:!0,accept:"image/*",ref:function(t){return e.uploadRef=t}}),this.renderPluginSelect({label:c.createElement(c.Fragment,null,c.createElement(m.Icon,{type:"shangchuan"}),c.createElement("span",{style:{marginLeft:8}},l.locale.CHOOSE_IMAGE)),onClick:this.handleSelectFile})),E=a?c.createElement("div",{className:"item-image-preview"},c.createElement("div",{style:{backgroundImage:"url(".concat(a,")")}}),c.createElement(f.default,{text:a,className:"item-image-preview-url",description:__("\u590d\u5236\u56fe\u7247\u5730\u5740")},c.createElement("span",null,(a||"").split("/").reverse()[0]))):null;return c.createElement("div",{className:u,key:n},c.createElement("div",{className:"ui-label"},c.createElement("span",{className:"ui-label-title",title:i.description},i.description,o&&o.description?c.createElement("p",{title:i.meta.description},i.meta.description):null,r),y),c.createElement("div",{className:"ui-content"},l.imageUploadOnly?null:c.createElement(m.Input,{size:l.size,defaultValue:a,value:a,onChange:this.handleChangeImage,disabled:!!this.currentPlugin}),s&&""!==s?c.createElement("div",{className:"item-image-error"},c.createElement(m.Icon,{type:"close-circle"}),s):null,l.imageUploadOnly?E:null))}}]),t}(g.BasePluginComponent));t.default=v},oB4D:function(e,t,a){},oSo5:function(e,t,a){"use strict";var n=a("fbTi"),i=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.createComponent=_,t.BasePluginComponent=void 0;var l,r=i(a("Ico4")),o=i(a("rXjv")),s=i(a("43Yg")),u=i(a("/tCh")),c=i(a("scpF")),d=i(a("O/V9")),p=i(a("8aBX")),f=n(a("cDcd")),h=a("LfU0"),m=a("jXAE"),g=a("gIoJ"),v=a("gm07"),y=a("gzPx"),E=a("Hws7"),b=function(e,t,a,n){var i,l=arguments.length,r=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(l<3?i(r):l>3?i(t,a,r):i(t,a))||r);return l>3&&r&&Object.defineProperty(t,a,r),r},C=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e,t,a,n){return new(a||(a=Promise))(function(i,l){function r(e){try{s(n.next(e))}catch(e){l(e)}}function o(e){try{s(n["throw"](e))}catch(e){l(e)}}function s(e){e.done?i(e.value):new a(function(t){t(e.value)}).then(r,o)}s((n=n.apply(e,t||[])).next())})},k=function(e){function t(e){var a;return(0,s.default)(this,t),a=(0,c.default)(this,(0,d.default)(t).call(this,e)),a.dispatch=window.g_app._store.dispatch,a.paths="",a.paths=a.getPathByProps(e),a}return(0,p.default)(t,e),(0,u.default)(t,[{key:"getInstComponentId",value:function(e,t){return"".concat(e.componentId||"","$").concat(t)}},{key:"componentWillReceiveProps",value:function(e){var t=this.getPathByProps(e);this.paths!==t&&(this.paths=t)}},{key:"deletePlugin",value:function(e){return P(this,void 0,void 0,r.default.mark(function t(){var a,n;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=this.props.metaData,t.next=3,v.pluginService.delete(this.currentPlugin.pluginId);case 3:n=a.sitePlugins.findIndex(function(t){return t.pluginId===e}),a.sitePlugins.splice(n,1),this.dispatch({type:"site/updatePluginList",payload:{pluginList:(0,o.default)(a.sitePlugins)}});case 6:case"end":return t.stop()}},t,this)}))}},{key:"addPlugin",value:function(e){return P(this,void 0,void 0,r.default.mark(function t(){var a,n;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a=this.props.metaData,n=a.sitePlugins.findIndex(function(t){return t.pluginId===e.pluginId}),n<0&&this.dispatch({type:"site/updatePluginList",payload:{pluginList:[].concat((0,o.default)(a.sitePlugins),[e])}});case 3:case"end":return t.stop()}},t,this)}))}},{key:"changeConfirm",value:function(){return P(this,void 0,void 0,r.default.mark(function e(){return r.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){m.Modal.confirm({title:__("\u5207\u6362\u63d2\u4ef6"),content:__("\u662f\u5426\u5207\u6362\u63d2\u4ef6\uff1f\u65e7\u63d2\u4ef6\u6570\u636e\u5c06\u4f1a\u88ab\u5220\u9664"),onOk:function(){e(!0)},onCancel:function(){e(!1)}})}));case 1:case"end":return e.stop()}},e)}))}},{key:"usePlugin",value:function(e){return P(this,void 0,void 0,r.default.mark(function t(){var a,n,i,l,s,u,c,d,p,f,h,m=this;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e||this.currentPlugin){t.next=2;break}return t.abrupt("return");case 2:if(a=this.props,n=a.location,i=a.metaData,l=a.site,s=a.page,!this.currentPlugin||e&&this.currentPlugin.pluginService.pluginServiceId===e.pluginServiceId){t.next=8;break}return t.next=6,this.changeConfirm();case 6:if(t.sent){t.next=8;break}return t.abrupt("return",!1);case 8:if(e){t.next=10;break}return t.abrupt("return",this.deletePlugin(this.currentPlugin.pluginId));case 10:if(u=function(){return P(m,void 0,void 0,r.default.mark(function t(){var a;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v.pluginService.create(n.siteId,n.pageId,n.schemaName,e.pluginServiceId,this.props.location.componentId,{schemaType:i.type,paths:[].concat((0,o.default)(this.props.config.paths.map(function(e){return"".concat(e)})),["".concat(this.props.field)]).filter(function(e){return e})});case 2:return a=t.sent,t.next=5,this.addPlugin(a);case 5:return t.abrupt("return",a);case 6:case"end":return t.stop()}},t,this)}))},c=this.currentPlugin,!this.currentPlugin){t.next=21;break}if(this.currentPlugin.pluginService.pluginServiceId===e.pluginServiceId){t.next=19;break}return t.next=16,this.deletePlugin(this.currentPlugin.pluginId);case 16:return t.next=18,u();case 18:c=t.sent;case 19:t.next=24;break;case 21:return t.next=23,u();case 23:c=t.sent;case 24:d=function(e,t){m.props.onChange({options:{donnotRecord:!0},fields:[m.props.field],value:t.value})},p=function(){return m.dispatch({type:"site/saveSiteData"})},f=function(e){return m.pluginModel.setSaving(e)},h=function(){return m.pluginModel.close()},this.pluginModel.invoke({type:i.type,location:c.location,pluginService:c.pluginService,id:c.pluginId,data:{originId:c.originId,data:this.props.data},key:c.originId?"update":"create",redirectKey:!c.originId&&"update",handleChangeData:d,handleSaveData:p,setLoading:f,closeModal:h,site:{id:l.id,title:l.title,status:E.SiteOnlineStatusEnum[l.onlineStatus]},page:{title:s.title},validate:function(e){return m.validate(e.value)}}).catch(console.error);case 29:case"end":return t.stop()}},t,this)}))}},{key:"renderPluginSelect",value:function(e){var t=this,a=this.props.metaData.plugins;return f.createElement(m.Dropdown,{overlay:f.createElement(m.Menu,{onClick:function(n){return P(t,void 0,void 0,r.default.mark(function t(){var i;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if("default"!==n.key){t.next=6;break}return t.next=3,this.usePlugin();case 3:if(t.t0=t.sent,!1===t.t0){t.next=6;break}return t.abrupt("return",e.onClick());case 6:i=+n.key,a[i]&&this.usePlugin(a[i]).catch(console.error);case 8:case"end":return t.stop()}},t,this)}))}},f.createElement(m.Menu.Item,{key:"default"},e.menu||e.label),a.map(function(e,t){var a=(0,g.get)(function(){return e.icon},"appstore");return f.createElement(m.Menu.Item,{key:"".concat(t)},a.startsWith("http")?f.createElement("img",{src:a,width:14,height:14}):f.createElement(m.Icon,{type:a}),f.createElement("span",{style:{marginLeft:8}},e.title))}))},f.createElement(m.Button,{size:"small",onClick:function(){if(t.currentPlugin)return t.usePlugin(t.currentPlugin.pluginService);e.onClick()}},this.currentPlugin?f.createElement(f.Fragment,null,f.createElement(m.Icon,{type:this.currentPlugin.pluginService.icon}),f.createElement("span",{style:{marginLeft:8}},this.currentPlugin.pluginService.title)):e.label," ",f.createElement(m.Icon,{type:"down"})))}},{key:"getPathByProps",value:function(e){return[].concat((0,o.default)(e.config.paths),[e.field]).join(".")}},{key:"currentPlugin",get:function(){var e=this,t=this.props.location;return this.props.metaData.sitePlugins.find(function(a){var n=a.meta&&a.meta.paths||[];return a.location.pageId===t.pageId&&a.location.schemaName===t.schemaName&&e.getInstComponentId(a.location,n.join("."))===e.getInstComponentId(e.props.location,e.paths)})}}]),t}(f.PureComponent);function _(e){return function(t,a){return(0,h.connect)(function(e){var n=e.present,i=n.page,l=n.site,r=i.activeSchema,o=i.activePageIndex,s=i.pageData,u=s[o],c=u.siteId,d=u.id,p=r.componentId,f=r.schemaName;return{location:{siteId:c,pageId:d,componentId:p,schemaName:f},metaData:{type:t,plugins:a,sitePlugins:l.siteData.pluginList},site:l.siteData,page:s[o]}})(e)}}t.BasePluginComponent=k,b([(0,h.inject)(),C("design:type","function"===typeof(l="undefined"!==typeof y.PluginModel&&y.PluginModel)?l:Object)],k.prototype,"pluginModel",void 0)},uy0V:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,l=n(a("43Yg")),r=n(a("/tCh")),o=n(a("scpF")),s=n(a("O/V9")),u=n(a("8aBX")),c=a("jXAE"),d=a("f+48"),p=a("LfU0"),f=n(a("cDcd")),h=a("gzPx"),m=function(e,t,a,n){var i,l=arguments.length,r=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(l<3?i(r):l>3?i(t,a,r):i(t,a))||r);return l>3&&r&&Object.defineProperty(t,a,r),r},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};a("zuJn");var v=function(e){function t(){return(0,l.default)(this,t),(0,o.default)(this,(0,s.default)(t).apply(this,arguments))}return(0,u.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this,t=this.pluginModel.modal,a=t.title,n=t.visible,i=t.saving,l={wrapClassName:"plugin-modal",title:a,footer:null,maskClosable:!1,destroyOnClose:!0,width:"90%",height:"90%",zIndex:2e3,visible:n,onCancel:function(){return e.pluginModel.close()}},r={className:"plugin-container",id:d.CONTAINER};return f.default.createElement(c.Modal,Object.assign({},l),f.default.createElement(c.Spin,{spinning:i,delay:300},f.default.createElement("div",Object.assign({},r))))}}]),t}(f.default.PureComponent);m([(0,p.inject)(),g("design:type","function"===typeof(i="undefined"!==typeof h.PluginModel&&h.PluginModel)?i:Object)],v.prototype,"pluginModel",void 0),v=m([(0,p.connect)()],v);var y=v;t.default=y},vizD:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("uhLB")),o=n(a("8eVA")),s=a("px1C"),u=a("Hws7"),c=n(a("oYNh")),d=function(){function e(t,a){(0,i.default)(this,e),this.root=t,this.dispatch=a,o.default.initWin(this.root.contentWindow),this.root&&(this.pageElement=this.root.parentNode.parentNode.parentNode),this.listenEvents()}return(0,l.default)(e,[{key:"onMsgChangeHeight",value:function(e){var t=e.height;this.dispatch({type:"page/changeIframeHeight",payload:{height:t}})}},{key:"onMsgSavePosition",value:function(e){var t=e.uid,a=e.position;this.dispatch({type:"page/updateBoxData",payload:{position:a,uid:t}})}},{key:"onMsgActiveSelectedSchema",value:function(e){var t=e.schemaName,a=e.componentId,n=e.componentName,i=e.isPrivate,l=e.meta;this.dispatch({type:"page/selectedSchema",payload:{schemaName:t,componentId:a,componentName:n,isPrivate:i,meta:l}})}},{key:"onMsgActiveSelectedInitMM",value:function(e){this.dispatch({type:"site/updateGlobalLoadingStatus",payload:{status:"hidden"}}),this.dispatch({type:"page/initPageComponentList",payload:e.componentList})}},{key:"onMsgHoverComponent",value:function(e){this.dispatch({type:"page/updateHoverComponent",payload:Object.assign({},e)})}},{key:"onMsgShowNewComponentPanel",value:function(e){this.dispatch({type:"page/clearActiveSchema"}),this.dispatch({type:"view/changeMaskVisible",payload:{visible:!0}}),this.dispatch({type:"page/updateBaseInsertComponent",payload:{componentId:e.componentId,type:e.type}});var t=Object.keys(u.PackageSubTypeEnum).map(function(e){return{type:e,title:(0,s.humanize)(u.PackageSubTypeEnum,e)}});t[0]&&this.dispatch({type:"site/loadCommonComponentList",payload:{type:t[0].type}}),this.dispatch({type:"site/changePanelVisible",payload:{panel:"newModule",visible:!0}})}},{key:"onMsgCancelSelectDone",value:function(){this.dispatch({type:"page/clearActiveSchema"})}},{key:"onMsgActiveSchemaHeightChange",value:function(e){this.dispatch({type:"page/updateHoverComponent",payload:{height:0}}),this.dispatch({type:"page/updateActiveSchemaHeight",payload:Object.assign({},e)})}},{key:"listenEvents",value:function(){var e=this,t=this,a=(0,r.default)(window.context,"antx.sandboxDomain");window.addEventListener("message",function(n){var i=n.data,l=i.eventType;if(!a||n.origin===a)switch(l){case c.default.SANDBOX_READY:o.default.initData();break;case c.default.CHANGE_HEIGHT:t.onMsgChangeHeight.call(t,i);break;case c.default.SAVE_POSITION:t.onMsgSavePosition.call(t,i);break;case c.default.ACTIVE_SELECTED_SCHEMA:t.onMsgActiveSelectedSchema.call(t,i);break;case c.default.ACTIVE_SELECTED_INITMM:t.onMsgActiveSelectedInitMM.call(t,i);break;case c.default.CANCEL_SELECT_DONE:t.onMsgCancelSelectDone.call(t);break;case c.default.HOVER_COMPONENT:t.onMsgHoverComponent.call(t,i);break;case c.default.SHOW_NEW_COMPONENT_PANEL:t.onMsgShowNewComponentPanel.call(t,i);break;case c.default.RELOAD_DONE:i.needScroll&&p(e.pageElement,i.top,200);break;case c.default.ACTIVE_SCHEMA_HEIGHT_CHANGE:t.onMsgActiveSchemaHeightChange.call(t,i);break;default:break}},!1)}},{key:"cancelSelect",value:function(){o.default.cancelSelect()}},{key:"hideDropComponentPlaceHolder",value:function(){o.default.hideDropComponentPlaceHolder()}},{key:"showDropComponentPlaceHolder",value:function(e){o.default.showDropComponentPlaceHolder(e)}},{key:"render",value:function(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];o.default.reload({html:e,schemaName:a,componentId:t,needActiveSchema:n})}},{key:"doc",get:function(){return this.root.contentDocument}}]),e}();function p(e,t,a){var n=e.scrollTop,i=t-n,l=0,r=20,o=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)},s=function t(){l+=r;var s=o(l,n,i,a);e.scrollTop=s,l<a&&setTimeout(t,r)};s()}var f=d;t.default=f},vyZa:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("cDcd")),c=a("L5c0"),d=n(a("UaqG")),p=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.state={refreshingShareUrl:!1,generatingShareUrl:!1,cancelingShare:!1,analyzeError:!1},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"handleClosePreview",value:function(){this.props.dispatch({type:"site/changePreviewPanelVisibleStatus",payload:{status:"hidden"}})}},{key:"HandleUpdateShareUrl",value:function(e){this.props.dispatch({type:"site/updateSharePreviewUrl",payload:{url:e}})}},{key:"handleCancelShare",value:function(){this.props.dispatch({type:"site/updateSharePreviewUrl",payload:{url:null}})}},{key:"getPageList",value:function(){var e=this.props.site.siteData;return this.props.page.pageData.map(function(t){return{title:t.title,url:t.url.replace(e.domain,e.sandboxDomain)}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.site,n=t.page;if("hidden"===a.previewPanelVisible)return null;var i="visible"===a.previewPanelVisible?this.getPageList():[];return u.default.createElement(d.default,{closeable:!0,focusLoading:"loading"===a.previewPanelVisible,onClose:function(){return e.handleClosePreview()},pageList:i,defaultActiveIndex:n.activePageIndex,showShareBtn:!0,siteId:a.siteData.id,defaultSharePreviewUrl:a.siteData.sharePreviewUrl,onUpdateShareUrl:function(t){return e.HandleUpdateShareUrl(t)},onCancelShare:function(){return e.handleCancelShare()}})}}]),t}(u.default.Component),f=(0,c.connect)(function(e){return{site:e.site,page:e.page}})(p);t.default=f},xvx6:function(e,t,a){"use strict";var n=a("fbTi"),i=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i(a("43Yg")),r=i(a("/tCh")),o=i(a("scpF")),s=i(a("O/V9")),u=i(a("8aBX")),c=i(a("cDcd")),d=i(a("8CG2")),p=n(a("MetU")),f=a("sCg3"),h=p.getField,m=h("textfield"),g=function(e){function t(e){var a;return(0,l.default)(this,t),a=(0,o.default)(this,(0,s.default)(t).call(this,e)),a.customXSS=new f.FilterXSS({whiteList:{a:["target","href","title","style"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:["style"],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:["style"],dl:[],dt:[],em:[],font:["color","size","face","style"],footer:[],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:[],hr:[],i:[],img:["src","alt","title","width","height","style"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:["style"],pre:[],s:[],section:[],small:[],span:["style"],sub:[],sup:[],strong:["style"],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},css:{whiteList:{width:!0,height:!0,color:!0,"font-size":!0,"text-align":!0,"text-decoration":!0}}}),a.editorContent="",a.state={EDITOR:null},a}return(0,u.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=e.props.data;if(window.sqm)l();else{var n="https://gw.alipayobjects.com/as/??g/fengdie-plugin/editor/1.0.6/i18n/zh_CN.js,g/fengdie-plugin/editor/1.0.6/scripts/sqm.js",i=a("N1TV");i(n,function(){l()})}function l(){var a=window.sqm;a.dom.domUtils.main.ready(function(){var n=new a.editor.editor({cfg_plugins:[a.editor.plugins.insertHtml,a.editor.plugins.selectAll,a.editor.plugins.baseStyle,a.editor.plugins.paragraph,a.editor.plugins.textIndent,a.editor.plugins.enhance,a.editor.plugins.keyStrokes,a.editor.plugins.paste,a.editor.plugins.justify,a.editor.plugins.removeFormat,a.editor.plugins.indent,a.editor.plugins.enterKey,a.editor.plugins.insertParagraph,a.editor.plugins.font,a.editor.plugins.link,a.editor.plugins.quickLink,a.editor.plugins.quickImage,a.editor.plugins.list,a.editor.plugins.formatMatch,a.editor.plugins.placeHolder,a.editor.plugins.imageResize,a.editor.plugins.autoWidth,a.editor.plugins.autoHeight,a.editor.plugins.imageUpload,a.editor.plugins.virtualHorizontalScrollbar,a.editor.plugins.nodeConvert,a.editor.plugins.mixMore,a.editor.plugins.fullScreen],cfg_editor_height:350,cfg_scroll_parent:window.document.body,cfg_dom_node:e.refs["rich-text"],cfg_toolbar:"fullscreen | forecolor |\n          paragraph | bold italic underline strikethrough |\n          removeformat | link | imageupload | alignleft aligncenter alignright | bullist numlist"});n.waitForEditorReady().then(function(){n.on("ChangeContent",function(){if(e.state.EDITOR){var t=n.getContent().replace(/[\n\r]/g,"");t=e.customXSS.process(t);var a=e.props.field;e.editorContent!==t&&(e.editorContent=t,e.props.onChange({value:t,fields:[a]}))}}),n.setContent(e.customXSS.process(t)),e.setState({EDITOR:n})})})}}},{key:"componentWillUnmount",value:function(){this.state.EDITOR&&this.state.EDITOR.dispose()}},{key:"shouldComponentUpdate",value:function(e){return!this.state.EDITOR||!(0,d.default)(e.schema,this.props.schema)}},{key:"componentWillReceiveProps",value:function(e){e.data!==this.editorContent&&this.state.EDITOR&&(this.editorContent=e.data,this.state.EDITOR.setContent(e.data))}},{key:"render",value:function(){var e=this.props,t=e.schema,a=e.field,n=t.meta&&t.meta.description?c.default.createElement(m,{showTooltip:!0},t.meta.description):null;return c.default.createElement("div",{className:"ui-form-item item-string'",key:a},c.default.createElement("span",{className:"ui-label"},t.description||"\u5bcc\u6587\u672c"),n,c.default.createElement("div",{className:"rich-text",ref:"rich-text"}))}}]),t}(c.default.Component),v=g;t.default=v},zXyN:function(e,t,a){"use strict";var n=a("mZ4U");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("43Yg")),l=n(a("/tCh")),r=n(a("scpF")),o=n(a("O/V9")),s=n(a("8aBX")),u=n(a("uhLB")),c=a("L5c0"),d=n(a("cDcd")),p=n(a("iczh")),f=a("leIJ"),h=a("jXAE"),m=a("+hOP"),g=a("Hws7"),v=a("px1C"),y=h.Tabs.TabPane;a("ZNJB");var E="https://gw.alipayobjects.com/zos/rmsportal/poPJOIiAdbBWFyPuaqtB.png",b=function(e){var t=e.title,a=void 0===t?"Component":t,n=e.snapshot,i=void 0===n?E:n,l=e.onClick;return d.default.createElement(m.Draggable,{className:"ser-module-item"},d.default.createElement("div",{onClick:l},d.default.createElement("span",{className:"ser-module-item-image"},d.default.createElement("img",{width:"280",src:i})),d.default.createElement("span",{className:"ser-module-item-title"},a)))},C=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,r.default)(this,(0,o.default)(t).call(this,e)),a.timer=null,a.state={showGuideTooltip:!1},a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.timer=setTimeout(function(){e.setState({showGuideTooltip:!0})},500)}},{key:"componentWillMount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"loadCommonComponent",value:function(e){var t=this.props.site;t.commonComponentList[e]||this.props.dispatch({type:"site/loadCommonComponentList",payload:{type:e}})}},{key:"handleClosePanel",value:function(){this.props.dispatch({type:"site/changePanelVisible",payload:{panel:"newModule",visible:!1}})}},{key:"handleAddComponent",value:function(e){this.props.dispatch({type:"view/hideDropComponentPlaceHolder"}),this.props.dispatch({type:"page/addComponent",payload:{name:e.name}})}},{key:"handleAddCommonComponent",value:function(e){this.props.dispatch({type:"view/hideDropComponentPlaceHolder"}),this.props.dispatch({type:"page/addCommonComponent",payload:e})}},{key:"handleDragStart",value:function(){this.props.dispatch({type:"view/preventMaskPointerEvents",payload:"auto"})}},{key:"handleTabClick",value:function(e){this.loadCommonComponent(e)}},{key:"renderCommonComponentList",value:function(e){var t=this,a=this.props.site,n=a.commonComponentList[e];return n?d.default.createElement("div",{className:"se-resource-item"},d.default.createElement(m.Container,{behaviour:"copy",groupName:"component-list",dragBeginDelay:10,getChildPayload:function(t){return{type:"common",subType:e,index:t}},onDragStart:function(){return t.handleDragStart()}},n.map(function(a,n){var i={title:a.title,snapshot:"".concat(a.snapshot,"?x-oss-process=image/resize,w_560/crop,h_560"),key:"".concat(e,"-").concat(n),onClick:function(){return t.handleAddCommonComponent(a)}};return d.default.createElement(b,Object.assign({},i))}))):d.default.createElement("div",{className:"ant-tabs-tabpane-loading"},d.default.createElement(h.Spin,null))}},{key:"renderComponentList",value:function(e){var t=this;return 0===e.length?null:d.default.createElement("div",{className:"se-resource-item"},d.default.createElement(m.Container,{behaviour:"copy",groupName:"component-list",dragBeginDelay:10,getChildPayload:function(e){return{type:"normal",index:e}},onDragStart:function(){return t.handleDragStart()}},e.map(function(e,a){var n={key:a,title:e.title,snapshot:"".concat(e.snapshot,"?x-oss-process=image/resize,w_560/crop,h_560"),onClick:function(){return t.handleAddComponent(e)}};return d.default.createElement(b,Object.assign({},n))})))}},{key:"render",value:function(){var e=this,t=this.props,a=t.guide,n=t.site;if(!n.panelVisible.newModule)return null;var i=n.siteData,l=i.papilioPackage,r=i.pluginList,o=l.components.filter(function(e){return(0,f.isComponentAvailable)(e,l,r)}),s=Object.keys(g.PackageSubTypeEnum).map(function(e){return{type:e,title:(0,v.humanize)(g.PackageSubTypeEnum,e)}}),u=(0,p.default)("se-resource","ser-module",{"ser-module-guide":!0===a.component.addComponent}),c="";return this.canUsePkgComponent?c="pkg":this.canUseCommonComponent&&s[0]&&(c=s[0].type),d.default.createElement(h.Tooltip,{placement:"right",title:__("\u9009\u62e9\u5e76\u62d6\u62fd\u4e00\u4e2a\u4f60\u5fc3\u4eea\u7684\u7ec4\u4ef6"),visible:!0===a.component.addComponent&&this.state.showGuideTooltip,overlayClassName:"editor-guide-tooltip"},d.default.createElement("div",{className:u},d.default.createElement("h3",null,__("\u6dfb\u52a0\u7ec4\u4ef6"),d.default.createElement(h.Icon,{onClick:function(){return e.handleClosePanel()},type:"guanbi"})),d.default.createElement("div",{className:"se-resource-list"},d.default.createElement(h.Tabs,{className:"se-resource-tab",animated:!1,tabPosition:"left",onChange:function(t){return e.handleTabClick(t)},defaultActiveKey:c},this.canUsePkgComponent?d.default.createElement(y,{tab:d.default.createElement("span",null,__("\u6a21\u677f\u7ec4\u4ef6")),key:"pkg"},this.renderComponentList(o)):null,this.canUseCommonComponent?d.default.createElement(y,{disabled:!0,tab:d.default.createElement("span",null,__("\u901a\u7528\u7ec4\u4ef6")),key:"common"}):null,this.canUseCommonComponent?s.map(function(t,a){return d.default.createElement(y,{tab:d.default.createElement("span",null,t.title),key:t.type},e.renderCommonComponentList(t.type))}):null))))}},{key:"canUsePkgComponent",get:function(){var e=this.props,t=e.site,a=e.page,n=t.siteData,i=n.papilioPackage,l=n.pluginList,r=i.components.filter(function(e){return(0,f.isComponentAvailable)(e,i,l)}),o=a.pageData[a.activePageIndex];return!o.packageId&&r.length>0}},{key:"canUseCommonComponent",get:function(){var e=this.props,t=e.site,a=e.page,n=a.pageData[a.activePageIndex],i=t.siteData.papilioPackage;return!!n.packageId||!!(0,u.default)(i,"config.mvx")}}]),t}(d.default.Component),P=(0,c.connect)(function(e){return{guide:e.guide,site:e.site,page:e.page}})(C);t.default=P},zuJn:function(e,t,a){}}]);